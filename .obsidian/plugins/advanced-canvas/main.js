/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AdvancedCanvasPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var SLIDE_SIZE_OPTIONS = {
  "1200x675": "16:9",
  "1350x900": "3:2"
};
var DEFAULT_SETTINGS = {
  shapesFeatureEnabled: true,
  edgesStylingFeatureEnabled: true,
  edgeStylePathfinderGridResolution: 10,
  edgeStylePathfinderPathLiveUpdate: true,
  edgeStylePathfinderPathRounded: false,
  commandsFeatureEnabled: true,
  zoomToClonedNode: true,
  cloneNodeMargin: 25,
  expandNodeStepSize: 25,
  betterReadonlyEnabled: true,
  disableNodePopup: false,
  disableZoom: false,
  disablePan: false,
  stickersFeatureEnabled: true,
  presentationFeatureEnabled: true,
  defaultSlideSize: Object.keys(SLIDE_SIZE_OPTIONS).first(),
  useArrowKeysToChangeSlides: true,
  zoomToSlideWithoutPadding: true,
  slideTransitionAnimationDuration: 0.5,
  slideTransitionAnimationIntensity: 1.25,
  canvasEncapsulationEnabled: true,
  portalsFeatureEnabled: true,
  maintainClosedPortalSize: true,
  showEdgesIntoDisabledPortals: true
};
var AdvancedCanvasSettingsManager = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.plugin.loadData());
  }
  async saveSettings() {
    await this.plugin.saveData(this.settings);
  }
  getSetting(key) {
    return this.settings[key];
  }
  async setSetting(data) {
    this.settings = Object.assign(this.settings, data);
    await this.saveSettings();
  }
  addSettingsTab() {
    this.settingsTab = new AdvancedCanvasPluginSettingTab(this.plugin, this);
    this.plugin.addSettingTab(this.settingsTab);
  }
};
var AdvancedCanvasPluginSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(plugin, settingsManager) {
    super(plugin.app, plugin);
    this.settingsManager = settingsManager;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    this.createFeatureHeading(
      containerEl,
      "Shapes",
      "Shape your nodes for creating e.g. mind maps or flow charts.",
      "shapesFeatureEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Edges styling",
      "Style your edges with different path styles.",
      "edgesStylingFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("A* grid resolution").setDesc("The resolution of the grid when using the A* path style. The lower the value, the more precise the path will be. But it will also take longer to calculate.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("edgeStylePathfinderGridResolution").toString()).onChange(async (value) => await this.settingsManager.setSetting({ edgeStylePathfinderGridResolution: Math.max(5, parseInt(value)) }))
    );
    new import_obsidian.Setting(containerEl).setName("Live update A* path").setDesc("When enabled, the A* path style will be updated live while dragging the edge.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("edgeStylePathfinderPathLiveUpdate")).onChange(async (value) => await this.settingsManager.setSetting({ edgeStylePathfinderPathLiveUpdate: value }))
    );
    new import_obsidian.Setting(containerEl).setName("A* rounded path").setDesc("When enabled, the A* path style will be rounded.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("edgeStylePathfinderPathRounded")).onChange(async (value) => await this.settingsManager.setSetting({ edgeStylePathfinderPathRounded: value }))
    );
    this.createFeatureHeading(
      containerEl,
      "Extended commands",
      "Add more commands to the canvas.",
      "commandsFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Zoom to cloned node").setDesc("When enabled, the canvas will zoom to the cloned node.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("zoomToClonedNode")).onChange(async (value) => await this.settingsManager.setSetting({ zoomToClonedNode: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Clone node margin").setDesc("The margin between the cloned node and the source node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("cloneNodeMargin").toString()).onChange(async (value) => await this.settingsManager.setSetting({ cloneNodeMargin: parseInt(value) }))
    );
    new import_obsidian.Setting(containerEl).setName("Expand node step size").setDesc("The step size for expanding the node.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("expandNodeStepSize").toString()).onChange(async (value) => await this.settingsManager.setSetting({ expandNodeStepSize: parseInt(value) }))
    );
    this.createFeatureHeading(
      containerEl,
      "Better readonly",
      "Improve the readonly mode.",
      "betterReadonlyEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Stickers",
      "Convert an image node to a sticker by supporting transparency and removing the border.",
      "stickersFeatureEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Presentations",
      "Create a presentation from your canvas.",
      "presentationFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Default slide ratio").setDesc("The default ratio of the slide.").addDropdown(
      (dropdown) => dropdown.addOptions(SLIDE_SIZE_OPTIONS).setValue(this.settingsManager.getSetting("defaultSlideSize")).onChange(async (value) => await this.settingsManager.setSetting({ defaultSlideSize: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Use arrow keys to change slides").setDesc("When enabled, you can use the arrow keys to change slides in presentation mode.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("useArrowKeysToChangeSlides")).onChange(async (value) => await this.settingsManager.setSetting({ useArrowKeysToChangeSlides: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Zoom to slide without padding").setDesc("When enabled, the canvas will zoom to the slide without padding.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("zoomToSlideWithoutPadding")).onChange(async (value) => await this.settingsManager.setSetting({ zoomToSlideWithoutPadding: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Slide transition animation duration").setDesc("The duration of the slide transition animation in seconds. Set to 0 to disable the animation.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("slideTransitionAnimationDuration").toString()).onChange(async (value) => await this.settingsManager.setSetting({ slideTransitionAnimationDuration: parseFloat(value) }))
    );
    new import_obsidian.Setting(containerEl).setName("Slide transition animation intensity").setDesc("The intensity of the slide transition animation. The higher the value, the more the canvas will zoom out before zooming in on the next slide.").addText(
      (text) => text.setValue(this.settingsManager.getSetting("slideTransitionAnimationIntensity").toString()).onChange(async (value) => await this.settingsManager.setSetting({ slideTransitionAnimationIntensity: parseFloat(value) }))
    );
    this.createFeatureHeading(
      containerEl,
      "Canvas encapsulation",
      "Encapsulate a selection of nodes and edges into a new canvas.",
      "canvasEncapsulationEnabled"
    );
    this.createFeatureHeading(
      containerEl,
      "Portals",
      "Create portals to other canvases.",
      "portalsFeatureEnabled"
    );
    new import_obsidian.Setting(containerEl).setName("Maintain closed portal size").setDesc("When enabled, closing a portal will change the size of the portal to the original, closed size.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("maintainClosedPortalSize")).onChange(async (value) => await this.settingsManager.setSetting({ maintainClosedPortalSize: value }))
    );
    new import_obsidian.Setting(containerEl).setName("Show edges into disabled portals").setDesc("When enabled, edges into disabled portals will be shown by an edge to the portal node.").addToggle(
      (toggle) => toggle.setValue(this.settingsManager.getSetting("showEdgesIntoDisabledPortals")).onChange(async (value) => await this.settingsManager.setSetting({ showEdgesIntoDisabledPortals: value }))
    );
  }
  createFeatureHeading(containerEl, label, description, settingsKey) {
    return new import_obsidian.Setting(containerEl).setHeading().setName(label).setDesc(description).addToggle(
      (toggle) => toggle.setTooltip("Requires a reload to take effect.").setValue(this.settingsManager.getSetting(settingsKey)).onChange(async (value) => {
        await this.settingsManager.setSetting({ [settingsKey]: value });
        new import_obsidian.Notice("Reload obsidian to apply the changes.");
      })
    );
  }
};

// src/utils/canvas-helper.ts
var import_obsidian2 = require("obsidian");

// src/utils/bbox-helper.ts
function scaleBBox(bbox, scale) {
  let diffX = (scale - 1) * (bbox.maxX - bbox.minX);
  let diffY = (scale - 1) * (bbox.maxY - bbox.minY);
  return {
    minX: bbox.minX - diffX / 2,
    maxX: bbox.maxX + diffX / 2,
    minY: bbox.minY - diffY / 2,
    maxY: bbox.maxY + diffY / 2
  };
}
function insideBBox(position, bbox, canTouchEdge) {
  const providedBBox = {
    minX: position.minX || position.x,
    minY: position.minY || position.y,
    maxX: position.maxX || position.x,
    maxY: position.maxY || position.y
  };
  return canTouchEdge ? providedBBox.minX >= bbox.minX && providedBBox.maxX <= bbox.maxX && providedBBox.minY >= bbox.minY && providedBBox.maxY <= bbox.maxY : providedBBox.minX > bbox.minX && providedBBox.maxX < bbox.maxX && providedBBox.minY > bbox.minY && providedBBox.maxY < bbox.maxY;
}
function getCenterOfBBoxSide(bbox, side) {
  switch (side) {
    case "top":
      return { x: (bbox.minX + bbox.maxX) / 2, y: bbox.minY };
    case "right":
      return { x: bbox.maxX, y: (bbox.minY + bbox.maxY) / 2 };
    case "bottom":
      return { x: (bbox.minX + bbox.maxX) / 2, y: bbox.maxY };
    case "left":
      return { x: bbox.minX, y: (bbox.minY + bbox.maxY) / 2 };
  }
}

// src/utils/canvas-helper.ts
function canvasCommand(plugin, check, run) {
  return (checking) => {
    const canvas = plugin.getCurrentCanvas();
    if (checking)
      return canvas !== null && check(canvas);
    if (canvas)
      run(canvas);
    return true;
  };
}
function createQuickSettingsButton(menuOption) {
  const quickSetting = document.createElement("div");
  if (menuOption.id)
    quickSetting.id = menuOption.id;
  quickSetting.classList.add("canvas-control-item");
  (0, import_obsidian2.setIcon)(quickSetting, menuOption.icon);
  (0, import_obsidian2.setTooltip)(quickSetting, menuOption.label, { placement: "left" });
  quickSetting.addEventListener("click", () => {
    var _a;
    return (_a = menuOption.callback) == null ? void 0 : _a.call(menuOption);
  });
  return quickSetting;
}
function addQuickSettingsButton(controlGroup, element) {
  var _a;
  if (element.id)
    (_a = controlGroup.querySelector(`#${element.id}`)) == null ? void 0 : _a.remove();
  controlGroup.appendChild(element);
}
function createCardMenuOption(canvas, menuOption, previewNodeSize, onPlaced) {
  const menuOptionElement = document.createElement("div");
  if (menuOption.id)
    menuOptionElement.id = menuOption.id;
  menuOptionElement.classList.add("canvas-card-menu-button");
  menuOptionElement.classList.add("mod-draggable");
  (0, import_obsidian2.setIcon)(menuOptionElement, menuOption.icon);
  (0, import_obsidian2.setTooltip)(menuOptionElement, menuOption.label, { placement: "top" });
  menuOptionElement.addEventListener("click", (_e) => {
    onPlaced(canvas, getCenterCoordinates(canvas, previewNodeSize()));
  });
  menuOptionElement.addEventListener("pointerdown", (e) => {
    canvas.dragTempNode(e, previewNodeSize(), (pos) => {
      canvas.deselectAll();
      onPlaced(canvas, pos);
    });
  });
  return menuOptionElement;
}
function addCardMenuOption(canvas, element) {
  var _a;
  if (element.id)
    (_a = canvas == null ? void 0 : canvas.cardMenuEl.querySelector(`#${element.id}`)) == null ? void 0 : _a.remove();
  canvas == null ? void 0 : canvas.cardMenuEl.appendChild(element);
}
function createPopupMenuOption(menuOption) {
  const menuOptionElement = document.createElement("button");
  if (menuOption.id)
    menuOptionElement.id = menuOption.id;
  menuOptionElement.classList.add("clickable-icon");
  (0, import_obsidian2.setIcon)(menuOptionElement, menuOption.icon);
  (0, import_obsidian2.setTooltip)(menuOptionElement, menuOption.label, { placement: "top" });
  menuOptionElement.addEventListener("click", () => {
    var _a;
    return (_a = menuOption.callback) == null ? void 0 : _a.call(menuOption);
  });
  return menuOptionElement;
}
function createExpandablePopupMenuOption(menuOption, subMenuOptions) {
  const menuOptionElement = createPopupMenuOption({
    ...menuOption,
    callback: () => {
      var _a, _b, _c;
      const submenuId = `${menuOption.id}-submenu`;
      if (menuOptionElement.classList.contains("is-active")) {
        menuOptionElement.classList.remove("is-active");
        (_b = (_a = menuOptionElement.parentElement) == null ? void 0 : _a.querySelector(`#${submenuId}`)) == null ? void 0 : _b.remove();
        return;
      }
      menuOptionElement.classList.add("is-active");
      const submenu = document.createElement("div");
      submenu.id = submenuId;
      submenu.classList.add("canvas-submenu");
      for (const subMenuOption of subMenuOptions) {
        const subMenuOptionElement = createPopupMenuOption(subMenuOption);
        submenu.appendChild(subMenuOptionElement);
      }
      (_c = menuOptionElement.parentElement) == null ? void 0 : _c.appendChild(submenu);
    }
  });
  return menuOptionElement;
}
function addPopupMenuOption(canvas, element, index = -1) {
  var _a, _b;
  const popupMenuEl = (_a = canvas == null ? void 0 : canvas.menu) == null ? void 0 : _a.menuEl;
  if (!popupMenuEl)
    return;
  if (element.id)
    (_b = popupMenuEl.querySelector(`#${element.id}`)) == null ? void 0 : _b.remove();
  const sisterElement = index >= 0 ? popupMenuEl.children[index] : popupMenuEl.children[popupMenuEl.children.length + index];
  popupMenuEl.insertAfter(element, sisterElement);
}
function getCenterCoordinates(canvas, nodeSize) {
  const viewBounds = canvas.getViewportBBox();
  return {
    x: (viewBounds.minX + viewBounds.maxX) / 2 - nodeSize.width / 2,
    y: (viewBounds.minY + viewBounds.maxY) / 2 - nodeSize.height / 2
  };
}
function getBBox(canvasNodes) {
  let minX = Infinity;
  let minY = Infinity;
  let maxX = -Infinity;
  let maxY = -Infinity;
  for (const node of canvasNodes) {
    const nodeData = node.getData ? node.getData() : node;
    minX = Math.min(minX, nodeData.x);
    minY = Math.min(minY, nodeData.y);
    maxX = Math.max(maxX, nodeData.x + nodeData.width);
    maxY = Math.max(maxY, nodeData.y + nodeData.height);
  }
  return { minX, minY, maxX, maxY };
}
function zoomToBBox(canvas, bbox) {
  const PADDING_CORRECTION_FACTOR = 1 / 1.1;
  const zoomedBBox = scaleBBox(bbox, PADDING_CORRECTION_FACTOR);
  canvas.zoomToBbox(zoomedBBox);
  const scaleFactor = Math.min(
    canvas.canvasRect.width / (bbox.maxX - bbox.minX),
    canvas.canvasRect.height / (bbox.maxY - bbox.minY)
  );
  canvas.tZoom = Math.log2(scaleFactor);
}

// src/events/events.ts
var PLUGIN_EVENT_PREFIX = "advanced-canvas";
var CanvasEvent = {
  CanvasChanged: `${PLUGIN_EVENT_PREFIX}:canvas-changed`,
  ViewportChanged: {
    Before: `${PLUGIN_EVENT_PREFIX}:viewport-changed:before`,
    After: `${PLUGIN_EVENT_PREFIX}:viewport-changed:after`
  },
  NodeMoved: `${PLUGIN_EVENT_PREFIX}:node-moved`,
  DraggingStateChanged: `${PLUGIN_EVENT_PREFIX}:dragging-state-changed`,
  NodeAdded: `${PLUGIN_EVENT_PREFIX}:node-added`,
  EdgeAdded: `${PLUGIN_EVENT_PREFIX}:edge-added`,
  NodeRemoved: `${PLUGIN_EVENT_PREFIX}:node-removed`,
  EdgeRemoved: `${PLUGIN_EVENT_PREFIX}:edge-removed`,
  NodeChanged: `${PLUGIN_EVENT_PREFIX}:node-changed`,
  EdgeChanged: `${PLUGIN_EVENT_PREFIX}:edge-changed`,
  EdgeCenterRequested: `${PLUGIN_EVENT_PREFIX}:edge-center-requested`,
  SelectionChanged: `${PLUGIN_EVENT_PREFIX}:selection-changed`,
  ZoomToBbox: {
    Before: `${PLUGIN_EVENT_PREFIX}:zoom-to-bbox:before`,
    After: `${PLUGIN_EVENT_PREFIX}:zoom-to-bbox:after`
  },
  PopupMenuCreated: `${PLUGIN_EVENT_PREFIX}:popup-menu-created`,
  NodeInteraction: `${PLUGIN_EVENT_PREFIX}:node-interaction`,
  Undo: `${PLUGIN_EVENT_PREFIX}:undo`,
  Redo: `${PLUGIN_EVENT_PREFIX}:redo`,
  ReadonlyChanged: `${PLUGIN_EVENT_PREFIX}:readonly-changed`,
  DataRequested: `${PLUGIN_EVENT_PREFIX}:data-requested`,
  LoadData: `${PLUGIN_EVENT_PREFIX}:load-data`,
  CanvasSaved: {
    Before: `${PLUGIN_EVENT_PREFIX}:canvas-saved:before`,
    After: `${PLUGIN_EVENT_PREFIX}:canvas-saved:after`
  }
};

// src/canvas-extensions/shapes-canvas-extension.ts
var SHAPES = [
  {
    id: null,
    menuName: "Default",
    icon: "circle-off"
  },
  {
    id: "oval",
    menuName: "Oval",
    icon: "oval"
  },
  {
    id: "centered-rectangle",
    menuName: "Rectangle",
    icon: "rectangle-horizontal"
  },
  {
    id: "diamond",
    menuName: "Diamond",
    icon: "diamond"
  },
  {
    id: "parallelogram",
    menuName: "Parallelogram",
    icon: "parallelogram"
  },
  {
    id: "circle",
    menuName: "Circle",
    icon: "circle"
  },
  {
    id: "predefined-process",
    menuName: "Predefined process",
    icon: "predefined-process"
  },
  {
    id: "document",
    menuName: "Document",
    icon: "document"
  },
  {
    id: "database",
    menuName: "Database",
    icon: "database-shape"
  }
];
var ShapesCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("shapesFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
  }
  onPopupMenuCreated(canvas) {
    if (canvas.readonly || !this.hasValidNodeInSelection(canvas))
      return;
    const nestedMenuOptions = SHAPES.map((shape) => ({
      label: shape.menuName,
      icon: shape.icon,
      callback: () => this.setShapeForSelection(canvas, shape)
    }));
    const menuOption = createExpandablePopupMenuOption({
      id: "node-shape-option",
      label: "Node shape",
      icon: "shapes"
    }, nestedMenuOptions);
    addPopupMenuOption(canvas, menuOption);
  }
  hasValidNodeInSelection(canvas) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type === "text")
        return true;
    }
    return false;
  }
  setShapeForSelection(canvas, shape) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type !== "text")
        continue;
      const node = canvas.nodes.get(nodeData.id);
      if (!node)
        continue;
      canvas.setNodeData(node, "shape", shape.id);
    }
  }
};

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/utils/patch-helper.ts
function patchWorkspaceFunction(plugin, getTarget, functions) {
  return new Promise((resolve) => {
    const tryPatch = () => {
      const target = getTarget();
      if (!target)
        return null;
      const uninstaller = around(target.constructor.prototype, functions);
      plugin.register(uninstaller);
      return target;
    };
    const result = tryPatch();
    if (result) {
      resolve(result);
      return;
    }
    const listener = plugin.app.workspace.on("layout-change", () => {
      const result2 = tryPatch();
      if (result2) {
        plugin.app.workspace.offref(listener);
        resolve(result2);
      }
    });
    plugin.registerEvent(listener);
  });
}

// src/events/canvas-event-emitter.ts
var CanvasEventEmitter = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.applyPatches();
  }
  async applyPatches() {
    const that = this;
    patchWorkspaceFunction(this.plugin, () => {
      var _a;
      return (_a = this.plugin.getCurrentCanvas()) == null ? void 0 : _a.menu;
    }, {
      render: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.PopupMenuCreated, this.canvas);
        next.call(this);
        return result;
      }
    });
    patchWorkspaceFunction(this.plugin, () => {
      var _a;
      return (_a = this.plugin.getCurrentCanvas()) == null ? void 0 : _a.nodeInteractionLayer;
    }, {
      setTarget: (next) => function(node) {
        const result = next.call(this, node);
        that.triggerWorkspaceEvent(CanvasEvent.NodeInteraction, this.canvas, node);
        return result;
      }
    });
    const canvasView = await patchWorkspaceFunction(this.plugin, () => this.plugin.getCurrentCanvasView(), {
      getViewData: (_next) => function(..._args) {
        return JSON.stringify(this.canvas.getData(), null, 2);
      },
      setViewData: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.CanvasChanged, this.canvas);
        return result;
      }
    });
    await patchWorkspaceFunction(this.plugin, () => canvasView == null ? void 0 : canvasView.canvas, {
      // Add custom function
      setNodeData: (_next) => function(node, key, value) {
        node.setData({
          ...node.getData(),
          [key]: value
        });
        this.requestSave();
        that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this, node);
      },
      setEdgeData: (_next) => function(edge, key, value) {
        edge.setData({
          ...edge.getData(),
          [key]: value
        });
        this.requestSave();
        that.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, this, edge);
      },
      markViewportChanged: (next) => function(...args) {
        that.triggerWorkspaceEvent(CanvasEvent.ViewportChanged.Before, this);
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.ViewportChanged.After, this);
        return result;
      },
      markMoved: (next) => function(node) {
        const result = next.call(this, node);
        that.triggerWorkspaceEvent(CanvasEvent.NodeMoved, this, node);
        return result;
      },
      setDragging: (next) => function(dragging) {
        const result = next.call(this, dragging);
        that.triggerWorkspaceEvent(CanvasEvent.DraggingStateChanged, this, dragging);
        return result;
      },
      updateSelection: (next) => function(update) {
        const oldSelection = new Set(this.selection);
        const result = next.call(this, update);
        that.triggerWorkspaceEvent(CanvasEvent.SelectionChanged, this, oldSelection, (update2) => next.call(this, update2));
        return result;
      },
      addNode: (next) => function(node) {
        that.runAfterInitialized(node, () => {
          that.triggerWorkspaceEvent(CanvasEvent.NodeAdded, this, node);
          that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this, node);
        });
        return next.call(this, node);
      },
      addEdge: (next) => function(edge) {
        that.patchEdge(edge);
        that.runAfterInitialized(edge, () => {
          that.triggerWorkspaceEvent(CanvasEvent.EdgeAdded, this, edge);
        });
        return next.call(this, edge);
      },
      removeNode: (next) => function(node) {
        const result = next.call(this, node);
        that.triggerWorkspaceEvent(CanvasEvent.NodeRemoved, this, node);
        return result;
      },
      removeEdge: (next) => function(edge) {
        const result = next.call(this, edge);
        that.triggerWorkspaceEvent(CanvasEvent.EdgeRemoved, this, edge);
        return result;
      },
      zoomToBbox: (next) => function(bbox) {
        that.triggerWorkspaceEvent(CanvasEvent.ZoomToBbox.Before, this, bbox);
        const result = next.call(this, bbox);
        that.triggerWorkspaceEvent(CanvasEvent.ZoomToBbox.After, this, bbox);
        return result;
      },
      setReadonly: (next) => function(readonly) {
        const result = next.call(this, readonly);
        that.triggerWorkspaceEvent(CanvasEvent.ReadonlyChanged, this, readonly);
        return result;
      },
      undo: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.Undo, this);
        this.nodes.forEach((node) => that.runAfterInitialized(node, () => {
          that.triggerWorkspaceEvent(CanvasEvent.NodeAdded, this, node);
          that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this, node);
        }));
        this.edges.forEach((edge) => that.runAfterInitialized(edge, () => {
          that.triggerWorkspaceEvent(CanvasEvent.EdgeAdded, this, edge);
          that.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, this, edge);
        }));
        return result;
      },
      redo: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.Redo, this);
        this.nodes.forEach((node) => that.runAfterInitialized(node, () => {
          that.triggerWorkspaceEvent(CanvasEvent.NodeAdded, this, node);
          that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this, node);
        }));
        this.edges.forEach((edge) => that.runAfterInitialized(edge, () => {
          that.triggerWorkspaceEvent(CanvasEvent.EdgeAdded, this, edge);
          that.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, this, edge);
        }));
        return result;
      },
      getData: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.DataRequested, this, result);
        return result;
      },
      setData: (next) => function(data) {
        const targetFilePath = this.view.file.path;
        const setData = (data2) => {
          if (!this.view.file || this.view.file.path !== targetFilePath)
            return;
          this.importData(data2);
          this.nodes.forEach((node) => that.runAfterInitialized(node, () => that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this, node)));
        };
        that.triggerWorkspaceEvent(CanvasEvent.LoadData, this, data, setData);
        const result = next.call(this, data);
        this.nodes.forEach((node) => that.runAfterInitialized(node, () => that.triggerWorkspaceEvent(CanvasEvent.NodeChanged, this, node)));
        return result;
      },
      requestSave: (next) => function(...args) {
        that.triggerWorkspaceEvent(CanvasEvent.CanvasSaved.Before, this);
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.CanvasSaved.After, this);
        return result;
      }
    });
    this.plugin.app.workspace.iterateAllLeaves((leaf) => {
      if (leaf.view.getViewType() !== "canvas")
        return;
      const canvasView2 = leaf.view;
      canvasView2.canvas.edges.forEach((edge) => this.patchEdge(edge));
      canvasView2.canvas.nodes.forEach((node) => that.runAfterInitialized(node, () => that.triggerWorkspaceEvent(CanvasEvent.NodeAdded, canvasView2.canvas, node)));
      canvasView2.canvas.edges.forEach((edge) => that.runAfterInitialized(edge, () => that.triggerWorkspaceEvent(CanvasEvent.EdgeAdded, canvasView2.canvas, edge)));
      canvasView2.setViewData(canvasView2.getViewData());
      this.triggerWorkspaceEvent(CanvasEvent.PopupMenuCreated, canvasView2.canvas);
    });
  }
  patchEdge(edge) {
    const that = this;
    const uninstall = around(edge, {
      render: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.EdgeChanged, this.canvas, edge);
        return result;
      },
      getCenter: (next) => function(...args) {
        const result = next.call(this, ...args);
        that.triggerWorkspaceEvent(CanvasEvent.EdgeCenterRequested, this.canvas, edge, result);
        return result;
      }
    });
    that.plugin.register(uninstall);
  }
  runAfterInitialized(canvasElement, onReady) {
    if (canvasElement.initialized) {
      onReady();
      return;
    }
    const that = this;
    const uninstall = around(canvasElement, {
      initialize: (next) => function(...args) {
        const result = next.call(this, ...args);
        onReady();
        uninstall();
        return result;
      }
    });
    that.plugin.register(uninstall);
  }
  triggerWorkspaceEvent(event, ...args) {
    this.plugin.app.workspace.trigger(event, ...args);
  }
};

// src/canvas-extensions/group-canvas-extension.ts
var GROUP_NODE_SIZE = { width: 300, height: 300 };
var GroupCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => {
        addCardMenuOption(
          canvas,
          createCardMenuOption(
            canvas,
            {
              id: "create-group",
              label: "Drag to add group",
              icon: "group"
            },
            () => GROUP_NODE_SIZE,
            (canvas2, pos) => {
              canvas2.createGroupNode({
                pos,
                size: GROUP_NODE_SIZE
              });
            }
          )
        );
      }
    ));
  }
};

// src/canvas-extensions/presentation-canvas-extension.ts
var import_obsidian3 = require("obsidian");
var START_SLIDE_NAME = "Start Slide";
var DEFAULT_SLIDE_NAME = "New Slide";
var PresentationCanvasExtension = class {
  constructor(plugin) {
    this.savedViewport = null;
    this.isPresentationMode = false;
    this.visitedNodes = [];
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("presentationFeatureEnabled"))
      return;
    this.plugin.addCommand({
      id: "create-new-slide",
      name: "Create new slide",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly && !this.isPresentationMode,
        (canvas) => this.addSlide(canvas)
      )
    });
    this.plugin.addCommand({
      id: "start-presentation",
      name: "Start presentation",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => !this.isPresentationMode,
        (canvas) => this.startPresentation(canvas)
      )
    });
    this.plugin.addCommand({
      id: "previous-node",
      name: "Previous node",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => this.isPresentationMode,
        (canvas) => this.previousNode(canvas)
      )
    });
    this.plugin.addCommand({
      id: "next-node",
      name: "Next node",
      checkCallback: canvasCommand(
        this.plugin,
        (_canvas) => this.isPresentationMode,
        (canvas) => this.nextNode(canvas)
      )
    });
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.onCanvasChanged(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
  }
  onCanvasChanged(canvas) {
    addCardMenuOption(
      canvas,
      createCardMenuOption(
        canvas,
        {
          id: "new-slide",
          label: "Drag to add slide",
          icon: "gallery-vertical"
        },
        () => this.getSlideSize(),
        (canvas2, pos) => this.addSlide(canvas2, pos)
      )
    );
  }
  onPopupMenuCreated(canvas) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    if (canvas.readonly || selectedNodesData.length !== 1 || canvas.selection.size > 1)
      return;
    const selectedNode = canvas.nodes.get(selectedNodesData[0].id);
    if (!selectedNode)
      return;
    addPopupMenuOption(
      canvas,
      createPopupMenuOption({
        id: "start-node",
        label: "Set as start slide",
        icon: "play",
        callback: () => this.setStartNode(canvas, selectedNode)
      })
    );
  }
  getStartNode(canvas) {
    for (const [_, node] of canvas.nodes) {
      if (node.getData().isStartNode)
        return node;
    }
    return void 0;
  }
  setStartNode(canvas, node) {
    if (!node)
      return;
    const startNode = this.getStartNode(canvas);
    if (startNode)
      canvas.setNodeData(startNode, "isStartNode", false);
    if (node !== startNode)
      canvas.setNodeData(node, "isStartNode", true);
  }
  getSlideSize() {
    const slideSizeString = this.plugin.settingsManager.getSetting("defaultSlideSize");
    const slideSizeArray = slideSizeString.split("x").map((value) => parseInt(value));
    return { width: slideSizeArray[0], height: slideSizeArray[1] };
  }
  addSlide(canvas, pos) {
    if (!pos)
      pos = getCenterCoordinates(canvas, this.getSlideSize());
    const isStartNode = this.getStartNode(canvas) == null;
    const nodeSize = this.getSlideSize();
    const groupNode = canvas.createGroupNode({
      pos,
      size: nodeSize,
      label: isStartNode ? START_SLIDE_NAME : DEFAULT_SLIDE_NAME,
      focus: false
    });
    if (isStartNode)
      canvas.setNodeData(groupNode, "isStartNode", true);
  }
  async animateNodeTransition(canvas, fromNode, toNode) {
    const useCustomZoomFunction = this.plugin.settingsManager.getSetting("zoomToSlideWithoutPadding");
    const animationDurationMs = this.plugin.settingsManager.getSetting("slideTransitionAnimationDuration") * 1e3;
    if (animationDurationMs > 0 && fromNode) {
      const animationIntensity = this.plugin.settingsManager.getSetting("slideTransitionAnimationIntensity");
      const currentNodeBBoxEnlarged = scaleBBox(fromNode.getBBox(), animationIntensity);
      if (useCustomZoomFunction)
        zoomToBBox(canvas, currentNodeBBoxEnlarged);
      else
        canvas.zoomToBbox(currentNodeBBoxEnlarged);
      await sleep(animationDurationMs / 2);
      const nextNodeBBoxEnlarged = scaleBBox(toNode.getBBox(), animationIntensity);
      if (useCustomZoomFunction)
        zoomToBBox(canvas, nextNodeBBoxEnlarged);
      else
        canvas.zoomToBbox(nextNodeBBoxEnlarged);
      await sleep(animationDurationMs / 2);
    }
    let nodeBBox = toNode.getBBox();
    if (useCustomZoomFunction)
      zoomToBBox(canvas, nodeBBox);
    else
      canvas.zoomToBbox(nodeBBox);
  }
  async startPresentation(canvas) {
    const startNode = this.getStartNode(canvas);
    if (!startNode) {
      new import_obsidian3.Notice("No start node found. Please mark a node as a start node trough the popup menu.");
      return;
    }
    this.visitedNodes = [];
    this.savedViewport = {
      x: canvas.tx,
      y: canvas.ty,
      zoom: canvas.tZoom
    };
    canvas.wrapperEl.focus();
    canvas.wrapperEl.requestFullscreen();
    canvas.wrapperEl.classList.add("presentation-mode");
    canvas.setReadonly(true);
    if (this.plugin.settingsManager.getSetting("useArrowKeysToChangeSlides")) {
      canvas.wrapperEl.onkeydown = (e) => {
        if (e.key === "ArrowRight")
          this.nextNode(canvas);
        else if (e.key === "ArrowLeft")
          this.previousNode(canvas);
      };
    }
    const fullscreenModalObserver = new MutationObserver((mutationRecords) => {
      mutationRecords.forEach((mutationRecord) => {
        mutationRecord.addedNodes.forEach((node) => {
          var _a;
          document.body.removeChild(node);
          (_a = document.fullscreenElement) == null ? void 0 : _a.appendChild(node);
        });
      });
      const inputField = document.querySelector(".prompt-input");
      if (inputField)
        inputField.focus();
    });
    fullscreenModalObserver.observe(document.body, { childList: true });
    canvas.wrapperEl.onfullscreenchange = (_e) => {
      if (document.fullscreenElement)
        return;
      fullscreenModalObserver.disconnect();
      this.endPresentation(canvas);
    };
    this.isPresentationMode = true;
    await sleep(500);
    this.visitedNodes.push(startNode);
    this.animateNodeTransition(canvas, void 0, startNode);
  }
  endPresentation(canvas) {
    canvas.wrapperEl.onkeydown = null;
    canvas.wrapperEl.onfullscreenchange = null;
    canvas.setReadonly(false);
    canvas.wrapperEl.classList.remove("presentation-mode");
    if (document.fullscreenElement)
      document.exitFullscreen();
    canvas.setViewport(this.savedViewport.x, this.savedViewport.y, this.savedViewport.zoom);
    this.isPresentationMode = false;
  }
  nextNode(canvas) {
    var _a;
    const fromNode = this.visitedNodes.last();
    if (!fromNode)
      return;
    const outgoingEdges = canvas.getEdgesForNode(fromNode).filter((edge) => edge.from.node === fromNode);
    let toNode = (_a = outgoingEdges.first()) == null ? void 0 : _a.to.node;
    if (outgoingEdges.length > 1) {
      const sortedEdges = outgoingEdges.sort((a, b) => {
        if (!a.label)
          return 1;
        if (!b.label)
          return -1;
        return a.label.localeCompare(b.label);
      });
      const traversedEdgesCount = this.visitedNodes.filter((visitedNode) => visitedNode == fromNode).length - 1;
      const nextEdge = sortedEdges[traversedEdgesCount];
      toNode = nextEdge.to.node;
    }
    if (toNode) {
      this.visitedNodes.push(toNode);
      this.animateNodeTransition(canvas, fromNode, toNode);
    } else {
      this.animateNodeTransition(canvas, fromNode, fromNode);
    }
  }
  previousNode(canvas) {
    const fromNode = this.visitedNodes.pop();
    if (!fromNode)
      return;
    let toNode = this.visitedNodes.last();
    if (!toNode) {
      toNode = fromNode;
      this.visitedNodes.push(fromNode);
    }
    this.animateNodeTransition(canvas, fromNode, toNode);
  }
};

// src/canvas-extensions/node-data-tagger-canvas-extension.ts
function getExposedNodeData(settings) {
  const exposedData = [];
  if (settings.getSetting("stickersFeatureEnabled"))
    exposedData.push("isSticker");
  if (settings.getSetting("shapesFeatureEnabled"))
    exposedData.push("shape");
  if (settings.getSetting("presentationFeatureEnabled"))
    exposedData.push("isStartNode");
  if (settings.getSetting("portalsFeatureEnabled"))
    exposedData.push("portalToFile", "portalId");
  return exposedData;
}
var NodeDataTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeChanged,
      (_canvas, node) => {
        const nodeData = node == null ? void 0 : node.getData();
        if (!nodeData)
          return;
        for (const dataKey of getExposedNodeData(this.plugin.settingsManager)) {
          const dataValue = nodeData[dataKey];
          if (dataValue === void 0)
            delete node.nodeEl.dataset[dataKey];
          else
            node.nodeEl.dataset[dataKey] = dataValue;
        }
      }
    ));
  }
};

// src/canvas-extensions/interaction-tagger-canvas-extension.ts
var TARGET_NODE_DATASET_PREFIX = "target";
var InteractionTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeInteraction,
      (canvas, node) => {
        const interactionEl = canvas.nodeInteractionLayer.interactionEl;
        if (!interactionEl)
          return;
        for (const dataKey of getExposedNodeData(this.plugin.settingsManager)) {
          const datasetKey = TARGET_NODE_DATASET_PREFIX + dataKey.toString().charAt(0).toUpperCase() + dataKey.toString().slice(1);
          const dataValue = node == null ? void 0 : node.getData()[dataKey];
          if (dataValue === void 0)
            delete interactionEl.dataset[datasetKey];
          else
            interactionEl.dataset[datasetKey] = dataValue;
        }
      }
    ));
  }
};

// src/canvas-extensions/readonly-canvas-extension.ts
var ReadonlyCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    const that = this;
    if (!this.plugin.settingsManager.getSetting("betterReadonlyEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas, _node) => this.updatePopupMenu(canvas)
    ));
    let movingToBBox = false;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ViewportChanged.Before,
      (canvas) => {
        var _a, _b, _c, _d, _e, _f;
        if (movingToBBox) {
          movingToBBox = false;
          that.updateLockedZoom(canvas);
          that.updateLockedPan(canvas);
          return;
        }
        if (!canvas.readonly)
          return;
        if (that.plugin.settingsManager.getSetting("disableZoom")) {
          canvas.zoom = (_a = canvas.lockedZoom) != null ? _a : canvas.zoom;
          canvas.tZoom = (_b = canvas.lockedZoom) != null ? _b : canvas.tZoom;
        }
        if (that.plugin.settingsManager.getSetting("disablePan")) {
          canvas.x = (_c = canvas.lockedX) != null ? _c : canvas.x;
          canvas.tx = (_d = canvas.lockedX) != null ? _d : canvas.tx;
          canvas.y = (_e = canvas.lockedY) != null ? _e : canvas.y;
          canvas.ty = (_f = canvas.lockedY) != null ? _f : canvas.ty;
        }
      }
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ZoomToBbox.Before,
      () => movingToBBox = true
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.ReadonlyChanged,
      (canvas, _readonly) => {
        this.updatePopupMenu(canvas);
        this.updateLockedZoom(canvas);
        this.updateLockedPan(canvas);
      }
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => this.addQuickSettings(canvas)
    ));
  }
  addQuickSettings(canvas) {
    var _a;
    const settingsContainer = (_a = canvas.quickSettingsButton) == null ? void 0 : _a.parentElement;
    if (!settingsContainer)
      return;
    addQuickSettingsButton(
      settingsContainer,
      this.createToggle({
        id: "disable-node-popup",
        label: "Disable node popup",
        icon: "arrow-up-right-from-circle",
        callback: () => this.updatePopupMenu(canvas)
      }, "disableNodePopup")
    );
    addQuickSettingsButton(
      settingsContainer,
      this.createToggle({
        id: "disable-zoom",
        label: "Disable zoom",
        icon: "zoom-in",
        callback: () => this.updateLockedZoom(canvas)
      }, "disableZoom")
    );
    addQuickSettingsButton(
      settingsContainer,
      this.createToggle({
        id: "disable-pan",
        label: "Disable pan",
        icon: "move",
        callback: () => this.updateLockedPan(canvas)
      }, "disablePan")
    );
  }
  createToggle(menuOption, settingKey) {
    const toggle = createQuickSettingsButton({
      ...menuOption,
      callback: () => (async () => {
        var _a;
        const newValue = !this.plugin.settingsManager.getSetting(settingKey);
        await this.plugin.settingsManager.setSetting({ [settingKey]: newValue });
        toggle.dataset.toggled = this.plugin.settingsManager.getSetting(settingKey).toString();
        (_a = menuOption.callback) == null ? void 0 : _a.call(this);
      })()
    });
    toggle.classList.add("show-while-readonly");
    toggle.dataset.toggled = this.plugin.settingsManager.getSetting(settingKey).toString();
    return toggle;
  }
  updatePopupMenu(canvas) {
    const hidden = canvas.readonly && this.plugin.settingsManager.getSetting("disableNodePopup");
    canvas.menu.menuEl.style.visibility = hidden ? "hidden" : "visible";
  }
  updateLockedZoom(canvas) {
    canvas.lockedZoom = canvas.tZoom;
  }
  updateLockedPan(canvas) {
    canvas.lockedX = canvas.tx;
    canvas.lockedY = canvas.ty;
  }
};

// src/utils/modal-helper.ts
var import_obsidian4 = require("obsidian");
var FileNameModal = class extends import_obsidian4.SuggestModal {
  constructor(app, parentPath, fileExtension) {
    super(app);
    this.parentPath = parentPath;
    this.fileExtension = fileExtension;
  }
  getSuggestions(query) {
    const queryWithoutExtension = query.replace(new RegExp(`\\.${this.fileExtension}$`), "");
    if (queryWithoutExtension === "")
      return [];
    const queryWithExtension = queryWithoutExtension + "." + this.fileExtension;
    const suggestions = [`${this.parentPath}/${queryWithExtension}`, queryWithExtension].filter((s) => this.app.vault.getAbstractFileByPath(s) === null);
    return suggestions;
  }
  renderSuggestion(text, el) {
    el.setText(text);
  }
  onChooseSuggestion(_text, _evt) {
  }
  static awaitInput(modal) {
    return new Promise((resolve, _reject) => {
      modal.onChooseSuggestion = (text) => {
        resolve(text);
      };
      modal.open();
    });
  }
};

// src/canvas-extensions/encapsulate-canvas-extension.ts
var ENCAPSULATED_FILE_NODE_SIZE = { width: 300, height: 300 };
var EncapsulateCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("canvasEncapsulationEnabled"))
      return;
    this.plugin.addCommand({
      id: "encapsulate-selection",
      name: "Encapsulate selection",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly && canvas.selection.size > 0,
        (canvas) => this.encapsulateSelection(canvas)
      )
    });
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "canvas:selection-menu",
      (menu, canvas) => {
        menu.addItem(
          (item) => item.setTitle("Encapsulate").setIcon("file-plus").onClick(() => this.encapsulateSelection(canvas))
        );
      }
    ));
  }
  async encapsulateSelection(canvas) {
    var _a;
    const selection = canvas.getSelectionData();
    const sourceFileFolder = (_a = canvas.view.file.parent) == null ? void 0 : _a.path;
    if (!sourceFileFolder)
      return;
    const targetFilePath = await FileNameModal.awaitInput(new FileNameModal(
      this.plugin.app,
      sourceFileFolder,
      "canvas"
    ));
    const newFileData = { nodes: selection.nodes, edges: selection.edges };
    const file = await this.plugin.app.vault.create(targetFilePath, JSON.stringify(newFileData, null, 2));
    for (const nodeData of selection.nodes) {
      const node = canvas.nodes.get(nodeData.id);
      if (node)
        canvas.removeNode(node);
    }
    canvas.createFileNode({
      pos: {
        x: selection.center.x - ENCAPSULATED_FILE_NODE_SIZE.width / 2,
        y: selection.center.y - ENCAPSULATED_FILE_NODE_SIZE.height / 2
      },
      size: ENCAPSULATED_FILE_NODE_SIZE,
      file
    });
  }
};

// src/canvas-extensions/commands-canvas-extension.ts
var DIRECTIONS = ["up", "down", "left", "right"];
var CommandsCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("commandsFeatureEnabled"))
      return;
    this.plugin.addCommand({
      id: "create-text-node",
      name: "Create text node",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => !canvas.readonly,
        (canvas) => this.createTextNode(canvas)
      )
    });
    this.plugin.addCommand({
      id: "zoom-to-selection",
      name: "Zoom to selection",
      checkCallback: canvasCommand(
        this.plugin,
        (canvas) => canvas.selection.size > 0,
        (canvas) => canvas.zoomToSelection()
      )
    });
    for (const direction of DIRECTIONS) {
      this.plugin.addCommand({
        id: `clone-node-${direction}`,
        name: `Clone node ${direction}`,
        checkCallback: canvasCommand(
          this.plugin,
          (canvas) => {
            var _a;
            return !canvas.readonly && canvas.selection.size === 1 && ((_a = canvas.selection.values().next().value) == null ? void 0 : _a.getData().type) === "text";
          },
          (canvas) => this.cloneNode(canvas, direction)
        )
      });
      this.plugin.addCommand({
        id: `expand-node-${direction}`,
        name: `Expand node ${direction}`,
        checkCallback: canvasCommand(
          this.plugin,
          (canvas) => !canvas.readonly && canvas.selection.size === 1,
          (canvas) => this.expandNode(canvas, direction)
        )
      });
    }
  }
  createTextNode(canvas) {
    const size = canvas.config.defaultTextNodeDimensions;
    const pos = getCenterCoordinates(canvas, size);
    canvas.createTextNode({ pos, size });
  }
  cloneNode(canvas, cloneDirection) {
    const sourceNode = canvas.selection.values().next().value;
    if (!sourceNode)
      return;
    const sourceNodeData = sourceNode.getData();
    const nodeMargin = this.plugin.settingsManager.getSetting("cloneNodeMargin");
    const offset = {
      x: (sourceNode.width + nodeMargin) * (cloneDirection === "left" ? -1 : cloneDirection === "right" ? 1 : 0),
      y: (sourceNode.height + nodeMargin) * (cloneDirection === "up" ? -1 : cloneDirection === "down" ? 1 : 0)
    };
    const clonedNode = canvas.createTextNode({
      pos: {
        x: sourceNode.x + offset.x,
        y: sourceNode.y + offset.y
      },
      size: {
        width: sourceNode.width,
        height: sourceNode.height
      }
    });
    clonedNode.color = sourceNode.color;
    canvas.setNodeData(clonedNode, "shape", sourceNodeData.shape);
    if (this.plugin.settingsManager.getSetting("zoomToClonedNode"))
      canvas.zoomToBbox(clonedNode.getBBox());
  }
  expandNode(canvas, expandDirection) {
    const node = canvas.selection.values().next().value;
    if (!node)
      return;
    const expandNodeStepSize = this.plugin.settingsManager.getSetting("expandNodeStepSize");
    const expand = {
      x: expandDirection === "left" ? -1 : expandDirection === "right" ? 1 : 0,
      y: expandDirection === "up" ? -1 : expandDirection === "down" ? 1 : 0
    };
    node.setData({
      ...node.getData(),
      width: node.width + expand.x * expandNodeStepSize,
      height: node.height + expand.y * expandNodeStepSize
    });
  }
};

// src/canvas-extensions/portals-canvas-extension.ts
var import_obsidian5 = require("obsidian");
var PORTAL_PADDING = 50;
var MIN_OPEN_PORTAL_SIZE = { width: 200, height: 200 };
var PortalsCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("portalsFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.updatePopupMenu(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeRemoved,
      (canvas, node) => this.onNodeRemoved(canvas, node)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeMoved,
      (canvas, node) => this.onNodeMoved(canvas, node)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DraggingStateChanged,
      (canvas, startedDragging) => this.onDraggingStateChanged(canvas, startedDragging)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.SelectionChanged,
      (canvas, oldSelection, updateSelection) => this.onSelectionChanged(canvas, oldSelection, updateSelection)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (canvas, edge) => this.onEdgeChanged(canvas, edge)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.Undo,
      (canvas) => {
        this.getCanvasDataWithPortals(canvas, canvas.getData()).then((data) => canvas.importData(data));
      }
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.Redo,
      (canvas) => {
        this.getCanvasDataWithPortals(canvas, canvas.getData()).then((data) => canvas.importData(data));
      }
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DataRequested,
      (canvas, data) => this.removePortalCanvasData(canvas, data)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.LoadData,
      (canvas, data, setData) => {
        this.getCanvasDataWithPortals(canvas, data).then((newData) => {
          if (newData.nodes.length === data.nodes.length && newData.edges.length === data.edges.length)
            return;
          setData(newData);
        });
      }
    ));
  }
  updatePopupMenu(canvas) {
    if (canvas.readonly)
      return;
    const selectedFileNodes = canvas.getSelectionData().nodes.map((nodeData) => {
      var _a;
      const node = canvas.nodes.get(nodeData.id);
      if (!node)
        return null;
      if (nodeData.type !== "file")
        return null;
      if (((_a = node.file) == null ? void 0 : _a.extension) === "canvas")
        return node;
      if (nodeData.portalToFile)
        this.setPortalOpen(canvas, node, false);
      return null;
    }).filter((node) => node !== null);
    if (selectedFileNodes.length !== 1)
      return;
    const portalNode = selectedFileNodes[0];
    const portalNodeData = portalNode.getData();
    if (portalNodeData.portalToFile && portalNodeData.file !== portalNodeData.portalToFile) {
      this.setPortalOpen(canvas, portalNode, true);
    }
    addPopupMenuOption(
      canvas,
      createPopupMenuOption({
        id: "toggle-portal",
        label: portalNodeData.portalToFile ? "Close portal" : "Open portal",
        icon: portalNodeData.portalToFile ? "door-open" : "door-closed",
        callback: () => {
          this.setPortalOpen(canvas, portalNode, portalNodeData.portalToFile === void 0);
          this.updatePopupMenu(canvas);
        }
      })
    );
  }
  setPortalOpen(canvas, portalNode, open) {
    const portalNodeData = portalNode.getData();
    canvas.setNodeData(portalNode, "portalToFile", open ? portalNodeData.file : void 0);
    canvas.setData(canvas.getData());
  }
  onNodeRemoved(canvas, node) {
    var _a, _b, _c, _d;
    const nodeData = node.getData();
    if (nodeData.type !== "file" || !nodeData.portalToFile)
      return;
    Object.keys((_b = (_a = nodeData.portalIdMaps) == null ? void 0 : _a.nodeIdMap) != null ? _b : {}).map((refNodeId) => canvas.nodes.get(refNodeId)).filter((node2) => node2 !== void 0).forEach((node2) => canvas.removeNode(node2));
    Object.keys((_d = (_c = nodeData.portalIdMaps) == null ? void 0 : _c.edgeIdMap) != null ? _d : {}).map((refEdgeId) => canvas.edges.get(refEdgeId)).filter((edge) => edge !== void 0).forEach((edge) => canvas.removeEdge(edge));
  }
  onEdgeChanged(_canvas, edge) {
    const isUnsaved = edge.from.node !== void 0 && edge.to.node !== void 0 && // Edge not fully connected
    (edge.from.node.getData().portalId !== void 0 && edge.to.node.getData().portalId !== void 0) && // Both nodes are from portal
    edge.getData().portalId === void 0;
    edge.setData({
      ...edge.getData(),
      isUnsaved: isUnsaved ? true : void 0
    });
  }
  onSelectionChanged(canvas, oldSelection, updateSelection) {
    updateSelection(() => {
      const updatedSelection = Array.from(canvas.selection).filter((node) => node.getData().portalId === void 0);
      canvas.selection = new Set(updatedSelection);
    });
    const previouslySelectedPortalNodesIds = Array.from(oldSelection).filter((node) => node.getData().portalToFile !== void 0).flatMap((node) => {
      const portalNodeData = node.getData();
      const nestedPortalsIds = this.getNestedPortalsIds(canvas, portalNodeData.id);
      return [portalNodeData.id, ...nestedPortalsIds];
    });
    for (const node of canvas.nodes.values()) {
      const nodeData = node.getData();
      if (nodeData.portalId === void 0 || !previouslySelectedPortalNodesIds.includes(nodeData.portalId))
        continue;
      node.updateZIndex();
    }
  }
  getNestedPortalsIds(canvas, portalId) {
    const nestedPortalsIds = [];
    for (const node of canvas.nodes.values()) {
      const nodeData = node.getData();
      if (nodeData.portalId === portalId) {
        nestedPortalsIds.push(nodeData.id);
        nestedPortalsIds.push(...this.getNestedPortalsIds(canvas, nodeData.id));
      }
    }
    return nestedPortalsIds;
  }
  onDraggingStateChanged(canvas, startedDragging) {
    var _a;
    if (!canvas.getSelectionData().nodes.some((node) => node.type === "file" && node.portalToFile))
      return;
    if (startedDragging) {
      const objectSnappingEnabled = canvas.options.snapToObjects;
      this.restoreObjectSnappingState = () => canvas.toggleObjectSnapping(objectSnappingEnabled);
      if (objectSnappingEnabled)
        canvas.toggleObjectSnapping(false);
    } else
      (_a = this.restoreObjectSnappingState) == null ? void 0 : _a.call(this);
  }
  onNodeMoved(canvas, node) {
    const nodeData = node.getData();
    if (nodeData.type !== "file" || !nodeData.portalToFile)
      return;
    this.onOpenPortalMoved(canvas, node);
  }
  onOpenPortalMoved(canvas, portalNode) {
    var _a;
    let portalNodeData = portalNode.getData();
    const nestedNodesIdMap = (_a = portalNode.getData().portalIdMaps) == null ? void 0 : _a.nodeIdMap;
    if (!nestedNodesIdMap)
      return;
    const nestedNodes = Object.keys(nestedNodesIdMap).map((refNodeId) => canvas.nodes.get(refNodeId)).filter((node) => node !== void 0);
    const sourceBBox = getBBox(nestedNodes);
    const targetSize = this.getPortalSize(sourceBBox);
    if (portalNodeData.width !== targetSize.width || portalNodeData.height !== targetSize.height) {
      portalNode.setData({
        ...portalNodeData,
        width: targetSize.width,
        height: targetSize.height
      });
      return;
    }
    const portalOffset = {
      x: portalNodeData.x - sourceBBox.minX + PORTAL_PADDING,
      y: portalNodeData.y - sourceBBox.minY + PORTAL_PADDING
    };
    for (const nestedNode of nestedNodes) {
      const nestedNodeData = nestedNode.getData();
      nestedNode.setData({
        ...nestedNodeData,
        x: nestedNodeData.x + portalOffset.x,
        y: nestedNodeData.y + portalOffset.y
      });
    }
  }
  removePortalCanvasData(_canvas, data) {
    var _a, _b;
    data.edges = data.edges.filter((edgeData) => {
      var _a2, _b2;
      if (edgeData.portalId !== void 0)
        return false;
      const fromNodeData = data.nodes.find((nodeData) => nodeData.id === edgeData.fromNode);
      const toNodeData = data.nodes.find((nodeData) => nodeData.id === edgeData.toNode);
      if (!fromNodeData || !toNodeData)
        return true;
      if (fromNodeData.portalId === void 0 && toNodeData.portalId === void 0) {
        return true;
      } else if (fromNodeData.portalId !== void 0 && toNodeData.portalId !== void 0) {
        return false;
      } else {
        const fromPortalNodeData = fromNodeData.portalId !== void 0 ? fromNodeData : toNodeData;
        const notFromPortalNodeData = fromNodeData.portalId !== void 0 ? toNodeData : fromNodeData;
        notFromPortalNodeData.edgesToNodeFromPortal = (_a2 = notFromPortalNodeData.edgesToNodeFromPortal) != null ? _a2 : {};
        notFromPortalNodeData.edgesToNodeFromPortal[fromPortalNodeData.portalId] = (_b2 = notFromPortalNodeData.edgesToNodeFromPortal[fromPortalNodeData.portalId]) != null ? _b2 : [];
        notFromPortalNodeData.edgesToNodeFromPortal[fromPortalNodeData.portalId].push(edgeData);
        return false;
      }
    });
    data.nodes = data.nodes.filter((nodeData) => nodeData.portalId === void 0);
    for (const portalNodeData of data.nodes) {
      if (portalNodeData.type !== "file")
        continue;
      if (this.plugin.settingsManager.getSetting("maintainClosedPortalSize")) {
        portalNodeData.width = (_a = portalNodeData.closedPortalWidth) != null ? _a : portalNodeData.width;
        portalNodeData.height = (_b = portalNodeData.closedPortalHeight) != null ? _b : portalNodeData.height;
      }
      delete portalNodeData.closedPortalWidth;
      delete portalNodeData.closedPortalHeight;
      delete portalNodeData.portalIdMaps;
    }
  }
  async getCanvasDataWithPortals(canvas, dataRef) {
    const data = JSON.parse(JSON.stringify(dataRef));
    const addedData = await Promise.all(data.nodes.map((nodeData) => this.tryOpenPortal(canvas, nodeData)));
    for (const newData of addedData) {
      data.nodes.push(...newData.nodes);
      data.edges.push(...newData.edges);
    }
    for (const originNodeData of data.nodes) {
      if (originNodeData.edgesToNodeFromPortal === void 0)
        continue;
      for (const [relativePortalId, edges] of Object.entries(originNodeData.edgesToNodeFromPortal)) {
        const idPrefix = originNodeData.portalId ? `${originNodeData.portalId}-` : "";
        const portalId = `${idPrefix}${relativePortalId}`;
        const targetPortalData = data.nodes.find((nodeData) => nodeData.id === portalId);
        if (!targetPortalData) {
          delete originNodeData.edgesToNodeFromPortal[portalId];
          continue;
        }
        if (targetPortalData.portalToFile) {
          data.edges.push(...edges.map((edge) => ({
            ...edge,
            portalId: originNodeData.portalId,
            fromNode: `${idPrefix}${edge.fromNode}`,
            toNode: `${idPrefix}${edge.toNode}`
          })));
          delete originNodeData.edgesToNodeFromPortal[portalId];
        } else if (this.plugin.settingsManager.getSetting("showEdgesIntoDisabledPortals")) {
          data.edges.push(...edges.map((edge) => {
            const fromNodeId = `${idPrefix}${edge.fromNode}`;
            const fromNode = data.nodes.find((nodeData) => nodeData.id === fromNodeId);
            const toNodeId = `${idPrefix}${edge.toNode}`;
            return {
              ...edge,
              fromNode: fromNode ? fromNodeId : portalId,
              toNode: fromNode ? portalId : toNodeId,
              portalId
              // Mark it as temporary
            };
          }));
        }
      }
      if (Object.keys(originNodeData.edgesToNodeFromPortal).length === 0)
        delete originNodeData.edgesToNodeFromPortal;
    }
    return data;
  }
  async tryOpenPortal(canvas, portalNodeData) {
    var _a, _b;
    const addedData = { nodes: [], edges: [] };
    if (portalNodeData.type !== "file" || !portalNodeData.portalToFile)
      return addedData;
    portalNodeData.portalToFile = portalNodeData.file;
    if (portalNodeData.portalToFile === canvas.view.file.path) {
      portalNodeData.portalToFile = void 0;
      return addedData;
    }
    const portalFile = this.plugin.app.vault.getAbstractFileByPath(portalNodeData.file);
    if (!(portalFile instanceof import_obsidian5.TFile) || portalFile.extension !== "canvas") {
      portalNodeData.portalToFile = void 0;
      return addedData;
    }
    const portalFileData = JSON.parse(await this.plugin.app.vault.cachedRead(portalFile));
    if (!portalFileData) {
      portalNodeData.portalToFile = void 0;
      return addedData;
    }
    portalNodeData.portalIdMaps = {
      nodeIdMap: {},
      edgeIdMap: {}
    };
    const sourceMinCoordinates = getBBox(portalFileData.nodes);
    const portalOffset = {
      x: portalNodeData.x - sourceMinCoordinates.minX + PORTAL_PADDING,
      y: portalNodeData.y - sourceMinCoordinates.minY + PORTAL_PADDING
    };
    for (const nodeDataFromPortal of portalFileData.nodes) {
      const refNodeId = `${portalNodeData.id}-${nodeDataFromPortal.id}`;
      portalNodeData.portalIdMaps.nodeIdMap[refNodeId] = nodeDataFromPortal.id;
      const addedNode = {
        ...nodeDataFromPortal,
        id: refNodeId,
        x: nodeDataFromPortal.x + portalOffset.x,
        y: nodeDataFromPortal.y + portalOffset.y,
        portalId: portalNodeData.id
      };
      addedData.nodes.push(addedNode);
      const nestedNodes = await this.tryOpenPortal(canvas, addedNode);
      addedData.nodes.push(...nestedNodes.nodes);
      addedData.edges.push(...nestedNodes.edges);
    }
    for (const edgeDataFromPortal of portalFileData.edges) {
      const refEdgeId = `${portalNodeData.id}-${edgeDataFromPortal.id}`;
      portalNodeData.portalIdMaps.edgeIdMap[refEdgeId] = edgeDataFromPortal.id;
      const fromRefNode = (_a = Object.entries(portalNodeData.portalIdMaps.nodeIdMap).find(([_refNodeId, nodeId]) => nodeId === edgeDataFromPortal.fromNode)) == null ? void 0 : _a[0];
      const toRefNode = (_b = Object.entries(portalNodeData.portalIdMaps.nodeIdMap).find(([_refNodeId, nodeId]) => nodeId === edgeDataFromPortal.toNode)) == null ? void 0 : _b[0];
      addedData.edges.push({
        ...edgeDataFromPortal,
        id: refEdgeId,
        fromNode: fromRefNode,
        toNode: toRefNode,
        portalId: portalNodeData.id
      });
    }
    const nestedNodesBBox = getBBox(addedData.nodes);
    const targetSize = this.getPortalSize(nestedNodesBBox);
    portalNodeData.closedPortalWidth = portalNodeData.width;
    portalNodeData.closedPortalHeight = portalNodeData.height;
    portalNodeData.width = targetSize.width;
    portalNodeData.height = targetSize.height;
    return addedData;
  }
  getPortalSize(sourceBBox) {
    const sourceSize = {
      width: sourceBBox.maxX - sourceBBox.minX,
      height: sourceBBox.maxY - sourceBBox.minY
    };
    const targetSize = {
      width: Math.max(sourceSize.width + PORTAL_PADDING * 2, MIN_OPEN_PORTAL_SIZE.width),
      height: Math.max(sourceSize.height + PORTAL_PADDING * 2, MIN_OPEN_PORTAL_SIZE.height)
    };
    if (!Number.isFinite(targetSize.width))
      targetSize.width = MIN_OPEN_PORTAL_SIZE.width;
    if (!Number.isFinite(targetSize.height))
      targetSize.height = MIN_OPEN_PORTAL_SIZE.height;
    return targetSize;
  }
};

// src/utils/icons-helper.ts
var import_obsidian6 = require("obsidian");
var CUSTOM_ICONS = {
  "oval": `<rect rx="31.25" height="62.5" width="93.75" y="18.75" x="3.125" stroke-width="8.333" stroke="currentColor" fill="transparent"/>`,
  "parallelogram": `<rect transform="skewX(-20)" rx="5" height="50" width="70" y="25" x="35" stroke-width="8.333" stroke="currentColor" fill="transparent"/>`,
  "predefined-process": `
    <g stroke-width="2" stroke="currentColor" fill="none" transform="matrix(4.166667,0,0,4.166667,0,0)">
      <path d="M 4.999687 3 L 19.000312 3 C 20.104688 3 21 3.895312 21 4.999687 L 21 19.000312 C 21 20.104688 20.104688 21 19.000312 21 L 4.999687 21 C 3.895312 21 3 20.104688 3 19.000312 L 3 4.999687 C 3 3.895312 3.895312 3 4.999687 3 Z M 4.999687 3 "/>
      <path d="M 7 3 L 7 21 "/>
      <path d="M 17 3 L 17 21 "/>
    </g>
  `,
  "document": `<path transform="translate(0, 5)" stroke="currentColor" fill="none" stroke-width="8.333" d="M83.75 25C85.82 25 87.5 26.68 87.5 28.75L87.5 64.375Q68.75 54.25 50 64.375 31.25 74.5 12.5 64.375L12.5 30.625 12.5 28.75C12.5 26.68 14.18 25 16.25 25Z"/>`,
  "database-shape": `
    <g transform="translate(20, 20)" stroke-width="8.333" stroke="currentColor" fill="none">
      <path d="M 1 51 L 1 11 C 1 5.48 14.43 1 31 1 C 47.57 1 61 5.48 61 11 L 61 51 C 61 56.52 47.57 61 31 61 C 14.43 61 1 56.52 1 51 Z"/>
      <path d="M 1 11 C 1 16.52 14.43 21 31 21 C 47.57 21 61 16.52 61 11"/>
    </g>
  `,
  "dotted-line": `<path stroke="currentColor" fill="none" stroke-width="8.5" stroke-dasharray="8.5" d="M20.85 50h58.5"/>`,
  "short-dashed-line": `<path stroke="currentColor" fill="none" stroke-width="8.5" stroke-dasharray="10" d="M20.85 50h58.5"/>`,
  "long-dashed-line": `<path stroke="currentColor" fill="none" stroke-width="8.5" stroke-dasharray="20" d="M20.85 50h58.5"/>`
};
var IconsHelper = class {
  static addIcons() {
    for (const [id, svg] of Object.entries(CUSTOM_ICONS)) {
      (0, import_obsidian6.addIcon)(id, svg);
    }
  }
};

// src/canvas-extensions/stickers-canvas-extension.ts
var IMAGE_FILE_EXTENSIONS = ["bmp", "png", "jpg", "jpeg", "gif", "svg", "webp", "avif"];
var StickersCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("stickersFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
  }
  onPopupMenuCreated(canvas) {
    if (canvas.readonly || !this.hasValidNodeInSelection(canvas))
      return;
    addPopupMenuOption(
      canvas,
      createPopupMenuOption({
        id: "sticker-option",
        label: "Toggle sticker",
        icon: "badge",
        callback: () => this.toggleStickerForSelection(canvas)
      })
    );
  }
  hasValidNodeInSelection(canvas) {
    var _a, _b;
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type !== "file")
        continue;
      const nodeFileExtension = (_b = (_a = nodeData.file) == null ? void 0 : _a.split(".").pop()) == null ? void 0 : _b.toLowerCase();
      if (!nodeFileExtension)
        continue;
      if (!IMAGE_FILE_EXTENSIONS.includes(nodeFileExtension))
        continue;
      return true;
    }
    return false;
  }
  toggleStickerForSelection(canvas) {
    const selectedNodesData = canvas.getSelectionData().nodes;
    for (const nodeData of selectedNodesData) {
      if (nodeData.type !== "file")
        continue;
      const node = canvas.nodes.get(nodeData.id);
      if (!node)
        continue;
      const wasSticker = node.getData().isSticker;
      canvas.setNodeData(node, "isSticker", wasSticker ? void 0 : true);
    }
  }
};

// src/utils/a-star-helper.ts
var DIRECTIONS2 = [
  { dx: 1, dy: 0 },
  { dx: -1, dy: 0 },
  { dx: 0, dy: 1 },
  { dx: 0, dy: -1 },
  { dx: 1, dy: 1 },
  { dx: -1, dy: 1 },
  { dx: 1, dy: -1 },
  { dx: -1, dy: -1 }
];
var DIAGONAL_COST = Math.sqrt(2);
var Node = class {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.gCost = 0;
    this.hCost = 0;
    this.fCost = 0;
    this.parent = null;
  }
  // Only check for x and y, not gCost, hCost, fCost, or parent
  inList(nodes) {
    return nodes.some((n) => n.x === this.x && n.y === this.y);
  }
};
function heuristic(node, end) {
  return Math.abs(node.x - end.x) + Math.abs(node.y - end.y);
}
function isTouchingObstacle(node, obstacles) {
  return obstacles.some((obstacle) => insideBBox(node, obstacle, true));
}
function isInsideObstacle(node, obstacles) {
  return obstacles.some((obstacle) => insideBBox(node, obstacle, false));
}
function getMovementCost(direction) {
  return direction.dx !== 0 && direction.dy !== 0 ? DIAGONAL_COST : 1;
}
function getPossibleNeighbors(node, obstacles, gridResolution) {
  const neighbors = [];
  for (const direction of DIRECTIONS2) {
    const neighbor = new Node(
      node.x + direction.dx * gridResolution,
      node.y + direction.dy * gridResolution
    );
    neighbor.gCost = node.gCost + getMovementCost(direction);
    if (isInsideObstacle(neighbor, obstacles))
      continue;
    neighbors.push(neighbor);
  }
  return neighbors;
}
function reconstructPath(node) {
  const path = [];
  while (node) {
    path.push(node);
    node = node.parent;
  }
  return path.reverse();
}
function aStar(fromPos, fromSide, toPos, toSide, obstacles, gridResolution) {
  const start = new Node(
    Math.floor(fromPos.x / gridResolution) * gridResolution,
    Math.floor(fromPos.y / gridResolution) * gridResolution
  );
  if (fromSide === "right" && fromPos.x !== start.x)
    start.x += gridResolution;
  if (fromSide === "bottom" && fromPos.y !== start.y)
    start.y += gridResolution;
  const end = new Node(
    Math.floor(toPos.x / gridResolution) * gridResolution,
    Math.floor(toPos.y / gridResolution) * gridResolution
  );
  if (toSide === "right" && toPos.x !== end.x)
    end.x += gridResolution;
  if (toSide === "bottom" && toPos.y !== end.y)
    end.y += gridResolution;
  if (isInsideObstacle(start, obstacles) || isInsideObstacle(end, obstacles))
    return null;
  const openSet = [start];
  const closedSet = [];
  while (openSet.length > 0) {
    let current = null;
    let lowestFCost = Infinity;
    for (const node of openSet) {
      if (node.fCost < lowestFCost) {
        current = node;
        lowestFCost = node.fCost;
      }
    }
    if (!current)
      return null;
    openSet.splice(openSet.indexOf(current), 1);
    closedSet.push(current);
    if (current.x === end.x && current.y === end.y) {
      return [fromPos, ...reconstructPath(current), toPos].map((node) => ({ x: node.x, y: node.y }));
    }
    if (!(current.x === start.x && current.y === start.y) && isTouchingObstacle(current, obstacles))
      continue;
    for (const neighbor of getPossibleNeighbors(current, obstacles, gridResolution)) {
      if (neighbor.inList(closedSet))
        continue;
      const tentativeGCost = current.gCost + getMovementCost({
        dx: neighbor.x - current.x,
        dy: neighbor.y - current.y
      });
      if (!neighbor.inList(openSet) || tentativeGCost < neighbor.gCost) {
        neighbor.parent = current;
        neighbor.gCost = tentativeGCost;
        neighbor.hCost = heuristic(neighbor, end);
        neighbor.fCost = neighbor.gCost + neighbor.hCost;
        openSet.push(neighbor);
      }
    }
  }
  return null;
}

// src/utils/svg-path-helper.ts
function pathArrayToSvgPath(positions, rounded = false) {
  const tension = 0.2;
  let newPositions = [...positions];
  if (rounded && positions.length > 2) {
    newPositions = [positions[0]];
    for (let i = 1; i < positions.length - 2; i++) {
      const p1 = positions[i];
      const p2 = positions[i + 1];
      const p3 = positions[i + 2];
      const t1 = (1 - tension) / 2;
      const t2 = 1 - t1;
      const x = t2 * t2 * t2 * p1.x + 3 * t2 * t2 * t1 * p2.x + 3 * t2 * t1 * t1 * p3.x + t1 * t1 * t1 * p2.x;
      const y = t2 * t2 * t2 * p1.y + 3 * t2 * t2 * t1 * p2.y + 3 * t2 * t1 * t1 * p3.y + t1 * t1 * t1 * p2.y;
      newPositions.push({ x, y });
    }
    const lastPoint = positions[positions.length - 1];
    newPositions.push(lastPoint);
  }
  for (let i = 0; i < newPositions.length - 2; i++) {
    const p1 = newPositions[i];
    const p2 = newPositions[i + 1];
    const p3 = newPositions[i + 2];
    const currentDirection = {
      x: p2.x - p1.x,
      y: p2.y - p1.y
    };
    const nextDirection = {
      x: p3.x - p2.x,
      y: p3.y - p2.y
    };
    if (currentDirection.x !== nextDirection.x && currentDirection.y !== nextDirection.y)
      continue;
    newPositions.splice(i + 1, 1);
    i--;
  }
  return newPositions.map(
    (position, index) => `${index === 0 ? "M" : "L"} ${position.x} ${position.y}`
  ).join(" ");
}

// src/canvas-extensions/edges-style-canvas-extension.ts
var STYLES_MENU_OPTIONS = [
  {
    id: void 0,
    label: "Default",
    icon: "minus"
  },
  {
    id: "long-dashed",
    label: "Dashed (long)",
    icon: "long-dashed-line"
  },
  {
    id: "short-dashed",
    label: "Dashed",
    icon: "short-dashed-line"
  },
  {
    id: "dotted",
    label: "Dotted",
    icon: "dotted-line"
  }
];
var ROUTES_MENU_OPTIONS = [
  {
    id: void 0,
    label: "Default",
    icon: "route"
  },
  {
    id: "direct",
    label: "Direct",
    icon: "minus"
  },
  {
    id: "a-star",
    label: "A*",
    icon: "navigation"
  }
];
var EdgesStyleCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    if (!this.plugin.settingsManager.getSetting("edgesStylingFeatureEnabled"))
      return;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.onPopupMenuCreated(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (canvas, edge) => this.onEdgeChanged(canvas, edge)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeCenterRequested,
      (canvas, edge, center) => this.onEdgeCenterRequested(canvas, edge, center)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeAdded,
      (canvas, _node) => this.updateAllEdges(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeRemoved,
      (canvas, _node) => this.updateAllEdges(canvas)
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.DraggingStateChanged,
      (canvas, isDragging) => {
        if (!isDragging)
          this.updateAllEdges(canvas);
      }
    ));
  }
  onPopupMenuCreated(canvas) {
    const selectedEdges = [...canvas.selection].filter((item) => item.path !== void 0);
    if (canvas.readonly || selectedEdges.length === 0)
      return;
    const pathStyleNestedOptions = STYLES_MENU_OPTIONS.map((style) => ({
      ...style,
      id: void 0,
      callback: () => this.setStyleForSelection(canvas, selectedEdges, style.id)
    }));
    const pathStyleMenuOption = createExpandablePopupMenuOption({
      id: "edge-style-option",
      label: "Edge style",
      icon: "minus"
    }, pathStyleNestedOptions);
    addPopupMenuOption(canvas, pathStyleMenuOption, -2);
    const pathRouteNestedOptions = ROUTES_MENU_OPTIONS.map((route) => ({
      ...route,
      id: void 0,
      callback: () => this.setPathRouteForSelection(canvas, selectedEdges, route.id)
    }));
    const pathRouteMenuOption = createExpandablePopupMenuOption({
      id: "edge-path-route-option",
      label: "Edge path route",
      icon: "route"
    }, pathRouteNestedOptions);
    addPopupMenuOption(canvas, pathRouteMenuOption, -2);
  }
  setStyleForSelection(canvas, selectedEdges, styleId) {
    for (const edge of selectedEdges) {
      canvas.setEdgeData(edge, "edgeStyle", styleId);
    }
  }
  setPathRouteForSelection(canvas, selectedEdges, pathRouteTypeId) {
    for (const edge of selectedEdges) {
      canvas.setEdgeData(edge, "edgePathRoute", pathRouteTypeId);
    }
  }
  updateAllEdges(canvas) {
    for (const edge of canvas.edges.values()) {
      this.onEdgeChanged(canvas, edge);
    }
  }
  onEdgeChanged(canvas, edge) {
    var _a, _b, _c;
    if (!edge.bezier)
      return;
    edge.updatePath();
    edge.center = void 0;
    const pathRouteType = (_a = edge.getData().edgePathRoute) != null ? _a : "default";
    if (pathRouteType === "default") {
      (_b = edge.labelElement) == null ? void 0 : _b.render();
      return;
    }
    const fromPos = edge.from.end === "none" ? getCenterOfBBoxSide(edge.from.node.getBBox(), edge.from.side) : edge.bezier.from;
    const toPos = edge.to.end === "none" ? getCenterOfBBoxSide(edge.to.node.getBBox(), edge.to.side) : edge.bezier.to;
    let newPath = edge.path.display.getAttribute("d");
    if (pathRouteType === "direct") {
      newPath = pathArrayToSvgPath([fromPos, toPos], false);
      edge.center = {
        x: (fromPos.x + toPos.x) / 2,
        y: (fromPos.y + toPos.y) / 2
      };
    } else if (pathRouteType === "a-star") {
      if (canvas.isDragging && !this.plugin.settingsManager.getSetting("edgeStylePathfinderPathLiveUpdate"))
        return;
      const nodeBBoxes = [...canvas.nodes.values()].filter((node) => {
        const nodeData = node.getData();
        const isGroup = nodeData.type === "group";
        const isOpenPortal = nodeData.portalToFile !== void 0;
        return !isGroup && !isOpenPortal;
      }).map((node) => node.getBBox());
      const gridResolution = this.plugin.settingsManager.getSetting("edgeStylePathfinderGridResolution");
      const pathArray = aStar(fromPos, edge.from.side, toPos, edge.to.side, nodeBBoxes, gridResolution);
      if (!pathArray)
        return;
      const roundedPath = this.plugin.settingsManager.getSetting("edgeStylePathfinderPathRounded");
      const svgPath = pathArrayToSvgPath(pathArray, roundedPath);
      newPath = svgPath;
      edge.center = pathArray[Math.floor(pathArray.length / 2)];
    }
    edge.path.interaction.setAttr("d", newPath);
    edge.path.display.setAttr("d", newPath);
    (_c = edge.labelElement) == null ? void 0 : _c.render();
  }
  onEdgeCenterRequested(_canvas, edge, center) {
    var _a, _b, _c, _d;
    center.x = (_b = (_a = edge.center) == null ? void 0 : _a.x) != null ? _b : center.x;
    center.y = (_d = (_c = edge.center) == null ? void 0 : _c.y) != null ? _d : center.y;
  }
};

// src/canvas-extensions/edge-data-tagger-canvas-extension.ts
function getExposedEdgeData(settings) {
  const exposedData = [];
  if (settings.getSetting("edgesStylingFeatureEnabled"))
    exposedData.push("edgeStyle");
  if (settings.getSetting("portalsFeatureEnabled"))
    exposedData.push("isUnsaved");
  return exposedData;
}
var EdgeDataTaggerCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (_canvas, edge) => {
        const edgeData = edge == null ? void 0 : edge.getData();
        if (!edgeData)
          return;
        for (const dataKey of getExposedEdgeData(this.plugin.settingsManager)) {
          const dataValue = edgeData[dataKey];
          if (dataValue === void 0)
            delete edge.path.display.dataset[dataKey];
          else
            edge.path.display.dataset[dataKey] = dataValue;
        }
      }
    ));
  }
};

// src/utils/debug-helper.ts
var DebugHelper = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeAdded,
      (_canvas, _node) => console.log("\u{1F7E2} NodeAdded")
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.NodeChanged,
      (_canvas, _node) => console.log("\u{1F7E1} NodeChanged")
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeAdded,
      (_canvas, _edge) => console.log("\u{1F7E2} EdgeAdded")
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.EdgeChanged,
      (_canvas, _edge) => console.log("\u{1F7E1} EdgeChanged")
    ));
  }
};

// src/canvas-extensions/default-node-size-canvas-extension.ts
var DefaultNodeSizeCanvasExtension = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.CanvasChanged,
      (canvas) => canvas.config.defaultTextNodeDimensions = { width: 260, height: 60 }
    ));
  }
};

// src/canvas-extensions/color-palette-canvas-extension.ts
var DEFAULT_COLORS_COUNT = 6;
var CUSTOM_COLORS_MOD_STYLES_ID = "mod-custom-colors";
var ColorPaletteCanvasExtension = class {
  constructor(plugin) {
    this.observer = null;
    this.plugin = plugin;
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      "css-change",
      () => this.updateCustomColorModStyleClasses()
    ));
    this.plugin.registerEvent(this.plugin.app.workspace.on(
      CanvasEvent.PopupMenuCreated,
      (canvas) => this.patchColorSelection(canvas)
    ));
    this.plugin.register(() => {
      var _a;
      return (_a = this.observer) == null ? void 0 : _a.disconnect();
    });
  }
  updateCustomColorModStyleClasses() {
    var _a;
    (_a = document.getElementById(CUSTOM_COLORS_MOD_STYLES_ID)) == null ? void 0 : _a.remove();
    const customColorModStyle = document.createElement("style");
    customColorModStyle.id = CUSTOM_COLORS_MOD_STYLES_ID;
    document.body.appendChild(customColorModStyle);
    for (const colorId of this.getCustomColors()) {
      customColorModStyle.innerHTML += `
        .mod-canvas-color-${colorId} {
          --canvas-color: var(--canvas-color-${colorId});
        }
      `;
    }
  }
  patchColorSelection(canvas) {
    if (this.observer)
      this.observer.disconnect();
    this.observer = new MutationObserver((mutations) => {
      const colorMenuOpened = mutations.some(
        (mutation) => Object.values(mutation.addedNodes).some(
          (node) => node instanceof HTMLElement && node.classList.contains("canvas-submenu") && Object.values(node.childNodes).some(
            (node2) => node2 instanceof HTMLElement && node2.classList.contains("canvas-color-picker-item")
          )
        )
      );
      if (!colorMenuOpened)
        return;
      const submenu = canvas.menu.menuEl.querySelector(".canvas-submenu");
      if (!submenu)
        return;
      this.updateCustomColorModStyleClasses();
      const currentNodeColor = canvas.getSelectionData().nodes.map((node) => node.color).last();
      for (const colorId of this.getCustomColors()) {
        const customColorMenuItem = this.createColorMenuItem(canvas, colorId);
        if (currentNodeColor === colorId)
          customColorMenuItem.classList.add("is-active");
        submenu.insertBefore(customColorMenuItem, submenu.lastChild);
      }
    });
    this.observer.observe(canvas.menu.menuEl, { childList: true });
  }
  createColorMenuItem(canvas, colorId) {
    const menuItem = document.createElement("div");
    menuItem.classList.add("canvas-color-picker-item");
    menuItem.classList.add(`mod-canvas-color-${colorId}`);
    menuItem.addEventListener("click", () => {
      menuItem.classList.add("is-active");
      for (const item of canvas.selection) {
        item.setColor(colorId);
      }
      canvas.requestSave();
    });
    return menuItem;
  }
  getCustomColors() {
    const colors = [];
    while (true) {
      const colorId = (DEFAULT_COLORS_COUNT + colors.length + 1).toString();
      if (!getComputedStyle(document.body).getPropertyValue(`--canvas-color-${colorId}`))
        break;
      colors.push(colorId);
    }
    return colors;
  }
};

// src/main.ts
var CANVAS_EXTENSIONS = [
  NodeDataTaggerCanvasExtension,
  EdgeDataTaggerCanvasExtension,
  InteractionTaggerCanvasExtension,
  DefaultNodeSizeCanvasExtension,
  CommandsCanvasExtension,
  ReadonlyCanvasExtension,
  GroupCanvasExtension,
  EncapsulateCanvasExtension,
  ColorPaletteCanvasExtension,
  StickersCanvasExtension,
  ShapesCanvasExtension,
  EdgesStyleCanvasExtension,
  PresentationCanvasExtension,
  PortalsCanvasExtension
];
var AdvancedCanvasPlugin = class extends import_obsidian7.Plugin {
  async onload() {
    IconsHelper.addIcons();
    this.settingsManager = new AdvancedCanvasSettingsManager(this);
    await this.settingsManager.loadSettings();
    this.settingsManager.addSettingsTab();
    this.canvasEventEmitter = new CanvasEventEmitter(this);
    this.canvasExtensions = CANVAS_EXTENSIONS.map((Extension) => new Extension(this));
  }
  onunload() {
  }
  getCurrentCanvasView() {
    const canvasView = this.app.workspace.getActiveViewOfType(import_obsidian7.ItemView);
    if ((canvasView == null ? void 0 : canvasView.getViewType()) !== "canvas")
      return null;
    return canvasView;
  }
  getCurrentCanvas() {
    var _a;
    return ((_a = this.getCurrentCanvasView()) == null ? void 0 : _a.canvas) || null;
  }
  // this.app.plugins.plugins["advanced-canvas"].enableDebugMode()
  enableDebugMode() {
    if (this.debugHelper)
      return;
    this.debugHelper = new DebugHelper(this);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91dGlscy9jYW52YXMtaGVscGVyLnRzIiwgInNyYy91dGlscy9iYm94LWhlbHBlci50cyIsICJzcmMvZXZlbnRzL2V2ZW50cy50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvc2hhcGVzLWNhbnZhcy1leHRlbnNpb24udHMiLCAibm9kZV9tb2R1bGVzL21vbmtleS1hcm91bmQvbWpzL2luZGV4LmpzIiwgInNyYy91dGlscy9wYXRjaC1oZWxwZXIudHMiLCAic3JjL2V2ZW50cy9jYW52YXMtZXZlbnQtZW1pdHRlci50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZ3JvdXAtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvcHJlc2VudGF0aW9uLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL25vZGUtZGF0YS10YWdnZXItY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvaW50ZXJhY3Rpb24tdGFnZ2VyLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL3JlYWRvbmx5LWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL3V0aWxzL21vZGFsLWhlbHBlci50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZW5jYXBzdWxhdGUtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvY29tbWFuZHMtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvcG9ydGFscy1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgInNyYy91dGlscy9pY29ucy1oZWxwZXIudHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL3N0aWNrZXJzLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL3V0aWxzL2Etc3Rhci1oZWxwZXIudHMiLCAic3JjL3V0aWxzL3N2Zy1wYXRoLWhlbHBlci50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZWRnZXMtc3R5bGUtY2FudmFzLWV4dGVuc2lvbi50cyIsICJzcmMvY2FudmFzLWV4dGVuc2lvbnMvZWRnZS1kYXRhLXRhZ2dlci1jYW52YXMtZXh0ZW5zaW9uLnRzIiwgInNyYy91dGlscy9kZWJ1Zy1oZWxwZXIudHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL2RlZmF1bHQtbm9kZS1zaXplLWNhbnZhcy1leHRlbnNpb24udHMiLCAic3JjL2NhbnZhcy1leHRlbnNpb25zL2NvbG9yLXBhbGV0dGUtY2FudmFzLWV4dGVuc2lvbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgSXRlbVZpZXcsIFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJ1xyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNTZXR0aW5nc01hbmFnZXIgZnJvbSAnLi9zZXR0aW5ncydcclxuaW1wb3J0IFNoYXBlc0NhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL3NoYXBlcy1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgeyBDYW52YXMsIENhbnZhc1ZpZXcgfSBmcm9tICcuL0B0eXBlcy9DYW52YXMnXHJcbmltcG9ydCBDYW52YXNFdmVudEVtaXR0ZXIgZnJvbSAnLi9ldmVudHMvY2FudmFzLWV2ZW50LWVtaXR0ZXInXHJcbmltcG9ydCBHcm91cENhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL2dyb3VwLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBQcmVzZW50YXRpb25DYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9wcmVzZW50YXRpb24tY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IEludGVyYWN0aW9uVGFnZ2VyQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvaW50ZXJhY3Rpb24tdGFnZ2VyLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBOb2RlRGF0YVRhZ2dlckNhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL25vZGUtZGF0YS10YWdnZXItY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IFJlYWRvbmx5Q2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvcmVhZG9ubHktY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IEVuY2Fwc3VsYXRlQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvZW5jYXBzdWxhdGUtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IENvbW1hbmRzQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvY29tbWFuZHMtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IFBvcnRhbHNDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9wb3J0YWxzLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBJY29uc0hlbHBlciBmcm9tICcuL3V0aWxzL2ljb25zLWhlbHBlcidcclxuaW1wb3J0IFN0aWNrZXJzQ2FudmFzRXh0ZW5zaW9uIGZyb20gJy4vY2FudmFzLWV4dGVuc2lvbnMvc3RpY2tlcnMtY2FudmFzLWV4dGVuc2lvbidcclxuaW1wb3J0IEVkZ2VzU3R5bGVDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9lZGdlcy1zdHlsZS1jYW52YXMtZXh0ZW5zaW9uJ1xyXG5pbXBvcnQgRWRnZURhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9lZGdlLWRhdGEtdGFnZ2VyLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBEZWJ1Z0hlbHBlciBmcm9tICcuL3V0aWxzL2RlYnVnLWhlbHBlcidcclxuaW1wb3J0IERlZmF1bHROb2RlU2l6ZUNhbnZhc0V4dGVuc2lvbiBmcm9tICcuL2NhbnZhcy1leHRlbnNpb25zL2RlZmF1bHQtbm9kZS1zaXplLWNhbnZhcy1leHRlbnNpb24nXHJcbmltcG9ydCBDb2xvclBhbGV0dGVDYW52YXNFeHRlbnNpb24gZnJvbSAnLi9jYW52YXMtZXh0ZW5zaW9ucy9jb2xvci1wYWxldHRlLWNhbnZhcy1leHRlbnNpb24nXHJcblxyXG5jb25zdCBDQU5WQVNfRVhURU5TSU9OUzogYW55W10gPSBbXHJcbiAgTm9kZURhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgRWRnZURhdGFUYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgSW50ZXJhY3Rpb25UYWdnZXJDYW52YXNFeHRlbnNpb24sXHJcbiAgRGVmYXVsdE5vZGVTaXplQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIENvbW1hbmRzQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIFJlYWRvbmx5Q2FudmFzRXh0ZW5zaW9uLFxyXG4gIEdyb3VwQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIEVuY2Fwc3VsYXRlQ2FudmFzRXh0ZW5zaW9uLFxyXG4gIENvbG9yUGFsZXR0ZUNhbnZhc0V4dGVuc2lvbixcclxuICBTdGlja2Vyc0NhbnZhc0V4dGVuc2lvbixcclxuICBTaGFwZXNDYW52YXNFeHRlbnNpb24sXHJcbiAgRWRnZXNTdHlsZUNhbnZhc0V4dGVuc2lvbixcclxuICBQcmVzZW50YXRpb25DYW52YXNFeHRlbnNpb24sXHJcbiAgUG9ydGFsc0NhbnZhc0V4dGVuc2lvblxyXG5dXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZHZhbmNlZENhbnZhc1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgc2V0dGluZ3NNYW5hZ2VyOiBBZHZhbmNlZENhbnZhc1NldHRpbmdzTWFuYWdlclxyXG4gIGNhbnZhc0V2ZW50RW1pdHRlcjogQ2FudmFzRXZlbnRFbWl0dGVyXHJcbiAgY2FudmFzRXh0ZW5zaW9uczogYW55W11cclxuICBkZWJ1Z0hlbHBlcjogRGVidWdIZWxwZXJcclxuXHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG4gICAgSWNvbnNIZWxwZXIuYWRkSWNvbnMoKVxyXG4gICAgXHJcbiAgICB0aGlzLnNldHRpbmdzTWFuYWdlciA9IG5ldyBBZHZhbmNlZENhbnZhc1NldHRpbmdzTWFuYWdlcih0aGlzKVxyXG4gICAgYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIubG9hZFNldHRpbmdzKClcclxuICAgIHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmFkZFNldHRpbmdzVGFiKClcclxuXHJcbiAgICB0aGlzLmNhbnZhc0V2ZW50RW1pdHRlciA9IG5ldyBDYW52YXNFdmVudEVtaXR0ZXIodGhpcylcclxuICAgIHRoaXMuY2FudmFzRXh0ZW5zaW9ucyA9IENBTlZBU19FWFRFTlNJT05TLm1hcCgoRXh0ZW5zaW9uKSA9PiBuZXcgRXh0ZW5zaW9uKHRoaXMpKVxyXG5cdH1cclxuXHJcbiAgb251bmxvYWQoKSB7fVxyXG5cclxuICBnZXRDdXJyZW50Q2FudmFzVmlldygpOiBDYW52YXNWaWV3fG51bGwge1xyXG4gICAgY29uc3QgY2FudmFzVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKEl0ZW1WaWV3KVxyXG4gICAgaWYgKGNhbnZhc1ZpZXc/LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSByZXR1cm4gbnVsbFxyXG4gICAgcmV0dXJuIGNhbnZhc1ZpZXcgYXMgQ2FudmFzVmlld1xyXG4gIH1cclxuXHJcbiAgZ2V0Q3VycmVudENhbnZhcygpOiBDYW52YXN8bnVsbCB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRDdXJyZW50Q2FudmFzVmlldygpPy5jYW52YXMgfHwgbnVsbFxyXG4gIH1cclxuXHJcbiAgLy8gdGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wiYWR2YW5jZWQtY2FudmFzXCJdLmVuYWJsZURlYnVnTW9kZSgpXHJcbiAgZW5hYmxlRGVidWdNb2RlKCkge1xyXG4gICAgaWYgKHRoaXMuZGVidWdIZWxwZXIpIHJldHVyblxyXG4gICAgdGhpcy5kZWJ1Z0hlbHBlciA9IG5ldyBEZWJ1Z0hlbHBlcih0aGlzKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBOb3RpY2UsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcIi4vbWFpblwiXHJcblxyXG5jb25zdCBTTElERV9TSVpFX09QVElPTlM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XHJcbiAgJzEyMDB4Njc1JzogJzE2OjknLFxyXG4gICcxMzUweDkwMCc6ICczOjInLFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ3Mge1xyXG4gIHNoYXBlc0ZlYXR1cmVFbmFibGVkOiBib29sZWFuXHJcblxyXG4gIGVkZ2VzU3R5bGluZ0ZlYXR1cmVFbmFibGVkOiBib29sZWFuXHJcbiAgZWRnZVN0eWxlUGF0aGZpbmRlckdyaWRSZXNvbHV0aW9uOiBudW1iZXJcclxuICBlZGdlU3R5bGVQYXRoZmluZGVyUGF0aExpdmVVcGRhdGU6IGJvb2xlYW5cclxuICBlZGdlU3R5bGVQYXRoZmluZGVyUGF0aFJvdW5kZWQ6IGJvb2xlYW5cclxuXHJcbiAgY29tbWFuZHNGZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG4gIHpvb21Ub0Nsb25lZE5vZGU6IGJvb2xlYW5cclxuICBjbG9uZU5vZGVNYXJnaW46IG51bWJlclxyXG4gIGV4cGFuZE5vZGVTdGVwU2l6ZTogbnVtYmVyXHJcblxyXG4gIGJldHRlclJlYWRvbmx5RW5hYmxlZDogYm9vbGVhblxyXG4gIGRpc2FibGVOb2RlUG9wdXA6IGJvb2xlYW5cclxuICBkaXNhYmxlWm9vbTogYm9vbGVhblxyXG4gIGRpc2FibGVQYW46IGJvb2xlYW5cclxuXHJcbiAgc3RpY2tlcnNGZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG5cclxuICBwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZDogYm9vbGVhblxyXG4gIGRlZmF1bHRTbGlkZVNpemU6IHN0cmluZ1xyXG4gIHVzZUFycm93S2V5c1RvQ2hhbmdlU2xpZGVzOiBib29sZWFuXHJcbiAgem9vbVRvU2xpZGVXaXRob3V0UGFkZGluZzogYm9vbGVhblxyXG4gIHNsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkR1cmF0aW9uOiBudW1iZXJcclxuICBzbGlkZVRyYW5zaXRpb25BbmltYXRpb25JbnRlbnNpdHk6IG51bWJlclxyXG5cclxuICBjYW52YXNFbmNhcHN1bGF0aW9uRW5hYmxlZDogYm9vbGVhblxyXG5cclxuICBwb3J0YWxzRmVhdHVyZUVuYWJsZWQ6IGJvb2xlYW5cclxuICBtYWludGFpbkNsb3NlZFBvcnRhbFNpemU6IGJvb2xlYW5cclxuICBzaG93RWRnZXNJbnRvRGlzYWJsZWRQb3J0YWxzOiBib29sZWFuXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ3M+ID0ge1xyXG4gIHNoYXBlc0ZlYXR1cmVFbmFibGVkOiB0cnVlLFxyXG5cclxuICBlZGdlc1N0eWxpbmdGZWF0dXJlRW5hYmxlZDogdHJ1ZSxcclxuICBlZGdlU3R5bGVQYXRoZmluZGVyR3JpZFJlc29sdXRpb246IDEwLFxyXG4gIGVkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoTGl2ZVVwZGF0ZTogdHJ1ZSxcclxuICBlZGdlU3R5bGVQYXRoZmluZGVyUGF0aFJvdW5kZWQ6IGZhbHNlLFxyXG5cclxuICBjb21tYW5kc0ZlYXR1cmVFbmFibGVkOiB0cnVlLFxyXG4gIHpvb21Ub0Nsb25lZE5vZGU6IHRydWUsXHJcbiAgY2xvbmVOb2RlTWFyZ2luOiAyNSxcclxuICBleHBhbmROb2RlU3RlcFNpemU6IDI1LFxyXG5cclxuICBiZXR0ZXJSZWFkb25seUVuYWJsZWQ6IHRydWUsXHJcbiAgZGlzYWJsZU5vZGVQb3B1cDogZmFsc2UsXHJcbiAgZGlzYWJsZVpvb206IGZhbHNlLFxyXG4gIGRpc2FibGVQYW46IGZhbHNlLFxyXG5cclxuICBzdGlja2Vyc0ZlYXR1cmVFbmFibGVkOiB0cnVlLFxyXG5cclxuICBwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZDogdHJ1ZSxcclxuICBkZWZhdWx0U2xpZGVTaXplOiBPYmplY3Qua2V5cyhTTElERV9TSVpFX09QVElPTlMpLmZpcnN0KCksXHJcbiAgdXNlQXJyb3dLZXlzVG9DaGFuZ2VTbGlkZXM6IHRydWUsXHJcbiAgem9vbVRvU2xpZGVXaXRob3V0UGFkZGluZzogdHJ1ZSxcclxuICBzbGlkZVRyYW5zaXRpb25BbmltYXRpb25EdXJhdGlvbjogMC41LFxyXG4gIHNsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkludGVuc2l0eTogMS4yNSxcclxuXHJcbiAgY2FudmFzRW5jYXBzdWxhdGlvbkVuYWJsZWQ6IHRydWUsXHJcblxyXG4gIHBvcnRhbHNGZWF0dXJlRW5hYmxlZDogdHJ1ZSxcclxuICBtYWludGFpbkNsb3NlZFBvcnRhbFNpemU6IHRydWUsXHJcbiAgc2hvd0VkZ2VzSW50b0Rpc2FibGVkUG9ydGFsczogdHJ1ZVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZHZhbmNlZENhbnZhc1NldHRpbmdzTWFuYWdlciB7XHJcbiAgcHJpdmF0ZSBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcbiAgcHJpdmF0ZSBzZXR0aW5nczogQWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5nc1xyXG4gIHByaXZhdGUgc2V0dGluZ3NUYWI6IEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ1RhYlxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMucGx1Z2luLmxvYWREYXRhKCkpXHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKVxyXG4gIH1cclxuXHJcbiAgZ2V0U2V0dGluZzxUIGV4dGVuZHMga2V5b2YgQWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5ncz4oa2V5OiBUKTogQWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5nc1tUXSB7XHJcbiAgICByZXR1cm4gdGhpcy5zZXR0aW5nc1trZXldXHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXRTZXR0aW5nKGRhdGE6IFBhcnRpYWw8QWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5ncz4pIHtcclxuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHRoaXMuc2V0dGluZ3MsIGRhdGEpXHJcbiAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpXHJcbiAgfVxyXG5cclxuICBhZGRTZXR0aW5nc1RhYigpIHtcclxuICAgIHRoaXMuc2V0dGluZ3NUYWIgPSBuZXcgQWR2YW5jZWRDYW52YXNQbHVnaW5TZXR0aW5nVGFiKHRoaXMucGx1Z2luLCB0aGlzKVxyXG4gICAgdGhpcy5wbHVnaW4uYWRkU2V0dGluZ1RhYih0aGlzLnNldHRpbmdzVGFiKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFkdmFuY2VkQ2FudmFzUGx1Z2luU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gIHNldHRpbmdzTWFuYWdlcjogQWR2YW5jZWRDYW52YXNTZXR0aW5nc01hbmFnZXJcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbiwgc2V0dGluZ3NNYW5hZ2VyOiBBZHZhbmNlZENhbnZhc1NldHRpbmdzTWFuYWdlcikge1xyXG4gICAgc3VwZXIocGx1Z2luLmFwcCwgcGx1Z2luKVxyXG4gICAgdGhpcy5zZXR0aW5nc01hbmFnZXIgPSBzZXR0aW5nc01hbmFnZXJcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpc1xyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKVxyXG5cclxuICAgIHRoaXMuY3JlYXRlRmVhdHVyZUhlYWRpbmcoXHJcbiAgICAgIGNvbnRhaW5lckVsLFxyXG4gICAgICBcIlNoYXBlc1wiLFxyXG4gICAgICBcIlNoYXBlIHlvdXIgbm9kZXMgZm9yIGNyZWF0aW5nIGUuZy4gbWluZCBtYXBzIG9yIGZsb3cgY2hhcnRzLlwiLFxyXG4gICAgICAnc2hhcGVzRmVhdHVyZUVuYWJsZWQnXHJcbiAgICApXHJcblxyXG4gICAgdGhpcy5jcmVhdGVGZWF0dXJlSGVhZGluZyhcclxuICAgICAgY29udGFpbmVyRWwsXHJcbiAgICAgIFwiRWRnZXMgc3R5bGluZ1wiLFxyXG4gICAgICBcIlN0eWxlIHlvdXIgZWRnZXMgd2l0aCBkaWZmZXJlbnQgcGF0aCBzdHlsZXMuXCIsXHJcbiAgICAgICdlZGdlc1N0eWxpbmdGZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJBKiBncmlkIHJlc29sdXRpb25cIilcclxuICAgICAgLnNldERlc2MoXCJUaGUgcmVzb2x1dGlvbiBvZiB0aGUgZ3JpZCB3aGVuIHVzaW5nIHRoZSBBKiBwYXRoIHN0eWxlLiBUaGUgbG93ZXIgdGhlIHZhbHVlLCB0aGUgbW9yZSBwcmVjaXNlIHRoZSBwYXRoIHdpbGwgYmUuIEJ1dCBpdCB3aWxsIGFsc28gdGFrZSBsb25nZXIgdG8gY2FsY3VsYXRlLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZWRnZVN0eWxlUGF0aGZpbmRlckdyaWRSZXNvbHV0aW9uJykudG9TdHJpbmcoKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBlZGdlU3R5bGVQYXRoZmluZGVyR3JpZFJlc29sdXRpb246IE1hdGgubWF4KDUsIHBhcnNlSW50KHZhbHVlKSkgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJMaXZlIHVwZGF0ZSBBKiBwYXRoXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCB0aGUgQSogcGF0aCBzdHlsZSB3aWxsIGJlIHVwZGF0ZWQgbGl2ZSB3aGlsZSBkcmFnZ2luZyB0aGUgZWRnZS5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2VkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoTGl2ZVVwZGF0ZScpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGVkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoTGl2ZVVwZGF0ZTogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJBKiByb3VuZGVkIHBhdGhcIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHRoZSBBKiBwYXRoIHN0eWxlIHdpbGwgYmUgcm91bmRlZC5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2VkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoUm91bmRlZCcpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGVkZ2VTdHlsZVBhdGhmaW5kZXJQYXRoUm91bmRlZDogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJFeHRlbmRlZCBjb21tYW5kc1wiLFxyXG4gICAgICBcIkFkZCBtb3JlIGNvbW1hbmRzIHRvIHRoZSBjYW52YXMuXCIsXHJcbiAgICAgICdjb21tYW5kc0ZlYXR1cmVFbmFibGVkJ1xyXG4gICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlpvb20gdG8gY2xvbmVkIG5vZGVcIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHRoZSBjYW52YXMgd2lsbCB6b29tIHRvIHRoZSBjbG9uZWQgbm9kZS5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3pvb21Ub0Nsb25lZE5vZGUnKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyB6b29tVG9DbG9uZWROb2RlOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkNsb25lIG5vZGUgbWFyZ2luXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhlIG1hcmdpbiBiZXR3ZWVuIHRoZSBjbG9uZWQgbm9kZSBhbmQgdGhlIHNvdXJjZSBub2RlLlwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnY2xvbmVOb2RlTWFyZ2luJykudG9TdHJpbmcoKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBjbG9uZU5vZGVNYXJnaW46IHBhcnNlSW50KHZhbHVlKSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkV4cGFuZCBub2RlIHN0ZXAgc2l6ZVwiKVxyXG4gICAgICAuc2V0RGVzYyhcIlRoZSBzdGVwIHNpemUgZm9yIGV4cGFuZGluZyB0aGUgbm9kZS5cIilcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2V4cGFuZE5vZGVTdGVwU2l6ZScpLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgZXhwYW5kTm9kZVN0ZXBTaXplOiBwYXJzZUludCh2YWx1ZSkgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJCZXR0ZXIgcmVhZG9ubHlcIixcclxuICAgICAgXCJJbXByb3ZlIHRoZSByZWFkb25seSBtb2RlLlwiLFxyXG4gICAgICAnYmV0dGVyUmVhZG9ubHlFbmFibGVkJ1xyXG4gICAgKVxyXG5cclxuICAgIC8qIFdvdWxkIHJlcXVpcmUgYSBzb2x1dGlvbiB0byBzeW5jIHRoZSBzZXR0aW5ncyB3aXRoIHRoZSBjYW52YXMgKi9cclxuICAgIC8qbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiRGlzYWJsZSBub2RlIGludGVyYWN0aW9uXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCB5b3UgY2FuJ3QgaW50ZXJhY3Qgd2l0aCB0aGUgbm9kZXMgd2hlbiBpbiByZWFkb25seSBtb2RlLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0dGluZ3MuZGlzYWJsZU5vZGVJbnRlcmFjdGlvbilcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBkaXNhYmxlTm9kZUludGVyYWN0aW9uOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkRpc2FibGUgbm9kZSBwb3B1cCBtZW51XCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCB0aGUgbm9kZSBwb3B1cCBtZW51IHdvbid0IHNob3cgd2hlbiBpbiByZWFkb25seSBtb2RlLiAoSWYgbm9kZSBpbnRlcmFjdGlvbiBpcyBkaXNhYmxlZCwgdGhpcyBzZXR0aW5nIGhhcyBubyBlZmZlY3QuKVwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0dGluZ3MuZGlzYWJsZU5vZGVQb3B1cClcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBkaXNhYmxlTm9kZVBvcHVwOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkRpc2FibGUgem9vbVwiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgeW91IGNhbid0IHpvb20gd2hlbiBpbiByZWFkb25seSBtb2RlLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0dGluZ3MuZGlzYWJsZVpvb20pXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgZGlzYWJsZVpvb206IHZhbHVlIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiRGlzYWJsZSBwYW5cIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIHlvdSBjYW4ndCBwYW4gd2hlbiBpbiByZWFkb25seSBtb2RlLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0dGluZ3MuZGlzYWJsZVBhbilcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBkaXNhYmxlUGFuOiB2YWx1ZSB9KSlcclxuICAgICAgKSovXHJcblxyXG4gICAgdGhpcy5jcmVhdGVGZWF0dXJlSGVhZGluZyhcclxuICAgICAgY29udGFpbmVyRWwsXHJcbiAgICAgIFwiU3RpY2tlcnNcIixcclxuICAgICAgXCJDb252ZXJ0IGFuIGltYWdlIG5vZGUgdG8gYSBzdGlja2VyIGJ5IHN1cHBvcnRpbmcgdHJhbnNwYXJlbmN5IGFuZCByZW1vdmluZyB0aGUgYm9yZGVyLlwiLFxyXG4gICAgICAnc3RpY2tlcnNGZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJQcmVzZW50YXRpb25zXCIsXHJcbiAgICAgIFwiQ3JlYXRlIGEgcHJlc2VudGF0aW9uIGZyb20geW91ciBjYW52YXMuXCIsXHJcbiAgICAgICdwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJEZWZhdWx0IHNsaWRlIHJhdGlvXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhlIGRlZmF1bHQgcmF0aW8gb2YgdGhlIHNsaWRlLlwiKVxyXG4gICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxyXG4gICAgICAgIGRyb3Bkb3duXHJcbiAgICAgICAgICAuYWRkT3B0aW9ucyhTTElERV9TSVpFX09QVElPTlMpXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZGVmYXVsdFNsaWRlU2l6ZScpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IGRlZmF1bHRTbGlkZVNpemU6IHZhbHVlIH0pKVxyXG4gICAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJVc2UgYXJyb3cga2V5cyB0byBjaGFuZ2Ugc2xpZGVzXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCB5b3UgY2FuIHVzZSB0aGUgYXJyb3cga2V5cyB0byBjaGFuZ2Ugc2xpZGVzIGluIHByZXNlbnRhdGlvbiBtb2RlLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygndXNlQXJyb3dLZXlzVG9DaGFuZ2VTbGlkZXMnKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyB1c2VBcnJvd0tleXNUb0NoYW5nZVNsaWRlczogdmFsdWUgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJab29tIHRvIHNsaWRlIHdpdGhvdXQgcGFkZGluZ1wiKVxyXG4gICAgICAuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgdGhlIGNhbnZhcyB3aWxsIHpvb20gdG8gdGhlIHNsaWRlIHdpdGhvdXQgcGFkZGluZy5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3pvb21Ub1NsaWRlV2l0aG91dFBhZGRpbmcnKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyB6b29tVG9TbGlkZVdpdGhvdXRQYWRkaW5nOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNsaWRlIHRyYW5zaXRpb24gYW5pbWF0aW9uIGR1cmF0aW9uXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhlIGR1cmF0aW9uIG9mIHRoZSBzbGlkZSB0cmFuc2l0aW9uIGFuaW1hdGlvbiBpbiBzZWNvbmRzLiBTZXQgdG8gMCB0byBkaXNhYmxlIHRoZSBhbmltYXRpb24uXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdzbGlkZVRyYW5zaXRpb25BbmltYXRpb25EdXJhdGlvbicpLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgc2xpZGVUcmFuc2l0aW9uQW5pbWF0aW9uRHVyYXRpb246IHBhcnNlRmxvYXQodmFsdWUpIH0pKVxyXG4gICAgICApXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiU2xpZGUgdHJhbnNpdGlvbiBhbmltYXRpb24gaW50ZW5zaXR5XCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhlIGludGVuc2l0eSBvZiB0aGUgc2xpZGUgdHJhbnNpdGlvbiBhbmltYXRpb24uIFRoZSBoaWdoZXIgdGhlIHZhbHVlLCB0aGUgbW9yZSB0aGUgY2FudmFzIHdpbGwgem9vbSBvdXQgYmVmb3JlIHpvb21pbmcgaW4gb24gdGhlIG5leHQgc2xpZGUuXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdzbGlkZVRyYW5zaXRpb25BbmltYXRpb25JbnRlbnNpdHknKS50b1N0cmluZygpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4gYXdhaXQgdGhpcy5zZXR0aW5nc01hbmFnZXIuc2V0U2V0dGluZyh7IHNsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkludGVuc2l0eTogcGFyc2VGbG9hdCh2YWx1ZSkgfSkpXHJcbiAgICAgIClcclxuXHJcbiAgICB0aGlzLmNyZWF0ZUZlYXR1cmVIZWFkaW5nKFxyXG4gICAgICBjb250YWluZXJFbCxcclxuICAgICAgXCJDYW52YXMgZW5jYXBzdWxhdGlvblwiLFxyXG4gICAgICBcIkVuY2Fwc3VsYXRlIGEgc2VsZWN0aW9uIG9mIG5vZGVzIGFuZCBlZGdlcyBpbnRvIGEgbmV3IGNhbnZhcy5cIixcclxuICAgICAgJ2NhbnZhc0VuY2Fwc3VsYXRpb25FbmFibGVkJ1xyXG4gICAgKVxyXG5cclxuICAgIHRoaXMuY3JlYXRlRmVhdHVyZUhlYWRpbmcoXHJcbiAgICAgIGNvbnRhaW5lckVsLFxyXG4gICAgICBcIlBvcnRhbHNcIixcclxuICAgICAgXCJDcmVhdGUgcG9ydGFscyB0byBvdGhlciBjYW52YXNlcy5cIixcclxuICAgICAgJ3BvcnRhbHNGZWF0dXJlRW5hYmxlZCdcclxuICAgIClcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJNYWludGFpbiBjbG9zZWQgcG9ydGFsIHNpemVcIilcclxuICAgICAgLnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIGNsb3NpbmcgYSBwb3J0YWwgd2lsbCBjaGFuZ2UgdGhlIHNpemUgb2YgdGhlIHBvcnRhbCB0byB0aGUgb3JpZ2luYWwsIGNsb3NlZCBzaXplLlwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnbWFpbnRhaW5DbG9zZWRQb3J0YWxTaXplJykpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiBhd2FpdCB0aGlzLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgbWFpbnRhaW5DbG9zZWRQb3J0YWxTaXplOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNob3cgZWRnZXMgaW50byBkaXNhYmxlZCBwb3J0YWxzXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2hlbiBlbmFibGVkLCBlZGdlcyBpbnRvIGRpc2FibGVkIHBvcnRhbHMgd2lsbCBiZSBzaG93biBieSBhbiBlZGdlIHRvIHRoZSBwb3J0YWwgbm9kZS5cIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3Nob3dFZGdlc0ludG9EaXNhYmxlZFBvcnRhbHMnKSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBzaG93RWRnZXNJbnRvRGlzYWJsZWRQb3J0YWxzOiB2YWx1ZSB9KSlcclxuICAgICAgKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVGZWF0dXJlSGVhZGluZyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIGxhYmVsOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHNldHRpbmdzS2V5OiBrZXlvZiBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzKTogU2V0dGluZyB7XHJcbiAgICByZXR1cm4gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXRIZWFkaW5nKClcclxuICAgICAgLnNldE5hbWUobGFiZWwpXHJcbiAgICAgIC5zZXREZXNjKGRlc2NyaXB0aW9uKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VG9vbHRpcChcIlJlcXVpcmVzIGEgcmVsb2FkIHRvIHRha2UgZWZmZWN0LlwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoc2V0dGluZ3NLZXkpIGFzIGJvb2xlYW4pXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0dGluZ3NNYW5hZ2VyLnNldFNldHRpbmcoeyBbc2V0dGluZ3NLZXldOiB2YWx1ZSB9KVxyXG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiUmVsb2FkIG9ic2lkaWFuIHRvIGFwcGx5IHRoZSBjaGFuZ2VzLlwiKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBzZXRJY29uLCBzZXRUb29sdGlwIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuaW1wb3J0IHsgQkJveCwgQ2FudmFzLCBDYW52YXNOb2RlLCBDYW52YXNOb2RlRGF0YSwgUG9zaXRpb24sIFNpemUgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQkJveEhlbHBlciBmcm9tIFwic3JjL3V0aWxzL2Jib3gtaGVscGVyXCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjYW52YXNDb21tYW5kKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4sIGNoZWNrOiAoY2FudmFzOiBDYW52YXMpID0+IGJvb2xlYW4sIHJ1bjogKGNhbnZhczogQ2FudmFzKSA9PiB2b2lkKTogKGNoZWNraW5nOiBib29sZWFuKSA9PiBib29sZWFuIHtcclxuICByZXR1cm4gKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcbiAgICBjb25zdCBjYW52YXMgPSBwbHVnaW4uZ2V0Q3VycmVudENhbnZhcygpXHJcbiAgICBpZiAoY2hlY2tpbmcpIHJldHVybiBjYW52YXMgIT09IG51bGwgJiYgY2hlY2soY2FudmFzKVxyXG5cclxuICAgIGlmIChjYW52YXMpIHJ1bihjYW52YXMpXHJcblxyXG4gICAgcmV0dXJuIHRydWVcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWVudU9wdGlvbiB7XHJcbiAgaWQ/OiBzdHJpbmdcclxuICBsYWJlbDogc3RyaW5nXHJcbiAgaWNvbjogc3RyaW5nXHJcbiAgY2FsbGJhY2s/OiAoKSA9PiB2b2lkXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVRdWlja1NldHRpbmdzQnV0dG9uKG1lbnVPcHRpb246IE1lbnVPcHRpb24pOiBIVE1MRWxlbWVudCB7XHJcbiAgY29uc3QgcXVpY2tTZXR0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICBpZiAobWVudU9wdGlvbi5pZCkgcXVpY2tTZXR0aW5nLmlkID0gbWVudU9wdGlvbi5pZFxyXG4gIHF1aWNrU2V0dGluZy5jbGFzc0xpc3QuYWRkKCdjYW52YXMtY29udHJvbC1pdGVtJylcclxuICBzZXRJY29uKHF1aWNrU2V0dGluZywgbWVudU9wdGlvbi5pY29uKVxyXG4gIHNldFRvb2x0aXAocXVpY2tTZXR0aW5nLCBtZW51T3B0aW9uLmxhYmVsLCB7IHBsYWNlbWVudDogJ2xlZnQnIH0pXHJcbiAgcXVpY2tTZXR0aW5nLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gbWVudU9wdGlvbi5jYWxsYmFjaz8uKCkpXHJcblxyXG4gIHJldHVybiBxdWlja1NldHRpbmdcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZFF1aWNrU2V0dGluZ3NCdXR0b24oY29udHJvbEdyb3VwOiBIVE1MRWxlbWVudCwgZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcclxuICBpZiAoZWxlbWVudC5pZCkgY29udHJvbEdyb3VwLnF1ZXJ5U2VsZWN0b3IoYCMke2VsZW1lbnQuaWR9YCk/LnJlbW92ZSgpXHJcbiAgY29udHJvbEdyb3VwLmFwcGVuZENoaWxkKGVsZW1lbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDYXJkTWVudU9wdGlvbihjYW52YXM6IENhbnZhcywgbWVudU9wdGlvbjogTWVudU9wdGlvbiwgcHJldmlld05vZGVTaXplOiAoKSA9PiBTaXplLCBvblBsYWNlZDogKGNhbnZhczogQ2FudmFzLCBwb3M6IFBvc2l0aW9uKSA9PiB2b2lkKTogSFRNTEVsZW1lbnQge1xyXG4gIGNvbnN0IG1lbnVPcHRpb25FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICBpZiAobWVudU9wdGlvbi5pZCkgbWVudU9wdGlvbkVsZW1lbnQuaWQgPSBtZW51T3B0aW9uLmlkXHJcbiAgbWVudU9wdGlvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2FudmFzLWNhcmQtbWVudS1idXR0b24nKVxyXG4gIG1lbnVPcHRpb25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21vZC1kcmFnZ2FibGUnKVxyXG4gIHNldEljb24obWVudU9wdGlvbkVsZW1lbnQsIG1lbnVPcHRpb24uaWNvbilcclxuICBzZXRUb29sdGlwKG1lbnVPcHRpb25FbGVtZW50LCBtZW51T3B0aW9uLmxhYmVsLCB7IHBsYWNlbWVudDogJ3RvcCcgfSlcclxuXHJcbiAgbWVudU9wdGlvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoX2UpID0+IHtcclxuICAgIG9uUGxhY2VkKGNhbnZhcywgZ2V0Q2VudGVyQ29vcmRpbmF0ZXMoY2FudmFzLCBwcmV2aWV3Tm9kZVNpemUoKSkpXHJcbiAgfSlcclxuXHJcbiAgbWVudU9wdGlvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCAoZSkgPT4ge1xyXG4gICAgY2FudmFzLmRyYWdUZW1wTm9kZShlLCBwcmV2aWV3Tm9kZVNpemUoKSwgKHBvczogUG9zaXRpb24pID0+IHtcclxuICAgICAgY2FudmFzLmRlc2VsZWN0QWxsKClcclxuICAgICAgb25QbGFjZWQoY2FudmFzLCBwb3MpXHJcbiAgICB9KVxyXG4gIH0pXHJcblxyXG4gIHJldHVybiBtZW51T3B0aW9uRWxlbWVudFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2FyZE1lbnVPcHRpb24oY2FudmFzOiBDYW52YXMsIGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XHJcbiAgaWYgKGVsZW1lbnQuaWQpIGNhbnZhcz8uY2FyZE1lbnVFbC5xdWVyeVNlbGVjdG9yKGAjJHtlbGVtZW50LmlkfWApPy5yZW1vdmUoKVxyXG4gIGNhbnZhcz8uY2FyZE1lbnVFbC5hcHBlbmRDaGlsZChlbGVtZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUG9wdXBNZW51T3B0aW9uKG1lbnVPcHRpb246IE1lbnVPcHRpb24pOiBIVE1MRWxlbWVudCB7XHJcbiAgY29uc3QgbWVudU9wdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG4gIGlmIChtZW51T3B0aW9uLmlkKSBtZW51T3B0aW9uRWxlbWVudC5pZCA9IG1lbnVPcHRpb24uaWRcclxuICBtZW51T3B0aW9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjbGlja2FibGUtaWNvbicpXHJcbiAgc2V0SWNvbihtZW51T3B0aW9uRWxlbWVudCwgbWVudU9wdGlvbi5pY29uKVxyXG4gIHNldFRvb2x0aXAobWVudU9wdGlvbkVsZW1lbnQsIG1lbnVPcHRpb24ubGFiZWwsIHsgcGxhY2VtZW50OiAndG9wJyB9KVxyXG4gIG1lbnVPcHRpb25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gbWVudU9wdGlvbi5jYWxsYmFjaz8uKCkpXHJcblxyXG4gIHJldHVybiBtZW51T3B0aW9uRWxlbWVudFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRXhwYW5kYWJsZVBvcHVwTWVudU9wdGlvbihtZW51T3B0aW9uOiBNZW51T3B0aW9uLCBzdWJNZW51T3B0aW9uczogTWVudU9wdGlvbltdKTogSFRNTEVsZW1lbnQge1xyXG4gIGNvbnN0IG1lbnVPcHRpb25FbGVtZW50ID0gY3JlYXRlUG9wdXBNZW51T3B0aW9uKHtcclxuICAgIC4uLm1lbnVPcHRpb24sXHJcbiAgICBjYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICBjb25zdCBzdWJtZW51SWQgPSBgJHttZW51T3B0aW9uLmlkfS1zdWJtZW51YFxyXG5cclxuICAgICAgaWYgKG1lbnVPcHRpb25FbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnaXMtYWN0aXZlJykpIHtcclxuICAgICAgICBtZW51T3B0aW9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKVxyXG4gICAgICAgIG1lbnVPcHRpb25FbGVtZW50LnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3IoYCMke3N1Ym1lbnVJZH1gKT8ucmVtb3ZlKClcclxuICAgICAgICByZXR1cm5cclxuICAgICAgfVxyXG5cclxuICAgICAgbWVudU9wdGlvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJylcclxuXHJcbiAgICAgIC8vIEFkZCBwb3B1cCBtZW51XHJcbiAgICAgIGNvbnN0IHN1Ym1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG4gICAgICBzdWJtZW51LmlkID0gc3VibWVudUlkXHJcbiAgICAgIHN1Ym1lbnUuY2xhc3NMaXN0LmFkZCgnY2FudmFzLXN1Ym1lbnUnKVxyXG4gICAgXHJcbiAgICAgIC8vIEFkZCBuZXN0ZWQgb3B0aW9uc1xyXG4gICAgICBmb3IgKGNvbnN0IHN1Yk1lbnVPcHRpb24gb2Ygc3ViTWVudU9wdGlvbnMpIHtcclxuICAgICAgICBjb25zdCBzdWJNZW51T3B0aW9uRWxlbWVudCA9IGNyZWF0ZVBvcHVwTWVudU9wdGlvbihzdWJNZW51T3B0aW9uKVxyXG4gICAgICAgIHN1Ym1lbnUuYXBwZW5kQ2hpbGQoc3ViTWVudU9wdGlvbkVsZW1lbnQpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG1lbnVPcHRpb25FbGVtZW50LnBhcmVudEVsZW1lbnQ/LmFwcGVuZENoaWxkKHN1Ym1lbnUpXHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgcmV0dXJuIG1lbnVPcHRpb25FbGVtZW50XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRQb3B1cE1lbnVPcHRpb24oY2FudmFzOiBDYW52YXMsIGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpbmRleDogbnVtYmVyID0gLTEpIHtcclxuICBjb25zdCBwb3B1cE1lbnVFbCA9IGNhbnZhcz8ubWVudT8ubWVudUVsXHJcbiAgaWYgKCFwb3B1cE1lbnVFbCkgcmV0dXJuXHJcblxyXG4gIGlmIChlbGVtZW50LmlkKSBwb3B1cE1lbnVFbC5xdWVyeVNlbGVjdG9yKGAjJHtlbGVtZW50LmlkfWApPy5yZW1vdmUoKVxyXG5cclxuICBjb25zdCBzaXN0ZXJFbGVtZW50ID0gaW5kZXggPj0gMCA/IHBvcHVwTWVudUVsLmNoaWxkcmVuW2luZGV4XSA6IHBvcHVwTWVudUVsLmNoaWxkcmVuW3BvcHVwTWVudUVsLmNoaWxkcmVuLmxlbmd0aCArIGluZGV4XVxyXG4gIHBvcHVwTWVudUVsLmluc2VydEFmdGVyKGVsZW1lbnQsIHNpc3RlckVsZW1lbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDZW50ZXJDb29yZGluYXRlcyhjYW52YXM6IENhbnZhcywgbm9kZVNpemU6IFNpemUpOiBQb3NpdGlvbiB7XHJcbiAgY29uc3Qgdmlld0JvdW5kcyA9IGNhbnZhcy5nZXRWaWV3cG9ydEJCb3goKVxyXG5cclxuICByZXR1cm4geyBcclxuICAgIHg6ICh2aWV3Qm91bmRzLm1pblggKyB2aWV3Qm91bmRzLm1heFgpIC8gMiAtIG5vZGVTaXplLndpZHRoIC8gMixcclxuICAgIHk6ICh2aWV3Qm91bmRzLm1pblkgKyB2aWV3Qm91bmRzLm1heFkpIC8gMiAtIG5vZGVTaXplLmhlaWdodCAvIDIsXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QkJveChjYW52YXNOb2RlczogKENhbnZhc05vZGV8Q2FudmFzTm9kZURhdGEpW10pIHtcclxuICBsZXQgbWluWCA9IEluZmluaXR5XHJcbiAgbGV0IG1pblkgPSBJbmZpbml0eVxyXG4gIGxldCBtYXhYID0gLUluZmluaXR5XHJcbiAgbGV0IG1heFkgPSAtSW5maW5pdHlcclxuXHJcbiAgZm9yIChjb25zdCBub2RlIG9mIGNhbnZhc05vZGVzKSB7XHJcbiAgICBjb25zdCBub2RlRGF0YSA9IG5vZGUuZ2V0RGF0YSA/IG5vZGUuZ2V0RGF0YSgpIDogbm9kZVxyXG5cclxuICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBub2RlRGF0YS54KVxyXG4gICAgbWluWSA9IE1hdGgubWluKG1pblksIG5vZGVEYXRhLnkpXHJcbiAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgbm9kZURhdGEueCArIG5vZGVEYXRhLndpZHRoKVxyXG4gICAgbWF4WSA9IE1hdGgubWF4KG1heFksIG5vZGVEYXRhLnkgKyBub2RlRGF0YS5oZWlnaHQpXHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHpvb21Ub0JCb3goY2FudmFzOiBDYW52YXMsIGJib3g6IEJCb3gpIHtcclxuICBjb25zdCBQQURESU5HX0NPUlJFQ1RJT05fRkFDVE9SID0gMSAvIDEuMVxyXG4gIGNvbnN0IHpvb21lZEJCb3ggPSBCQm94SGVscGVyLnNjYWxlQkJveChiYm94LCBQQURESU5HX0NPUlJFQ1RJT05fRkFDVE9SKVxyXG5cclxuICBjYW52YXMuem9vbVRvQmJveCh6b29tZWRCQm94KVxyXG4gIFxyXG4gIC8vIENhbGN1bGF0ZSB6b29tIGZhY3RvciB3aXRob3V0IGNsYW1wXHJcbiAgY29uc3Qgc2NhbGVGYWN0b3IgPSBNYXRoLm1pbihcclxuICAgIGNhbnZhcy5jYW52YXNSZWN0LndpZHRoIC8gKGJib3gubWF4WCAtIGJib3gubWluWCksXHJcbiAgICBjYW52YXMuY2FudmFzUmVjdC5oZWlnaHQgLyAoYmJveC5tYXhZIC0gYmJveC5taW5ZKVxyXG4gIClcclxuXHJcbiAgY2FudmFzLnRab29tID0gTWF0aC5sb2cyKHNjYWxlRmFjdG9yKVxyXG59IiwgImltcG9ydCB7IEJCb3gsIFBvc2l0aW9uLCBTaWRlIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzY2FsZUJCb3goYmJveDogQkJveCwgc2NhbGU6IG51bWJlcik6IEJCb3gge1xyXG4gIGxldCBkaWZmWCA9IChzY2FsZSAtIDEpICogKGJib3gubWF4WCAtIGJib3gubWluWClcclxuICBsZXQgZGlmZlkgPSAoc2NhbGUgLSAxKSAqIChiYm94Lm1heFkgLSBiYm94Lm1pblkpXHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBtaW5YOiBiYm94Lm1pblggLSBkaWZmWCAvIDIsXHJcbiAgICBtYXhYOiBiYm94Lm1heFggKyBkaWZmWCAvIDIsXHJcbiAgICBtaW5ZOiBiYm94Lm1pblkgLSBkaWZmWSAvIDIsXHJcbiAgICBtYXhZOiBiYm94Lm1heFkgKyBkaWZmWSAvIDJcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnNpZGVCQm94KHBvc2l0aW9uOiBQb3NpdGlvbnxCQm94LCBiYm94OiBCQm94LCBjYW5Ub3VjaEVkZ2U6IEJvb2xlYW4pOiBib29sZWFuIHtcclxuICBjb25zdCBwcm92aWRlZEJCb3ggPSB7XHJcbiAgICBtaW5YOiAocG9zaXRpb24gYXMgQkJveCkubWluWCB8fCAocG9zaXRpb24gYXMgUG9zaXRpb24pLngsXHJcbiAgICBtaW5ZOiAocG9zaXRpb24gYXMgQkJveCkubWluWSB8fCAocG9zaXRpb24gYXMgUG9zaXRpb24pLnksXHJcbiAgICBtYXhYOiAocG9zaXRpb24gYXMgQkJveCkubWF4WCB8fCAocG9zaXRpb24gYXMgUG9zaXRpb24pLngsXHJcbiAgICBtYXhZOiAocG9zaXRpb24gYXMgQkJveCkubWF4WSB8fCAocG9zaXRpb24gYXMgUG9zaXRpb24pLnlcclxuICB9XHJcblxyXG4gIHJldHVybiBjYW5Ub3VjaEVkZ2UgPyBwcm92aWRlZEJCb3gubWluWCA+PSBiYm94Lm1pblggJiYgcHJvdmlkZWRCQm94Lm1heFggPD0gYmJveC5tYXhYICYmIHByb3ZpZGVkQkJveC5taW5ZID49IGJib3gubWluWSAmJiBwcm92aWRlZEJCb3gubWF4WSA8PSBiYm94Lm1heFkgOlxyXG4gICAgcHJvdmlkZWRCQm94Lm1pblggPiBiYm94Lm1pblggJiYgcHJvdmlkZWRCQm94Lm1heFggPCBiYm94Lm1heFggJiYgcHJvdmlkZWRCQm94Lm1pblkgPiBiYm94Lm1pblkgJiYgcHJvdmlkZWRCQm94Lm1heFkgPCBiYm94Lm1heFlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVubGFyZ2VCQm94KGJib3g6IEJCb3gsIHBhZGRpbmc6IG51bWJlcik6IEJCb3gge1xyXG4gIHJldHVybiB7XHJcbiAgICBtaW5YOiBiYm94Lm1pblggLSBwYWRkaW5nLFxyXG4gICAgbWluWTogYmJveC5taW5ZIC0gcGFkZGluZyxcclxuICAgIG1heFg6IGJib3gubWF4WCArIHBhZGRpbmcsXHJcbiAgICBtYXhZOiBiYm94Lm1heFkgKyBwYWRkaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2VudGVyT2ZCQm94U2lkZShiYm94OiBCQm94LCBzaWRlOiBTaWRlKTogUG9zaXRpb24ge1xyXG4gIHN3aXRjaCAoc2lkZSkge1xyXG4gICAgY2FzZSAndG9wJzpcclxuICAgICAgcmV0dXJuIHsgeDogKGJib3gubWluWCArIGJib3gubWF4WCkgLyAyLCB5OiBiYm94Lm1pblkgfVxyXG4gICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICByZXR1cm4geyB4OiBiYm94Lm1heFgsIHk6IChiYm94Lm1pblkgKyBiYm94Lm1heFkpIC8gMiB9XHJcbiAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICByZXR1cm4geyB4OiAoYmJveC5taW5YICsgYmJveC5tYXhYKSAvIDIsIHk6IGJib3gubWF4WSB9XHJcbiAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgcmV0dXJuIHsgeDogYmJveC5taW5YLCB5OiAoYmJveC5taW5ZICsgYmJveC5tYXhZKSAvIDIgfVxyXG4gIH1cclxufSIsICJjb25zdCBQTFVHSU5fRVZFTlRfUFJFRklYID0gJ2FkdmFuY2VkLWNhbnZhcydcclxuXHJcbmV4cG9ydCBjb25zdCBDYW52YXNFdmVudCA9IHtcclxuICBDYW52YXNDaGFuZ2VkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpjYW52YXMtY2hhbmdlZGAsXHJcbiAgVmlld3BvcnRDaGFuZ2VkOiB7XHJcbiAgICBCZWZvcmU6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OnZpZXdwb3J0LWNoYW5nZWQ6YmVmb3JlYCxcclxuICAgIEFmdGVyOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTp2aWV3cG9ydC1jaGFuZ2VkOmFmdGVyYFxyXG4gIH0sXHJcbiAgTm9kZU1vdmVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpub2RlLW1vdmVkYCxcclxuICBEcmFnZ2luZ1N0YXRlQ2hhbmdlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06ZHJhZ2dpbmctc3RhdGUtY2hhbmdlZGAsXHJcbiAgTm9kZUFkZGVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpub2RlLWFkZGVkYCxcclxuICBFZGdlQWRkZWQ6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmVkZ2UtYWRkZWRgLFxyXG4gIE5vZGVSZW1vdmVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpub2RlLXJlbW92ZWRgLFxyXG4gIEVkZ2VSZW1vdmVkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTplZGdlLXJlbW92ZWRgLFxyXG4gIE5vZGVDaGFuZ2VkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpub2RlLWNoYW5nZWRgLFxyXG4gIEVkZ2VDaGFuZ2VkOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTplZGdlLWNoYW5nZWRgLFxyXG4gIEVkZ2VDZW50ZXJSZXF1ZXN0ZWQ6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmVkZ2UtY2VudGVyLXJlcXVlc3RlZGAsXHJcbiAgU2VsZWN0aW9uQ2hhbmdlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06c2VsZWN0aW9uLWNoYW5nZWRgLFxyXG4gIFpvb21Ub0Jib3g6IHtcclxuICAgIEJlZm9yZTogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06em9vbS10by1iYm94OmJlZm9yZWAsXHJcbiAgICBBZnRlcjogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06em9vbS10by1iYm94OmFmdGVyYFxyXG4gIH0sXHJcbiAgUG9wdXBNZW51Q3JlYXRlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06cG9wdXAtbWVudS1jcmVhdGVkYCxcclxuICBOb2RlSW50ZXJhY3Rpb246IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9Om5vZGUtaW50ZXJhY3Rpb25gLFxyXG4gIFVuZG86IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OnVuZG9gLFxyXG4gIFJlZG86IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OnJlZG9gLFxyXG4gIFJlYWRvbmx5Q2hhbmdlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06cmVhZG9ubHktY2hhbmdlZGAsXHJcbiAgRGF0YVJlcXVlc3RlZDogYCR7UExVR0lOX0VWRU5UX1BSRUZJWH06ZGF0YS1yZXF1ZXN0ZWRgLFxyXG4gIExvYWREYXRhOiBgJHtQTFVHSU5fRVZFTlRfUFJFRklYfTpsb2FkLWRhdGFgLFxyXG4gIENhbnZhc1NhdmVkOiB7XHJcbiAgICBCZWZvcmU6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmNhbnZhcy1zYXZlZDpiZWZvcmVgLFxyXG4gICAgQWZ0ZXI6IGAke1BMVUdJTl9FVkVOVF9QUkVGSVh9OmNhbnZhcy1zYXZlZDphZnRlcmBcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNOb2RlLCBDYW52YXNOb2RlRGF0YSB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgKiBhcyBDYW52YXNIZWxwZXIgZnJvbSBcInNyYy91dGlscy9jYW52YXMtaGVscGVyXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2V2ZW50cy9ldmVudHNcIlxyXG5cclxuaW50ZXJmYWNlIFNoYXBlIHtcclxuICBpZDogc3RyaW5nfG51bGxcclxuICBtZW51TmFtZTogc3RyaW5nXHJcbiAgaWNvbjogc3RyaW5nXHJcbn1cclxuXHJcbmNvbnN0IFNIQVBFUzogU2hhcGVbXSA9IFtcclxuICB7XHJcbiAgICBpZDogbnVsbCxcclxuICAgIG1lbnVOYW1lOiAnRGVmYXVsdCcsXHJcbiAgICBpY29uOiAnY2lyY2xlLW9mZidcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnb3ZhbCcsXHJcbiAgICBtZW51TmFtZTogJ092YWwnLFxyXG4gICAgaWNvbjogJ292YWwnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2NlbnRlcmVkLXJlY3RhbmdsZScsXHJcbiAgICBtZW51TmFtZTogJ1JlY3RhbmdsZScsXHJcbiAgICBpY29uOiAncmVjdGFuZ2xlLWhvcml6b250YWwnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2RpYW1vbmQnLFxyXG4gICAgbWVudU5hbWU6ICdEaWFtb25kJyxcclxuICAgIGljb246ICdkaWFtb25kJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdwYXJhbGxlbG9ncmFtJyxcclxuICAgIG1lbnVOYW1lOiAnUGFyYWxsZWxvZ3JhbScsXHJcbiAgICBpY29uOiAncGFyYWxsZWxvZ3JhbSdcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnY2lyY2xlJyxcclxuICAgIG1lbnVOYW1lOiAnQ2lyY2xlJyxcclxuICAgIGljb246ICdjaXJjbGUnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ3ByZWRlZmluZWQtcHJvY2VzcycsXHJcbiAgICBtZW51TmFtZTogJ1ByZWRlZmluZWQgcHJvY2VzcycsXHJcbiAgICBpY29uOiAncHJlZGVmaW5lZC1wcm9jZXNzJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdkb2N1bWVudCcsXHJcbiAgICBtZW51TmFtZTogJ0RvY3VtZW50JyxcclxuICAgIGljb246ICdkb2N1bWVudCdcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnZGF0YWJhc2UnLFxyXG4gICAgbWVudU5hbWU6ICdEYXRhYmFzZScsXHJcbiAgICBpY29uOiAnZGF0YWJhc2Utc2hhcGUnXHJcbiAgfVxyXG5dXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTaGFwZXNDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdzaGFwZXNGZWF0dXJlRW5hYmxlZCcpKSByZXR1cm5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LlBvcHVwTWVudUNyZWF0ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5vblBvcHVwTWVudUNyZWF0ZWQoY2FudmFzKVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIG9uUG9wdXBNZW51Q3JlYXRlZChjYW52YXM6IENhbnZhcyk6IHZvaWQge1xyXG4gICAgLy8gSWYgdGhlIGNhbnZhcyBpcyByZWFkb25seSBvciB0aGVyZSBpcyBubyB2YWxpZCBzaGFwZSBpbiB0aGUgc2VsZWN0aW9uLCByZXR1cm5cclxuICAgIGlmIChjYW52YXMucmVhZG9ubHkgfHwgIXRoaXMuaGFzVmFsaWROb2RlSW5TZWxlY3Rpb24oY2FudmFzKSlcclxuICAgICAgcmV0dXJuXHJcblxyXG4gICAgY29uc3QgbmVzdGVkTWVudU9wdGlvbnMgPSBTSEFQRVMubWFwKChzaGFwZSkgPT4gKHtcclxuICAgICAgbGFiZWw6IHNoYXBlLm1lbnVOYW1lLFxyXG4gICAgICBpY29uOiBzaGFwZS5pY29uLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zZXRTaGFwZUZvclNlbGVjdGlvbihjYW52YXMsIHNoYXBlKVxyXG4gICAgfSkpXHJcblxyXG4gICAgY29uc3QgbWVudU9wdGlvbiA9IENhbnZhc0hlbHBlci5jcmVhdGVFeHBhbmRhYmxlUG9wdXBNZW51T3B0aW9uKHtcclxuICAgICAgaWQ6ICdub2RlLXNoYXBlLW9wdGlvbicsXHJcbiAgICAgIGxhYmVsOiAnTm9kZSBzaGFwZScsXHJcbiAgICAgIGljb246ICdzaGFwZXMnXHJcbiAgICB9LCBuZXN0ZWRNZW51T3B0aW9ucylcclxuXHJcbiAgICAvLyBBZGQgbWVudSBvcHRpb24gdG8gbWVudSBiYXJcclxuICAgIENhbnZhc0hlbHBlci5hZGRQb3B1cE1lbnVPcHRpb24oY2FudmFzLCBtZW51T3B0aW9uKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBoYXNWYWxpZE5vZGVJblNlbGVjdGlvbihjYW52YXM6IENhbnZhcyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3Qgc2VsZWN0ZWROb2Rlc0RhdGEgPSBjYW52YXMuZ2V0U2VsZWN0aW9uRGF0YSgpLm5vZGVzXHJcblxyXG4gICAgZm9yIChjb25zdCBub2RlRGF0YSBvZiBzZWxlY3RlZE5vZGVzRGF0YSkge1xyXG4gICAgICBpZiAobm9kZURhdGEudHlwZSA9PT0gJ3RleHQnKSByZXR1cm4gdHJ1ZVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2VcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0U2hhcGVGb3JTZWxlY3Rpb24oY2FudmFzOiBDYW52YXMsIHNoYXBlOiBTaGFwZSkgeyAgXHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGVzRGF0YSA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXNcclxuXHJcbiAgICBmb3IgKGNvbnN0IG5vZGVEYXRhIG9mIHNlbGVjdGVkTm9kZXNEYXRhKSB7XHJcbiAgICAgIGlmIChub2RlRGF0YS50eXBlICE9PSAndGV4dCcpIGNvbnRpbnVlXHJcblxyXG4gICAgICBjb25zdCBub2RlID0gY2FudmFzLm5vZGVzLmdldChub2RlRGF0YS5pZClcclxuICAgICAgaWYgKCFub2RlKSBjb250aW51ZVxyXG4gICAgICBcclxuICAgICAgY2FudmFzLnNldE5vZGVEYXRhKG5vZGUsICdzaGFwZScsIHNoYXBlLmlkKVxyXG4gICAgfVxyXG4gIH1cclxufSIsICJleHBvcnQgZnVuY3Rpb24gYXJvdW5kKG9iaiwgZmFjdG9yaWVzKSB7XG4gICAgY29uc3QgcmVtb3ZlcnMgPSBPYmplY3Qua2V5cyhmYWN0b3JpZXMpLm1hcChrZXkgPT4gYXJvdW5kMShvYmosIGtleSwgZmFjdG9yaWVzW2tleV0pKTtcbiAgICByZXR1cm4gcmVtb3ZlcnMubGVuZ3RoID09PSAxID8gcmVtb3ZlcnNbMF0gOiBmdW5jdGlvbiAoKSB7IHJlbW92ZXJzLmZvckVhY2gociA9PiByKCkpOyB9O1xufVxuZnVuY3Rpb24gYXJvdW5kMShvYmosIG1ldGhvZCwgY3JlYXRlV3JhcHBlcikge1xuICAgIGNvbnN0IG9yaWdpbmFsID0gb2JqW21ldGhvZF0sIGhhZE93biA9IG9iai5oYXNPd25Qcm9wZXJ0eShtZXRob2QpO1xuICAgIGxldCBjdXJyZW50ID0gY3JlYXRlV3JhcHBlcihvcmlnaW5hbCk7XG4gICAgLy8gTGV0IG91ciB3cmFwcGVyIGluaGVyaXQgc3RhdGljIHByb3BzIGZyb20gdGhlIHdyYXBwaW5nIG1ldGhvZCxcbiAgICAvLyBhbmQgdGhlIHdyYXBwaW5nIG1ldGhvZCwgcHJvcHMgZnJvbSB0aGUgb3JpZ2luYWwgbWV0aG9kXG4gICAgaWYgKG9yaWdpbmFsKVxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoY3VycmVudCwgb3JpZ2luYWwpO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih3cmFwcGVyLCBjdXJyZW50KTtcbiAgICBvYmpbbWV0aG9kXSA9IHdyYXBwZXI7XG4gICAgLy8gUmV0dXJuIGEgY2FsbGJhY2sgdG8gYWxsb3cgc2FmZSByZW1vdmFsXG4gICAgcmV0dXJuIHJlbW92ZTtcbiAgICBmdW5jdGlvbiB3cmFwcGVyKC4uLmFyZ3MpIHtcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBiZWVuIGRlYWN0aXZhdGVkIGFuZCBhcmUgbm8gbG9uZ2VyIHdyYXBwZWQsIHJlbW92ZSBvdXJzZWx2ZXNcbiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG9yaWdpbmFsICYmIG9ialttZXRob2RdID09PSB3cmFwcGVyKVxuICAgICAgICAgICAgcmVtb3ZlKCk7XG4gICAgICAgIHJldHVybiBjdXJyZW50LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgICBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICAgIC8vIElmIG5vIG90aGVyIHBhdGNoZXMsIGp1c3QgZG8gYSBkaXJlY3QgcmVtb3ZhbFxuICAgICAgICBpZiAob2JqW21ldGhvZF0gPT09IHdyYXBwZXIpIHtcbiAgICAgICAgICAgIGlmIChoYWRPd24pXG4gICAgICAgICAgICAgICAgb2JqW21ldGhvZF0gPSBvcmlnaW5hbDtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBkZWxldGUgb2JqW21ldGhvZF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG9yaWdpbmFsKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAvLyBFbHNlIHBhc3MgZnV0dXJlIGNhbGxzIHRocm91Z2gsIGFuZCByZW1vdmUgd3JhcHBlciBmcm9tIHRoZSBwcm90b3R5cGUgY2hhaW5cbiAgICAgICAgY3VycmVudCA9IG9yaWdpbmFsO1xuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yod3JhcHBlciwgb3JpZ2luYWwgfHwgRnVuY3Rpb24pO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBkZWR1cGUoa2V5LCBvbGRGbiwgbmV3Rm4pIHtcbiAgICBjaGVja1trZXldID0ga2V5O1xuICAgIHJldHVybiBjaGVjaztcbiAgICBmdW5jdGlvbiBjaGVjayguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiAob2xkRm5ba2V5XSA9PT0ga2V5ID8gb2xkRm4gOiBuZXdGbikuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGFmdGVyKHByb21pc2UsIGNiKSB7XG4gICAgcmV0dXJuIHByb21pc2UudGhlbihjYiwgY2IpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZShhc3luY0Z1bmN0aW9uKSB7XG4gICAgbGV0IGxhc3RSdW4gPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICBmdW5jdGlvbiB3cmFwcGVyKC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIGxhc3RSdW4gPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHtcbiAgICAgICAgICAgIGFmdGVyKGxhc3RSdW4sICgpID0+IHtcbiAgICAgICAgICAgICAgICBhc3luY0Z1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3MpLnRoZW4ocmVzLCByZWopO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3cmFwcGVyLmFmdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbGFzdFJ1biA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4geyBhZnRlcihsYXN0UnVuLCByZXMpOyB9KTtcbiAgICB9O1xuICAgIHJldHVybiB3cmFwcGVyO1xufVxuIiwgImltcG9ydCB7IGFyb3VuZCB9IGZyb20gXCJtb25rZXktYXJvdW5kXCJcclxuaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSBcIm9ic2lkaWFuXCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXRjaFdvcmtzcGFjZUZ1bmN0aW9uPFQ+KHBsdWdpbjogUGx1Z2luLCBnZXRUYXJnZXQ6ICgpID0+IFR8dW5kZWZpbmVkLCBmdW5jdGlvbnM6IHsgW2tleTogc3RyaW5nXTogKG5leHQ6IGFueSkgPT4gKC4uLmFyZ3M6IGFueSkgPT4gYW55IH0pOiBQcm9taXNlPFQ+IHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgIGNvbnN0IHRyeVBhdGNoID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSBnZXRUYXJnZXQoKVxyXG4gICAgICBpZiAoIXRhcmdldCkgcmV0dXJuIG51bGxcclxuXHJcbiAgICAgIGNvbnN0IHVuaW5zdGFsbGVyID0gYXJvdW5kKHRhcmdldC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsIGZ1bmN0aW9ucylcclxuICAgICAgcGx1Z2luLnJlZ2lzdGVyKHVuaW5zdGFsbGVyKVxyXG5cclxuICAgICAgcmV0dXJuIHRhcmdldFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IHRyeVBhdGNoKClcclxuICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgcmVzb2x2ZShyZXN1bHQpXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGxpc3RlbmVyID0gcGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2xheW91dC1jaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHRyeVBhdGNoKClcclxuXHJcbiAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICBwbHVnaW4uYXBwLndvcmtzcGFjZS5vZmZyZWYobGlzdGVuZXIpXHJcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgcGx1Z2luLnJlZ2lzdGVyRXZlbnQobGlzdGVuZXIpXHJcbiAgfSlcclxufSIsICJpbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgQkJveCwgQ2FudmFzLCBDYW52YXNEYXRhLCBDYW52YXNFZGdlLCBDYW52YXNFZGdlRGF0YSwgQ2FudmFzRWxlbWVudCwgQ2FudmFzTm9kZSwgQ2FudmFzTm9kZURhdGEsIENhbnZhc1ZpZXcgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgeyBwYXRjaFdvcmtzcGFjZUZ1bmN0aW9uIGFzIHBhdGNoV29ya3NwYWNlT2JqZWN0IH0gZnJvbSBcInNyYy91dGlscy9wYXRjaC1oZWxwZXJcIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCIuL2V2ZW50c1wiXHJcbmltcG9ydCB7IFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIlxyXG5pbXBvcnQgeyBhcm91bmQgfSBmcm9tIFwibW9ua2V5LWFyb3VuZFwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYW52YXNFdmVudEVtaXR0ZXIge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICAgIHRoaXMuYXBwbHlQYXRjaGVzKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgYXBwbHlQYXRjaGVzKCkge1xyXG4gICAgY29uc3QgdGhhdCA9IHRoaXNcclxuICAgIFxyXG4gICAgLy8gUGF0Y2ggY2FudmFzIHBvcHVwIG1lbnVcclxuICAgIHBhdGNoV29ya3NwYWNlT2JqZWN0KHRoaXMucGx1Z2luLCAoKSA9PiB0aGlzLnBsdWdpbi5nZXRDdXJyZW50Q2FudmFzKCk/Lm1lbnUsIHtcclxuICAgICAgcmVuZGVyOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoLi4uYXJnczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCwgdGhpcy5jYW52YXMpXHJcbiAgICAgICAgbmV4dC5jYWxsKHRoaXMpIC8vIFJlLUNlbnRlciB0aGUgcG9wdXAgbWVudVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBQYXRjaCBpbnRlcmFjdGlvbiBsYXllclxyXG4gICAgcGF0Y2hXb3Jrc3BhY2VPYmplY3QodGhpcy5wbHVnaW4sICgpID0+IHRoaXMucGx1Z2luLmdldEN1cnJlbnRDYW52YXMoKT8ubm9kZUludGVyYWN0aW9uTGF5ZXIsIHtcclxuICAgICAgc2V0VGFyZ2V0OiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAobm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCBub2RlKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVJbnRlcmFjdGlvbiwgdGhpcy5jYW52YXMsIG5vZGUpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFBhdGNoIGNhbnZhcyB2aWV3XHJcbiAgICBjb25zdCBjYW52YXNWaWV3ID0gYXdhaXQgcGF0Y2hXb3Jrc3BhY2VPYmplY3QodGhpcy5wbHVnaW4sICgpID0+IHRoaXMucGx1Z2luLmdldEN1cnJlbnRDYW52YXNWaWV3KCksIHtcclxuICAgICAgZ2V0Vmlld0RhdGE6IChfbmV4dDogYW55KSA9PiBmdW5jdGlvbiAoLi4uX2FyZ3M6IGFueSkge1xyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLmNhbnZhcy5nZXREYXRhKCksIG51bGwsIDIpXHJcbiAgICAgIH0sXHJcbiAgICAgIHNldFZpZXdEYXRhOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoLi4uYXJnczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCwgdGhpcy5jYW52YXMpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFBhdGNoIGNhbnZhcyBhZnRlciBwYXRjaGluZyB0aGUgY2FudmFzIHZpZXcgdXNpbmcgdGhlIG5vbi1udWxsIGNhbnZhcyB2aWV3XHJcbiAgICBhd2FpdCBwYXRjaFdvcmtzcGFjZU9iamVjdCh0aGlzLnBsdWdpbiwgKCkgPT4gY2FudmFzVmlldz8uY2FudmFzLCB7XHJcbiAgICAgIC8vIEFkZCBjdXN0b20gZnVuY3Rpb25cclxuICAgICAgc2V0Tm9kZURhdGE6IChfbmV4dDogYW55KSA9PiBmdW5jdGlvbiAobm9kZTogQ2FudmFzTm9kZSwga2V5OiBrZXlvZiBDYW52YXNOb2RlRGF0YSwgdmFsdWU6IGFueSkge1xyXG4gICAgICAgIG5vZGUuc2V0RGF0YSh7IFxyXG4gICAgICAgICAgLi4ubm9kZS5nZXREYXRhKCksXHJcbiAgICAgICAgICBba2V5XTogdmFsdWVcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMucmVxdWVzdFNhdmUoKVxyXG5cclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Ob2RlQ2hhbmdlZCwgdGhpcywgbm9kZSlcclxuICAgICAgfSxcclxuICAgICAgc2V0RWRnZURhdGE6IChfbmV4dDogYW55KSA9PiBmdW5jdGlvbiAoZWRnZTogQ2FudmFzRWRnZSwga2V5OiBrZXlvZiBDYW52YXNFZGdlRGF0YSwgdmFsdWU6IGFueSkge1xyXG4gICAgICAgIGVkZ2Uuc2V0RGF0YSh7IFxyXG4gICAgICAgICAgLi4uZWRnZS5nZXREYXRhKCksXHJcbiAgICAgICAgICBba2V5XTogdmFsdWVcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMucmVxdWVzdFNhdmUoKVxyXG5cclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5FZGdlQ2hhbmdlZCwgdGhpcywgZWRnZSlcclxuICAgICAgfSxcclxuICAgICAgbWFya1ZpZXdwb3J0Q2hhbmdlZDogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LlZpZXdwb3J0Q2hhbmdlZC5CZWZvcmUsIHRoaXMpXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuVmlld3BvcnRDaGFuZ2VkLkFmdGVyLCB0aGlzKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfSxcclxuICAgICAgbWFya01vdmVkOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAobm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCBub2RlKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVNb3ZlZCwgdGhpcywgbm9kZSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldERyYWdnaW5nOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoZHJhZ2dpbmc6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgZHJhZ2dpbmcpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuRHJhZ2dpbmdTdGF0ZUNoYW5nZWQsIHRoaXMsIGRyYWdnaW5nKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfSxcclxuICAgICAgdXBkYXRlU2VsZWN0aW9uOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAodXBkYXRlOiAoKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgY29uc3Qgb2xkU2VsZWN0aW9uID0gbmV3IFNldCh0aGlzLnNlbGVjdGlvbilcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgdXBkYXRlKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LlNlbGVjdGlvbkNoYW5nZWQsIHRoaXMsIG9sZFNlbGVjdGlvbiwgKCh1cGRhdGU6ICgpID0+IHZvaWQpID0+IG5leHQuY2FsbCh0aGlzLCB1cGRhdGUpKSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIGFkZE5vZGU6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChub2RlOiBDYW52YXNOb2RlKSB7XHJcbiAgICAgICAgdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKG5vZGUsICgpID0+IHtcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVBZGRlZCwgdGhpcywgbm9kZSlcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVDaGFuZ2VkLCB0aGlzLCBub2RlKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgbm9kZSlcclxuICAgICAgfSxcclxuICAgICAgYWRkRWRnZTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKGVkZ2U6IENhbnZhc0VkZ2UpIHtcclxuICAgICAgICB0aGF0LnBhdGNoRWRnZShlZGdlKVxyXG5cclxuICAgICAgICB0aGF0LnJ1bkFmdGVySW5pdGlhbGl6ZWQoZWRnZSwgKCkgPT4ge1xyXG4gICAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuRWRnZUFkZGVkLCB0aGlzLCBlZGdlKVxyXG4gICAgICAgICAgLy8gQ2hhbmdlZCBldmVudCB3aWxsIGJlIHRyaWdnZXJlZCB3aGVuIHVwZGF0ZVBhdGggaXMgY2FsbGVkXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIG5leHQuY2FsbCh0aGlzLCBlZGdlKVxyXG4gICAgICB9LFxyXG4gICAgICByZW1vdmVOb2RlOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAobm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCBub2RlKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVSZW1vdmVkLCB0aGlzLCBub2RlKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfSxcclxuICAgICAgcmVtb3ZlRWRnZTogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKGVkZ2U6IENhbnZhc0VkZ2UpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgZWRnZSlcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5FZGdlUmVtb3ZlZCwgdGhpcywgZWRnZSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHpvb21Ub0Jib3g6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uIChiYm94OiBCQm94KSB7XHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuWm9vbVRvQmJveC5CZWZvcmUsIHRoaXMsIGJib3gpXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIGJib3gpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuWm9vbVRvQmJveC5BZnRlciwgdGhpcywgYmJveClcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldFJlYWRvbmx5OiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAocmVhZG9ubHk6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgcmVhZG9ubHkpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuUmVhZG9ubHlDaGFuZ2VkLCB0aGlzLCByZWFkb25seSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHVuZG86IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgLi4uYXJncylcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5VbmRvLCB0aGlzKVxyXG5cclxuICAgICAgICAvLyBJZiBub2RlIGRhdGEgY2hhbmdlZFxyXG4gICAgICAgIHRoaXMubm9kZXMuZm9yRWFjaCgobm9kZTogQ2FudmFzTm9kZSkgPT4gdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKG5vZGUsICgpID0+IHtcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVBZGRlZCwgdGhpcywgbm9kZSlcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVDaGFuZ2VkLCB0aGlzLCBub2RlKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICAvLyBJZiBlZGdlIGRhdGEgY2hhbmdlZFxyXG4gICAgICAgIHRoaXMuZWRnZXMuZm9yRWFjaCgoZWRnZTogQ2FudmFzRWRnZSkgPT4gdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKGVkZ2UsICgpID0+IHtcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VBZGRlZCwgdGhpcywgZWRnZSlcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDaGFuZ2VkLCB0aGlzLCBlZGdlKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlZG86IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgLi4uYXJncylcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5SZWRvLCB0aGlzKVxyXG5cclxuICAgICAgICAvLyBJZiBub2RlIGRhdGEgY2hhbmdlZFxyXG4gICAgICAgIHRoaXMubm9kZXMuZm9yRWFjaCgobm9kZTogQ2FudmFzTm9kZSkgPT4gdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKG5vZGUsICgpID0+IHtcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVBZGRlZCwgdGhpcywgbm9kZSlcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVDaGFuZ2VkLCB0aGlzLCBub2RlKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICAvLyBJZiBlZGdlIGRhdGEgY2hhbmdlZFxyXG4gICAgICAgIHRoaXMuZWRnZXMuZm9yRWFjaCgoZWRnZTogQ2FudmFzRWRnZSkgPT4gdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKGVkZ2UsICgpID0+IHtcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VBZGRlZCwgdGhpcywgZWRnZSlcclxuICAgICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDaGFuZ2VkLCB0aGlzLCBlZGdlKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldERhdGE6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgLi4uYXJncylcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5EYXRhUmVxdWVzdGVkLCB0aGlzLCByZXN1bHQpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9LFxyXG4gICAgICBzZXREYXRhOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoZGF0YTogQ2FudmFzRGF0YSkge1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEZpbGVQYXRoID0gdGhpcy52aWV3LmZpbGUucGF0aFxyXG4gICAgICAgIGNvbnN0IHNldERhdGEgPSAoZGF0YTogQ2FudmFzRGF0YSkgPT4ge1xyXG4gICAgICAgICAgLy8gU2tpcCBpZiB0aGUgY2FudmFzIGdvdCB1bmxvYWRlZCBvciB0aGUgZmlsZSBjaGFuZ2VkXHJcbiAgICAgICAgICBpZiAoIXRoaXMudmlldy5maWxlIHx8IHRoaXMudmlldy5maWxlLnBhdGggIT09IHRhcmdldEZpbGVQYXRoKSByZXR1cm5cclxuXHJcbiAgICAgICAgICB0aGlzLmltcG9ydERhdGEoZGF0YSlcclxuICAgICAgICAgIHRoaXMubm9kZXMuZm9yRWFjaCgobm9kZTogQ2FudmFzTm9kZSkgPT4gdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKG5vZGUsICgpID0+IHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50Lk5vZGVDaGFuZ2VkLCB0aGlzLCBub2RlKSkpIC8vIElmIG5vZGUgZGF0YSBjaGFuZ2VkXHJcbiAgICAgICAgICAvLyBFZGdlIGRhdGEgY2hhbmdlZCBldmVudCB3aWxsIGJlIHRyaWdnZXJlZCB3aGVuIHVwZGF0ZVBhdGggaXMgY2FsbGVkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Mb2FkRGF0YSwgdGhpcywgZGF0YSwgc2V0RGF0YSlcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXh0LmNhbGwodGhpcywgZGF0YSlcclxuXHJcbiAgICAgICAgdGhpcy5ub2Rlcy5mb3JFYWNoKChub2RlOiBDYW52YXNOb2RlKSA9PiB0aGF0LnJ1bkFmdGVySW5pdGlhbGl6ZWQobm9kZSwgKCkgPT4gdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuTm9kZUNoYW5nZWQsIHRoaXMsIG5vZGUpKSkgLy8gSWYgbm9kZSBkYXRhIGNoYW5nZWRcclxuICAgICAgICAvLyBFZGdlIGRhdGEgY2hhbmdlZCBldmVudCB3aWxsIGJlIHRyaWdnZXJlZCB3aGVuIHVwZGF0ZVBhdGggaXMgY2FsbGVkXHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgfSxcclxuICAgICAgcmVxdWVzdFNhdmU6IChuZXh0OiBhbnkpID0+IGZ1bmN0aW9uICguLi5hcmdzOiBhbnkpIHtcclxuICAgICAgICB0aGF0LnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5DYW52YXNTYXZlZC5CZWZvcmUsIHRoaXMpXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcbiAgICAgICAgdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuQ2FudmFzU2F2ZWQuQWZ0ZXIsIHRoaXMpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIENhbnZhcyBpcyBub3cgcGF0Y2hlZCAtIHVwZGF0ZSBhbGwgb3BlbiBjYW52YXNlc1xyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiB7XHJcbiAgICAgIGlmIChsZWFmLnZpZXcuZ2V0Vmlld1R5cGUoKSAhPT0gJ2NhbnZhcycpIHJldHVyblxyXG5cclxuICAgICAgY29uc3QgY2FudmFzVmlldyA9IGxlYWYudmlldyBhcyBDYW52YXNWaWV3XHJcblxyXG4gICAgICAvLyBQYXRjaCBlZGdlc1xyXG4gICAgICBjYW52YXNWaWV3LmNhbnZhcy5lZGdlcy5mb3JFYWNoKGVkZ2UgPT4gdGhpcy5wYXRjaEVkZ2UoZWRnZSkpXHJcblxyXG4gICAgICAvLyBUcmlnZ2VyIG5vZGVzL2VkZ2VzIGFkZGVkIGV2ZW50XHJcbiAgICAgIGNhbnZhc1ZpZXcuY2FudmFzLm5vZGVzLmZvckVhY2gobm9kZSA9PiB0aGF0LnJ1bkFmdGVySW5pdGlhbGl6ZWQobm9kZSwgKCkgPT4gdGhhdC50cmlnZ2VyV29ya3NwYWNlRXZlbnQoQ2FudmFzRXZlbnQuTm9kZUFkZGVkLCBjYW52YXNWaWV3LmNhbnZhcywgbm9kZSkpKVxyXG4gICAgICBjYW52YXNWaWV3LmNhbnZhcy5lZGdlcy5mb3JFYWNoKGVkZ2UgPT4gdGhhdC5ydW5BZnRlckluaXRpYWxpemVkKGVkZ2UsICgpID0+IHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VBZGRlZCwgY2FudmFzVmlldy5jYW52YXMsIGVkZ2UpKSlcclxuXHJcbiAgICAgIC8vIFJlLWluaXQgdGhlIGNhbnZhcyB3aXRoIHRoZSBwYXRjaGVkIGNhbnZhcyBvYmplY3RcclxuICAgICAgY2FudmFzVmlldy5zZXRWaWV3RGF0YShjYW52YXNWaWV3LmdldFZpZXdEYXRhKCkpXHJcblxyXG4gICAgICAvLyBUcmlnZ2VyIHBvcHVwIG1lbnUgY2hhbmdlZCBldmVudFxyXG4gICAgICB0aGlzLnRyaWdnZXJXb3Jrc3BhY2VFdmVudChDYW52YXNFdmVudC5Qb3B1cE1lbnVDcmVhdGVkLCBjYW52YXNWaWV3LmNhbnZhcylcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhdGNoRWRnZShlZGdlOiBDYW52YXNFZGdlKSB7XHJcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xyXG5cclxuICAgIC8vIFBhdGNoIGVkZ2VcclxuICAgIGNvbnN0IHVuaW5zdGFsbCA9IGFyb3VuZChlZGdlLCB7XHJcbiAgICAgIHJlbmRlcjogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDaGFuZ2VkLCB0aGlzLmNhbnZhcywgZWRnZSlcclxuICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldENlbnRlcjogKG5leHQ6IGFueSkgPT4gZnVuY3Rpb24gKC4uLmFyZ3M6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHQuY2FsbCh0aGlzLCAuLi5hcmdzKVxyXG4gICAgICAgIHRoYXQudHJpZ2dlcldvcmtzcGFjZUV2ZW50KENhbnZhc0V2ZW50LkVkZ2VDZW50ZXJSZXF1ZXN0ZWQsIHRoaXMuY2FudmFzLCBlZGdlLCByZXN1bHQpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRoYXQucGx1Z2luLnJlZ2lzdGVyKHVuaW5zdGFsbClcclxuICB9XHJcbiAgXHJcbiAgcHJpdmF0ZSBydW5BZnRlckluaXRpYWxpemVkKGNhbnZhc0VsZW1lbnQ6IENhbnZhc0VsZW1lbnQsIG9uUmVhZHk6ICgpID0+IHZvaWQpIHtcclxuICAgIGlmIChjYW52YXNFbGVtZW50LmluaXRpYWxpemVkKSB7XHJcbiAgICAgIG9uUmVhZHkoKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xyXG5cclxuICAgIC8vIFBhdGNoIENhbnZhc0VsZW1lbnQgb2JqZWN0XHJcbiAgICBjb25zdCB1bmluc3RhbGwgPSBhcm91bmQoY2FudmFzRWxlbWVudCwge1xyXG4gICAgICBpbml0aWFsaXplOiAobmV4dDogYW55KSA9PiBmdW5jdGlvbiAoLi4uYXJnczogYW55KSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpXHJcblxyXG4gICAgICAgIG9uUmVhZHkoKVxyXG4gICAgICAgIHVuaW5zdGFsbCgpIC8vIFVuaW5zdGFsbCB0aGUgcGF0Y2hcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHRoYXQucGx1Z2luLnJlZ2lzdGVyKHVuaW5zdGFsbClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdHJpZ2dlcldvcmtzcGFjZUV2ZW50KGV2ZW50OiBzdHJpbmcsIC4uLmFyZ3M6IGFueSkge1xyXG4gICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS50cmlnZ2VyKGV2ZW50LCAuLi5hcmdzKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMsIFBvc2l0aW9uIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvZXZlbnRzL2V2ZW50c1wiXHJcblxyXG5jb25zdCBHUk9VUF9OT0RFX1NJWkUgPSB7IHdpZHRoOiAzMDAsIGhlaWdodDogMzAwIH1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdyb3VwQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogYW55KSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB7XHJcbiAgICAgICAgQ2FudmFzSGVscGVyLmFkZENhcmRNZW51T3B0aW9uKFxyXG4gICAgICAgICAgY2FudmFzLFxyXG4gICAgICAgICAgQ2FudmFzSGVscGVyLmNyZWF0ZUNhcmRNZW51T3B0aW9uKFxyXG4gICAgICAgICAgICBjYW52YXMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpZDogJ2NyZWF0ZS1ncm91cCcsXHJcbiAgICAgICAgICAgICAgbGFiZWw6ICdEcmFnIHRvIGFkZCBncm91cCcsXHJcbiAgICAgICAgICAgICAgaWNvbjogJ2dyb3VwJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAoKSA9PiBHUk9VUF9OT0RFX1NJWkUsXHJcbiAgICAgICAgICAgIChjYW52YXM6IENhbnZhcywgcG9zOiBQb3NpdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgIGNhbnZhcy5jcmVhdGVHcm91cE5vZGUoe1xyXG4gICAgICAgICAgICAgICAgcG9zOiBwb3MsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBHUk9VUF9OT0RFX1NJWkVcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICApXHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICApKVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbidcclxuaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNFZGdlLCBDYW52YXNOb2RlLCBQb3NpdGlvbiwgU2l6ZSB9IGZyb20gJ3NyYy9AdHlwZXMvQ2FudmFzJ1xyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSAnc3JjL21haW4nXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSAnc3JjL2V2ZW50cy9ldmVudHMnXHJcbmltcG9ydCAqIGFzIENhbnZhc0hlbHBlciBmcm9tIFwic3JjL3V0aWxzL2NhbnZhcy1oZWxwZXJcIlxyXG5pbXBvcnQgKiBhcyBCQm94SGVscGVyIGZyb20gXCJzcmMvdXRpbHMvYmJveC1oZWxwZXJcIlxyXG5cclxuY29uc3QgU1RBUlRfU0xJREVfTkFNRSA9ICdTdGFydCBTbGlkZSdcclxuY29uc3QgREVGQVVMVF9TTElERV9OQU1FID0gJ05ldyBTbGlkZSdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByZXNlbnRhdGlvbkNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG4gIHNhdmVkVmlld3BvcnQ6IGFueSA9IG51bGxcclxuICBpc1ByZXNlbnRhdGlvbk1vZGU6IGJvb2xlYW4gPSBmYWxzZVxyXG4gIHZpc2l0ZWROb2RlczogYW55W10gPSBbXVxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IGFueSkge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdwcmVzZW50YXRpb25GZWF0dXJlRW5hYmxlZCcpKSByZXR1cm5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICdjcmVhdGUtbmV3LXNsaWRlJyxcclxuXHRcdFx0bmFtZTogJ0NyZWF0ZSBuZXcgc2xpZGUnLFxyXG5cdFx0XHRjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+ICFjYW52YXMucmVhZG9ubHkgJiYgIXRoaXMuaXNQcmVzZW50YXRpb25Nb2RlLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5hZGRTbGlkZShjYW52YXMpXHJcbiAgICAgIClcclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnc3RhcnQtcHJlc2VudGF0aW9uJyxcclxuICAgICAgbmFtZTogJ1N0YXJ0IHByZXNlbnRhdGlvbicsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChfY2FudmFzOiBDYW52YXMpID0+ICF0aGlzLmlzUHJlc2VudGF0aW9uTW9kZSxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMuc3RhcnRQcmVzZW50YXRpb24oY2FudmFzKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ3ByZXZpb3VzLW5vZGUnLFxyXG4gICAgICBuYW1lOiAnUHJldmlvdXMgbm9kZScsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChfY2FudmFzOiBDYW52YXMpID0+IHRoaXMuaXNQcmVzZW50YXRpb25Nb2RlLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5wcmV2aW91c05vZGUoY2FudmFzKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRoaXMucGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ25leHQtbm9kZScsXHJcbiAgICAgIG5hbWU6ICdOZXh0IG5vZGUnLFxyXG4gICAgICBjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICAoX2NhbnZhczogQ2FudmFzKSA9PiB0aGlzLmlzUHJlc2VudGF0aW9uTW9kZSxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMubmV4dE5vZGUoY2FudmFzKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGV2ZW50c1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5DYW52YXNDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMub25DYW52YXNDaGFuZ2VkKGNhbnZhcylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Qb3B1cE1lbnVDcmVhdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHRoaXMub25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhcylcclxuICAgICkpXHJcbiAgfVxyXG5cclxuICBvbkNhbnZhc0NoYW5nZWQoY2FudmFzOiBDYW52YXMpOiB2b2lkIHtcclxuICAgIENhbnZhc0hlbHBlci5hZGRDYXJkTWVudU9wdGlvbihcclxuICAgICAgY2FudmFzLFxyXG4gICAgICBDYW52YXNIZWxwZXIuY3JlYXRlQ2FyZE1lbnVPcHRpb24oXHJcbiAgICAgICAgY2FudmFzLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiAnbmV3LXNsaWRlJyxcclxuICAgICAgICAgIGxhYmVsOiAnRHJhZyB0byBhZGQgc2xpZGUnLFxyXG4gICAgICAgICAgaWNvbjogJ2dhbGxlcnktdmVydGljYWwnXHJcbiAgICAgICAgfSxcclxuICAgICAgICAoKSA9PiB0aGlzLmdldFNsaWRlU2l6ZSgpLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcywgcG9zOiBQb3NpdGlvbikgPT4gdGhpcy5hZGRTbGlkZShjYW52YXMsIHBvcylcclxuICAgICAgKVxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgb25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhczogQ2FudmFzKTogdm9pZCB7XHJcbiAgICAvLyBJZiB0aGUgY2FudmFzIGlzIHJlYWRvbmx5IG9yIHRoZXJlIGFyZSBtdWx0aXBsZS9ubyBub2RlcyBzZWxlY3RlZCwgcmV0dXJuXHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGVzRGF0YSA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXNcclxuICAgIGlmIChjYW52YXMucmVhZG9ubHkgfHwgc2VsZWN0ZWROb2Rlc0RhdGEubGVuZ3RoICE9PSAxIHx8IGNhbnZhcy5zZWxlY3Rpb24uc2l6ZSA+IDEpIHJldHVyblxyXG4gICAgXHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBjYW52YXMubm9kZXMuZ2V0KHNlbGVjdGVkTm9kZXNEYXRhWzBdLmlkKVxyXG4gICAgaWYgKCFzZWxlY3RlZE5vZGUpIHJldHVyblxyXG4gICAgXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUG9wdXBNZW51T3B0aW9uKFxyXG4gICAgICBjYW52YXMsXHJcbiAgICAgIENhbnZhc0hlbHBlci5jcmVhdGVQb3B1cE1lbnVPcHRpb24oe1xyXG4gICAgICAgIGlkOiAnc3RhcnQtbm9kZScsIFxyXG4gICAgICAgIGxhYmVsOiAnU2V0IGFzIHN0YXJ0IHNsaWRlJywgXHJcbiAgICAgICAgaWNvbjogJ3BsYXknLCBcclxuICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zZXRTdGFydE5vZGUoY2FudmFzLCBzZWxlY3RlZE5vZGUpXHJcbiAgICAgIH0pXHJcbiAgICApXHJcbiAgfVxyXG4gIFxyXG4gIHByaXZhdGUgZ2V0U3RhcnROb2RlKGNhbnZhczogQ2FudmFzKTogQ2FudmFzTm9kZXx1bmRlZmluZWQge1xyXG4gICAgZm9yIChjb25zdCBbXywgbm9kZV0gb2YgY2FudmFzLm5vZGVzKSB7XHJcbiAgICAgIGlmIChub2RlLmdldERhdGEoKS5pc1N0YXJ0Tm9kZSkgcmV0dXJuIG5vZGVcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdW5kZWZpbmVkXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFN0YXJ0Tm9kZShjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZXx1bmRlZmluZWQpIHtcclxuICAgIGlmICghbm9kZSkgcmV0dXJuXHJcblxyXG4gICAgY29uc3Qgc3RhcnROb2RlID0gdGhpcy5nZXRTdGFydE5vZGUoY2FudmFzKVxyXG4gICAgaWYgKHN0YXJ0Tm9kZSkgY2FudmFzLnNldE5vZGVEYXRhKHN0YXJ0Tm9kZSwgJ2lzU3RhcnROb2RlJywgZmFsc2UpXHJcblxyXG4gICAgaWYgKG5vZGUgIT09IHN0YXJ0Tm9kZSkgY2FudmFzLnNldE5vZGVEYXRhKG5vZGUsICdpc1N0YXJ0Tm9kZScsIHRydWUpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldFNsaWRlU2l6ZSgpOiBTaXplIHtcclxuICAgIGNvbnN0IHNsaWRlU2l6ZVN0cmluZyA9IHRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdkZWZhdWx0U2xpZGVTaXplJylcclxuICAgIGNvbnN0IHNsaWRlU2l6ZUFycmF5ID0gc2xpZGVTaXplU3RyaW5nLnNwbGl0KCd4JykubWFwKCh2YWx1ZTogc3RyaW5nKSA9PiBwYXJzZUludCh2YWx1ZSkpXHJcbiAgICByZXR1cm4geyB3aWR0aDogc2xpZGVTaXplQXJyYXlbMF0sIGhlaWdodDogc2xpZGVTaXplQXJyYXlbMV0gfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhZGRTbGlkZShjYW52YXM6IENhbnZhcywgcG9zPzogUG9zaXRpb24pIHtcclxuICAgIGlmICghcG9zKSBwb3MgPSBDYW52YXNIZWxwZXIuZ2V0Q2VudGVyQ29vcmRpbmF0ZXMoY2FudmFzLCB0aGlzLmdldFNsaWRlU2l6ZSgpKVxyXG5cclxuICAgIGNvbnN0IGlzU3RhcnROb2RlID0gdGhpcy5nZXRTdGFydE5vZGUoY2FudmFzKSA9PSBudWxsXHJcbiAgICBjb25zdCBub2RlU2l6ZSA9IHRoaXMuZ2V0U2xpZGVTaXplKClcclxuXHJcbiAgICBjb25zdCBncm91cE5vZGUgPSBjYW52YXMuY3JlYXRlR3JvdXBOb2RlKHtcclxuICAgICAgcG9zOiBwb3MsXHJcbiAgICAgIHNpemU6IG5vZGVTaXplLFxyXG4gICAgICBsYWJlbDogaXNTdGFydE5vZGUgPyBTVEFSVF9TTElERV9OQU1FIDogREVGQVVMVF9TTElERV9OQU1FLFxyXG4gICAgICBmb2N1czogZmFsc2UsXHJcbiAgICB9KVxyXG5cclxuICAgIGlmIChpc1N0YXJ0Tm9kZSkgY2FudmFzLnNldE5vZGVEYXRhKGdyb3VwTm9kZSwgJ2lzU3RhcnROb2RlJywgdHJ1ZSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgYW5pbWF0ZU5vZGVUcmFuc2l0aW9uKGNhbnZhczogQ2FudmFzLCBmcm9tTm9kZTogQ2FudmFzTm9kZXx1bmRlZmluZWQsIHRvTm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgY29uc3QgdXNlQ3VzdG9tWm9vbUZ1bmN0aW9uID0gdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3pvb21Ub1NsaWRlV2l0aG91dFBhZGRpbmcnKVxyXG4gICAgY29uc3QgYW5pbWF0aW9uRHVyYXRpb25NcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdzbGlkZVRyYW5zaXRpb25BbmltYXRpb25EdXJhdGlvbicpICogMTAwMFxyXG4gICAgXHJcbiAgICBpZiAoYW5pbWF0aW9uRHVyYXRpb25NcyA+IDAgJiYgZnJvbU5vZGUpIHtcclxuICAgICAgY29uc3QgYW5pbWF0aW9uSW50ZW5zaXR5ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3NsaWRlVHJhbnNpdGlvbkFuaW1hdGlvbkludGVuc2l0eScpXHJcblxyXG4gICAgICBjb25zdCBjdXJyZW50Tm9kZUJCb3hFbmxhcmdlZCA9IEJCb3hIZWxwZXIuc2NhbGVCQm94KGZyb21Ob2RlLmdldEJCb3goKSwgYW5pbWF0aW9uSW50ZW5zaXR5KVxyXG4gICAgICBpZiAodXNlQ3VzdG9tWm9vbUZ1bmN0aW9uKSBDYW52YXNIZWxwZXIuem9vbVRvQkJveChjYW52YXMsIGN1cnJlbnROb2RlQkJveEVubGFyZ2VkKVxyXG4gICAgICBlbHNlIGNhbnZhcy56b29tVG9CYm94KGN1cnJlbnROb2RlQkJveEVubGFyZ2VkKVxyXG5cclxuICAgICAgYXdhaXQgc2xlZXAoYW5pbWF0aW9uRHVyYXRpb25NcyAvIDIpXHJcblxyXG4gICAgICBjb25zdCBuZXh0Tm9kZUJCb3hFbmxhcmdlZCA9IEJCb3hIZWxwZXIuc2NhbGVCQm94KHRvTm9kZS5nZXRCQm94KCksIGFuaW1hdGlvbkludGVuc2l0eSlcclxuICAgICAgaWYgKHVzZUN1c3RvbVpvb21GdW5jdGlvbikgQ2FudmFzSGVscGVyLnpvb21Ub0JCb3goY2FudmFzLCBuZXh0Tm9kZUJCb3hFbmxhcmdlZClcclxuICAgICAgZWxzZSBjYW52YXMuem9vbVRvQmJveChuZXh0Tm9kZUJCb3hFbmxhcmdlZClcclxuXHJcbiAgICAgIGF3YWl0IHNsZWVwKGFuaW1hdGlvbkR1cmF0aW9uTXMgLyAyKVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBub2RlQkJveCA9IHRvTm9kZS5nZXRCQm94KClcclxuICAgIGlmICh1c2VDdXN0b21ab29tRnVuY3Rpb24pIENhbnZhc0hlbHBlci56b29tVG9CQm94KGNhbnZhcywgbm9kZUJCb3gpXHJcbiAgICBlbHNlIGNhbnZhcy56b29tVG9CYm94KG5vZGVCQm94KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBzdGFydFByZXNlbnRhdGlvbihjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3Qgc3RhcnROb2RlID0gdGhpcy5nZXRTdGFydE5vZGUoY2FudmFzKVxyXG4gICAgaWYgKCFzdGFydE5vZGUpIHtcclxuICAgICAgbmV3IE5vdGljZSgnTm8gc3RhcnQgbm9kZSBmb3VuZC4gUGxlYXNlIG1hcmsgYSBub2RlIGFzIGEgc3RhcnQgbm9kZSB0cm91Z2ggdGhlIHBvcHVwIG1lbnUuJylcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy52aXNpdGVkTm9kZXMgPSBbXVxyXG4gICAgdGhpcy5zYXZlZFZpZXdwb3J0ID0ge1xyXG4gICAgICB4OiBjYW52YXMudHgsXHJcbiAgICAgIHk6IGNhbnZhcy50eSxcclxuICAgICAgem9vbTogY2FudmFzLnRab29tLFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEVudGVyIGZ1bGxzY3JlZW4gbW9kZVxyXG4gICAgY2FudmFzLndyYXBwZXJFbC5mb2N1cygpXHJcbiAgICBjYW52YXMud3JhcHBlckVsLnJlcXVlc3RGdWxsc2NyZWVuKClcclxuICAgIGNhbnZhcy53cmFwcGVyRWwuY2xhc3NMaXN0LmFkZCgncHJlc2VudGF0aW9uLW1vZGUnKVxyXG5cclxuICAgIC8vIExvY2sgY2FudmFzXHJcbiAgICBjYW52YXMuc2V0UmVhZG9ubHkodHJ1ZSlcclxuXHJcbiAgICAvLyBSZWdpc3RlciBldmVudCBoYW5kbGVyIGZvciBrZXlib2FyZCBuYXZpZ2F0aW9uXHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3VzZUFycm93S2V5c1RvQ2hhbmdlU2xpZGVzJykpIHtcclxuICAgICAgY2FudmFzLndyYXBwZXJFbC5vbmtleWRvd24gPSAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgaWYgKGUua2V5ID09PSAnQXJyb3dSaWdodCcpIHRoaXMubmV4dE5vZGUoY2FudmFzKVxyXG4gICAgICAgIGVsc2UgaWYgKGUua2V5ID09PSAnQXJyb3dMZWZ0JykgdGhpcy5wcmV2aW91c05vZGUoY2FudmFzKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gS2VlcCBtb2RhbHMgd2hpbGUgaW4gZnVsbHNjcmVlbiBtb2RlXHJcbiAgICBjb25zdCBmdWxsc2NyZWVuTW9kYWxPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvblJlY29yZHMpID0+IHtcclxuICAgICAgbXV0YXRpb25SZWNvcmRzLmZvckVhY2goKG11dGF0aW9uUmVjb3JkKSA9PiB7XHJcbiAgICAgICAgbXV0YXRpb25SZWNvcmQuYWRkZWROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XHJcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG5vZGUpXHJcbiAgICAgICAgICBkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudD8uYXBwZW5kQ2hpbGQobm9kZSlcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc3QgaW5wdXRGaWVsZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvbXB0LWlucHV0XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnR8bnVsbFxyXG4gICAgICBpZiAoaW5wdXRGaWVsZCkgaW5wdXRGaWVsZC5mb2N1cygpXHJcbiAgICB9KVxyXG4gICAgZnVsbHNjcmVlbk1vZGFsT2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7IGNoaWxkTGlzdDogdHJ1ZSB9KVxyXG5cclxuICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXIgZm9yIGV4aXRpbmcgcHJlc2VudGF0aW9uIG1vZGVcclxuICAgIGNhbnZhcy53cmFwcGVyRWwub25mdWxsc2NyZWVuY2hhbmdlID0gKF9lOiBhbnkpID0+IHtcclxuICAgICAgaWYgKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSByZXR1cm5cclxuXHJcbiAgICAgIGZ1bGxzY3JlZW5Nb2RhbE9ic2VydmVyLmRpc2Nvbm5lY3QoKVxyXG4gICAgICB0aGlzLmVuZFByZXNlbnRhdGlvbihjYW52YXMpXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5pc1ByZXNlbnRhdGlvbk1vZGUgPSB0cnVlXHJcblxyXG4gICAgLy8gV2FpdCBmb3IgZnVsbHNjcmVlbiB0byBiZSBlbmFibGVkXHJcbiAgICBhd2FpdCBzbGVlcCg1MDApXHJcblxyXG4gICAgLy8gWm9vbSB0byBmaXJzdCBub2RlXHJcbiAgICB0aGlzLnZpc2l0ZWROb2Rlcy5wdXNoKHN0YXJ0Tm9kZSlcclxuICAgIHRoaXMuYW5pbWF0ZU5vZGVUcmFuc2l0aW9uKGNhbnZhcywgdW5kZWZpbmVkLCBzdGFydE5vZGUpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGVuZFByZXNlbnRhdGlvbihjYW52YXM6IENhbnZhcykge1xyXG4gICAgLy8gVW5yZWdpc3RlciBldmVudCBoYW5kbGVyc1xyXG4gICAgY2FudmFzLndyYXBwZXJFbC5vbmtleWRvd24gPSBudWxsXHJcbiAgICBjYW52YXMud3JhcHBlckVsLm9uZnVsbHNjcmVlbmNoYW5nZSA9IG51bGxcclxuXHJcbiAgICAvLyBVbmxvY2sgY2FudmFzXHJcbiAgICBjYW52YXMuc2V0UmVhZG9ubHkoZmFsc2UpXHJcblxyXG4gICAgLy8gRXhpdCBmdWxsc2NyZWVuIG1vZGVcclxuICAgIGNhbnZhcy53cmFwcGVyRWwuY2xhc3NMaXN0LnJlbW92ZSgncHJlc2VudGF0aW9uLW1vZGUnKVxyXG4gICAgaWYgKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpXHJcblxyXG4gICAgLy8gUmVzZXQgdmlld3BvcnRcclxuICAgIGNhbnZhcy5zZXRWaWV3cG9ydCh0aGlzLnNhdmVkVmlld3BvcnQueCwgdGhpcy5zYXZlZFZpZXdwb3J0LnksIHRoaXMuc2F2ZWRWaWV3cG9ydC56b29tKVxyXG4gICAgdGhpcy5pc1ByZXNlbnRhdGlvbk1vZGUgPSBmYWxzZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBuZXh0Tm9kZShjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3QgZnJvbU5vZGUgPSB0aGlzLnZpc2l0ZWROb2Rlcy5sYXN0KClcclxuICAgIGlmICghZnJvbU5vZGUpIHJldHVyblxyXG5cclxuICAgIGNvbnN0IG91dGdvaW5nRWRnZXMgPSBjYW52YXMuZ2V0RWRnZXNGb3JOb2RlKGZyb21Ob2RlKS5maWx0ZXIoKGVkZ2U6IENhbnZhc0VkZ2UpID0+IGVkZ2UuZnJvbS5ub2RlID09PSBmcm9tTm9kZSlcclxuICAgIGxldCB0b05vZGUgPSBvdXRnb2luZ0VkZ2VzLmZpcnN0KCk/LnRvLm5vZGVcclxuXHJcbiAgICAvLyBJZiB0aGVyZSBhcmUgbXVsdGlwbGUgb3V0Z29pbmcgZWRnZXMsIHdlIG5lZWQgdG8gbG9vayBhdCB0aGUgZWRnZSBsYWJlbFxyXG4gICAgaWYgKG91dGdvaW5nRWRnZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAvLyBDcmVhdGUgbWFwIG9mIGVkZ2UgbGFiZWxzIHRvIG5vZGVzXHJcbiAgICAgIGNvbnN0IHNvcnRlZEVkZ2VzID0gb3V0Z29pbmdFZGdlc1xyXG4gICAgICAgIC5zb3J0KChhOiBDYW52YXNFZGdlLCBiOiBDYW52YXNFZGdlKSA9PiB7XHJcbiAgICAgICAgICBpZiAoIWEubGFiZWwpIHJldHVybiAxXHJcbiAgICAgICAgICBpZiAoIWIubGFiZWwpIHJldHVybiAtMVxyXG5cclxuICAgICAgICAgIHJldHVybiBhLmxhYmVsLmxvY2FsZUNvbXBhcmUoYi5sYWJlbClcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgLy8gRmluZCB3aGljaCBlZGdlcyBhbHJlYWR5IGhhdmUgYmVlbiB0cmF2ZXJzZWRcclxuICAgICAgY29uc3QgdHJhdmVyc2VkRWRnZXNDb3VudCA9IHRoaXMudmlzaXRlZE5vZGVzXHJcbiAgICAgICAgLmZpbHRlcigodmlzaXRlZE5vZGU6IENhbnZhc05vZGUpID0+IHZpc2l0ZWROb2RlID09IGZyb21Ob2RlKS5sZW5ndGggLSAxXHJcblxyXG4gICAgICAvLyBTZWxlY3QgbmV4dCBlZGdlXHJcbiAgICAgIGNvbnN0IG5leHRFZGdlID0gc29ydGVkRWRnZXNbdHJhdmVyc2VkRWRnZXNDb3VudF1cclxuICAgICAgdG9Ob2RlID0gbmV4dEVkZ2UudG8ubm9kZVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0b05vZGUpIHtcclxuICAgICAgdGhpcy52aXNpdGVkTm9kZXMucHVzaCh0b05vZGUpXHJcbiAgICAgIHRoaXMuYW5pbWF0ZU5vZGVUcmFuc2l0aW9uKGNhbnZhcywgZnJvbU5vZGUsIHRvTm9kZSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIE5vIG1vcmUgbm9kZXMgbGVmdCwgYW5pbWF0ZSB0byBzYW1lIG5vZGVcclxuICAgICAgdGhpcy5hbmltYXRlTm9kZVRyYW5zaXRpb24oY2FudmFzLCBmcm9tTm9kZSwgZnJvbU5vZGUpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHByZXZpb3VzTm9kZShjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3QgZnJvbU5vZGUgPSB0aGlzLnZpc2l0ZWROb2Rlcy5wb3AoKVxyXG4gICAgaWYgKCFmcm9tTm9kZSkgcmV0dXJuXHJcblxyXG4gICAgbGV0IHRvTm9kZSA9IHRoaXMudmlzaXRlZE5vZGVzLmxhc3QoKVxyXG5cclxuICAgIC8vIEZhbGwgYmFjayB0byBzYW1lIG5vZGUgaWYgdGhlcmUgYXJlIG5vIG1vcmUgbm9kZXMgYmVmb3JlXHJcbiAgICBpZiAoIXRvTm9kZSkge1xyXG4gICAgICB0b05vZGUgPSBmcm9tTm9kZVxyXG4gICAgICB0aGlzLnZpc2l0ZWROb2Rlcy5wdXNoKGZyb21Ob2RlKVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYW5pbWF0ZU5vZGVUcmFuc2l0aW9uKGNhbnZhcywgZnJvbU5vZGUsIHRvTm9kZSlcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNOb2RlLCBDYW52YXNOb2RlRGF0YSB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9ldmVudHMvZXZlbnRzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1NldHRpbmdzTWFuYWdlciBmcm9tIFwic3JjL3NldHRpbmdzXCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFeHBvc2VkTm9kZURhdGEoc2V0dGluZ3M6IEFkdmFuY2VkQ2FudmFzU2V0dGluZ3NNYW5hZ2VyKTogKGtleW9mIENhbnZhc05vZGVEYXRhKVtdIHtcclxuICBjb25zdCBleHBvc2VkRGF0YTogKGtleW9mIENhbnZhc05vZGVEYXRhKVtdID0gW11cclxuICBcclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygnc3RpY2tlcnNGZWF0dXJlRW5hYmxlZCcpKSBleHBvc2VkRGF0YS5wdXNoKCdpc1N0aWNrZXInKVxyXG4gIGlmIChzZXR0aW5ncy5nZXRTZXR0aW5nKCdzaGFwZXNGZWF0dXJlRW5hYmxlZCcpKSBleHBvc2VkRGF0YS5wdXNoKCdzaGFwZScpXHJcbiAgaWYgKHNldHRpbmdzLmdldFNldHRpbmcoJ3ByZXNlbnRhdGlvbkZlYXR1cmVFbmFibGVkJykpIGV4cG9zZWREYXRhLnB1c2goJ2lzU3RhcnROb2RlJylcclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygncG9ydGFsc0ZlYXR1cmVFbmFibGVkJykpIGV4cG9zZWREYXRhLnB1c2goJ3BvcnRhbFRvRmlsZScsICdwb3J0YWxJZCcpXHJcblxyXG4gIHJldHVybiBleHBvc2VkRGF0YVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOb2RlRGF0YVRhZ2dlckNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuTm9kZUNoYW5nZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIG5vZGU6IENhbnZhc05vZGUpID0+IHtcclxuICAgICAgICBjb25zdCBub2RlRGF0YSA9IG5vZGU/LmdldERhdGEoKVxyXG4gICAgICAgIGlmICghbm9kZURhdGEpIHJldHVyblxyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGRhdGFLZXkgb2YgZ2V0RXhwb3NlZE5vZGVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlcikpIHtcclxuICAgICAgICAgIGNvbnN0IGRhdGFWYWx1ZSA9IG5vZGVEYXRhW2RhdGFLZXldXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChkYXRhVmFsdWUgPT09IHVuZGVmaW5lZCkgZGVsZXRlIG5vZGUubm9kZUVsLmRhdGFzZXRbZGF0YUtleV1cclxuICAgICAgICAgIGVsc2Ugbm9kZS5ub2RlRWwuZGF0YXNldFtkYXRhS2V5XSA9IGRhdGFWYWx1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgKSlcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNOb2RlIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgZ2V0RXhwb3NlZE5vZGVEYXRhIH0gZnJvbSBcIi4vbm9kZS1kYXRhLXRhZ2dlci1jYW52YXMtZXh0ZW5zaW9uXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9ldmVudHMvZXZlbnRzXCJcclxuXHJcbmV4cG9ydCBjb25zdCBUQVJHRVRfTk9ERV9EQVRBU0VUX1BSRUZJWCA9IFwidGFyZ2V0XCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEludGVyYWN0aW9uVGFnZ2VyQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgLy8gUmVnaXN0ZXIgZXZlbnRzXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVJbnRlcmFjdGlvbixcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBub2RlOiBDYW52YXNOb2RlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25FbCA9IGNhbnZhcy5ub2RlSW50ZXJhY3Rpb25MYXllci5pbnRlcmFjdGlvbkVsXHJcbiAgICAgICAgaWYgKCFpbnRlcmFjdGlvbkVsKSByZXR1cm5cclxuICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0YUtleSBvZiBnZXRFeHBvc2VkTm9kZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyKSkge1xyXG4gICAgICAgICAgY29uc3QgZGF0YXNldEtleSA9IFRBUkdFVF9OT0RFX0RBVEFTRVRfUFJFRklYICsgZGF0YUtleS50b1N0cmluZygpLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGF0YUtleS50b1N0cmluZygpLnNsaWNlKDEpXHJcbiAgICBcclxuICAgICAgICAgIGNvbnN0IGRhdGFWYWx1ZSA9IG5vZGU/LmdldERhdGEoKVtkYXRhS2V5XVxyXG5cclxuICAgICAgICAgIGlmIChkYXRhVmFsdWUgPT09IHVuZGVmaW5lZCkgZGVsZXRlIGludGVyYWN0aW9uRWwuZGF0YXNldFtkYXRhc2V0S2V5XVxyXG4gICAgICAgICAgZWxzZSBpbnRlcmFjdGlvbkVsLmRhdGFzZXRbZGF0YXNldEtleV0gPSBkYXRhVmFsdWVcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICkpXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcyB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCAqIGFzIENhbnZhc0hlbHBlciBmcm9tIFwic3JjL3V0aWxzL2NhbnZhcy1oZWxwZXJcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2V2ZW50cy9ldmVudHNcIlxyXG5pbXBvcnQgeyBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzIH0gZnJvbSBcInNyYy9zZXR0aW5nc1wiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFkb25seUNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IGFueSkge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuICAgIGNvbnN0IHRoYXQgPSB0aGlzXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnYmV0dGVyUmVhZG9ubHlFbmFibGVkJykpIHJldHVyblxyXG5cclxuICAgIC8qIFBvcHVwIGxpc3RlbmVyICovXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LlBvcHVwTWVudUNyZWF0ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgX25vZGU6IGFueSkgPT4gdGhpcy51cGRhdGVQb3B1cE1lbnUoY2FudmFzKVxyXG4gICAgKSlcclxuXHJcbiAgICAvKiBab29tIGFuZCBQYW4gbGlzdGVuZXIgKi9cclxuICAgIGxldCBtb3ZpbmdUb0JCb3ggPSBmYWxzZVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuVmlld3BvcnRDaGFuZ2VkLkJlZm9yZSxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB7XHJcbiAgICAgICAgLy8gT25seSBhbGxvdyB2aWV3cG9ydCBjaGFuZ2Ugb25jZSB3aGVuIHVzaW5nIHpvb20gdG8gYmJveFxyXG4gICAgICAgIGlmIChtb3ZpbmdUb0JCb3gpIHtcclxuICAgICAgICAgIG1vdmluZ1RvQkJveCA9IGZhbHNlXHJcblxyXG4gICAgICAgICAgdGhhdC51cGRhdGVMb2NrZWRab29tKGNhbnZhcylcclxuICAgICAgICAgIHRoYXQudXBkYXRlTG9ja2VkUGFuKGNhbnZhcylcclxuXHJcbiAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghY2FudmFzLnJlYWRvbmx5KSByZXR1cm5cclxuXHJcbiAgICAgICAgaWYgKHRoYXQucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdkaXNhYmxlWm9vbScpKSB7XHJcbiAgICAgICAgICBjYW52YXMuem9vbSA9IGNhbnZhcy5sb2NrZWRab29tID8/IGNhbnZhcy56b29tXHJcbiAgICAgICAgICBjYW52YXMudFpvb20gPSBjYW52YXMubG9ja2VkWm9vbSA/PyBjYW52YXMudFpvb21cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGF0LnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZGlzYWJsZVBhbicpKSB7XHJcbiAgICAgICAgICBjYW52YXMueCA9IGNhbnZhcy5sb2NrZWRYID8/IGNhbnZhcy54XHJcbiAgICAgICAgICBjYW52YXMudHggPSBjYW52YXMubG9ja2VkWCA/PyBjYW52YXMudHhcclxuICAgICAgICAgIGNhbnZhcy55ID0gY2FudmFzLmxvY2tlZFkgPz8gY2FudmFzLnlcclxuICAgICAgICAgIGNhbnZhcy50eSA9IGNhbnZhcy5sb2NrZWRZID8/IGNhbnZhcy50eVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgKSlcclxuXHJcbiAgICAvLyBBbGxvdyB2aWV3cG9ydCBjaGFuZ2Ugd2hlbiB1c2luZyB6b29tIHRvIGJib3hcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuWm9vbVRvQmJveC5CZWZvcmUsXHJcbiAgICAgICgpID0+IG1vdmluZ1RvQkJveCA9IHRydWVcclxuICAgICkpXHJcblxyXG4gICAgLyogUmVhZG9ubHkgbGlzdGVuZXIgKi9cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUmVhZG9ubHlDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIF9yZWFkb25seTogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIHRoaXMudXBkYXRlUG9wdXBNZW51KGNhbnZhcylcclxuICAgICAgICB0aGlzLnVwZGF0ZUxvY2tlZFpvb20oY2FudmFzKVxyXG4gICAgICAgIHRoaXMudXBkYXRlTG9ja2VkUGFuKGNhbnZhcylcclxuICAgICAgfVxyXG4gICAgKSlcclxuXHJcbiAgICAvKiBBZGQgc2V0dGluZ3MgKi9cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuQ2FudmFzQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLmFkZFF1aWNrU2V0dGluZ3MoY2FudmFzKVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIGFkZFF1aWNrU2V0dGluZ3MoY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gY2FudmFzLnF1aWNrU2V0dGluZ3NCdXR0b24/LnBhcmVudEVsZW1lbnRcclxuICAgIGlmICghc2V0dGluZ3NDb250YWluZXIpIHJldHVyblxyXG5cclxuICAgIENhbnZhc0hlbHBlci5hZGRRdWlja1NldHRpbmdzQnV0dG9uKFxyXG4gICAgICBzZXR0aW5nc0NvbnRhaW5lcixcclxuICAgICAgdGhpcy5jcmVhdGVUb2dnbGUoe1xyXG4gICAgICAgIGlkOiAnZGlzYWJsZS1ub2RlLXBvcHVwJyxcclxuICAgICAgICBsYWJlbDogJ0Rpc2FibGUgbm9kZSBwb3B1cCcsXHJcbiAgICAgICAgaWNvbjogJ2Fycm93LXVwLXJpZ2h0LWZyb20tY2lyY2xlJyxcclxuICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy51cGRhdGVQb3B1cE1lbnUoY2FudmFzKVxyXG4gICAgICB9LCAnZGlzYWJsZU5vZGVQb3B1cCcpXHJcbiAgICApXHJcblxyXG4gICAgQ2FudmFzSGVscGVyLmFkZFF1aWNrU2V0dGluZ3NCdXR0b24oXHJcbiAgICAgIHNldHRpbmdzQ29udGFpbmVyLFxyXG4gICAgICB0aGlzLmNyZWF0ZVRvZ2dsZSh7XHJcbiAgICAgICAgaWQ6ICdkaXNhYmxlLXpvb20nLFxyXG4gICAgICAgIGxhYmVsOiAnRGlzYWJsZSB6b29tJyxcclxuICAgICAgICBpY29uOiAnem9vbS1pbicsXHJcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMudXBkYXRlTG9ja2VkWm9vbShjYW52YXMpXHJcbiAgICAgIH0sICdkaXNhYmxlWm9vbScpXHJcbiAgICApXHJcblxyXG4gICAgQ2FudmFzSGVscGVyLmFkZFF1aWNrU2V0dGluZ3NCdXR0b24oXHJcbiAgICAgIHNldHRpbmdzQ29udGFpbmVyLFxyXG4gICAgICB0aGlzLmNyZWF0ZVRvZ2dsZSh7XHJcbiAgICAgICAgaWQ6ICdkaXNhYmxlLXBhbicsXHJcbiAgICAgICAgbGFiZWw6ICdEaXNhYmxlIHBhbicsXHJcbiAgICAgICAgaWNvbjogJ21vdmUnLFxyXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLnVwZGF0ZUxvY2tlZFBhbihjYW52YXMpXHJcbiAgICAgIH0sICdkaXNhYmxlUGFuJylcclxuICAgIClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlVG9nZ2xlKG1lbnVPcHRpb246IENhbnZhc0hlbHBlci5NZW51T3B0aW9uLCBzZXR0aW5nS2V5OiBrZXlvZiBBZHZhbmNlZENhbnZhc1BsdWdpblNldHRpbmdzKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3QgdG9nZ2xlID0gQ2FudmFzSGVscGVyLmNyZWF0ZVF1aWNrU2V0dGluZ3NCdXR0b24oe1xyXG4gICAgICAuLi5tZW51T3B0aW9uLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4gKGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9ICF0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZyhzZXR0aW5nS2V5KVxyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5zZXRTZXR0aW5nKHsgW3NldHRpbmdLZXldOiBuZXdWYWx1ZSB9KVxyXG5cclxuICAgICAgICB0b2dnbGUuZGF0YXNldC50b2dnbGVkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoc2V0dGluZ0tleSkudG9TdHJpbmcoKVxyXG4gICAgICAgIG1lbnVPcHRpb24uY2FsbGJhY2s/LmNhbGwodGhpcylcclxuICAgICAgfSkoKVxyXG4gICAgfSlcclxuICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdzaG93LXdoaWxlLXJlYWRvbmx5JylcclxuXHJcbiAgICB0b2dnbGUuZGF0YXNldC50b2dnbGVkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoc2V0dGluZ0tleSkudG9TdHJpbmcoKVxyXG5cclxuICAgIHJldHVybiB0b2dnbGVcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlUG9wdXBNZW51KGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICBjb25zdCBoaWRkZW4gPSBjYW52YXMucmVhZG9ubHkgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2Rpc2FibGVOb2RlUG9wdXAnKVxyXG4gICAgY2FudmFzLm1lbnUubWVudUVsLnN0eWxlLnZpc2liaWxpdHkgPSBoaWRkZW4gPyAnaGlkZGVuJyA6ICd2aXNpYmxlJ1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVMb2NrZWRab29tKGNhbnZhczogQ2FudmFzKSB7XHJcbiAgICBjYW52YXMubG9ja2VkWm9vbSA9IGNhbnZhcy50Wm9vbVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVMb2NrZWRQYW4oY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNhbnZhcy5sb2NrZWRYID0gY2FudmFzLnR4XHJcbiAgICBjYW52YXMubG9ja2VkWSA9IGNhbnZhcy50eVxyXG4gIH1cclxufSIsICJpbXBvcnQgQXBwLCB7IFN1Z2dlc3RNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlTmFtZU1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xyXG4gIHBhcmVudFBhdGg6IHN0cmluZ1xyXG4gIGZpbGVFeHRlbnNpb246IHN0cmluZ1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGFyZW50UGF0aDogc3RyaW5nLCBmaWxlRXh0ZW5zaW9uOiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKGFwcClcclxuXHJcbiAgICB0aGlzLnBhcmVudFBhdGggPSBwYXJlbnRQYXRoXHJcbiAgICB0aGlzLmZpbGVFeHRlbnNpb24gPSBmaWxlRXh0ZW5zaW9uXHJcbiAgfVxyXG5cclxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgcXVlcnlXaXRob3V0RXh0ZW5zaW9uID0gcXVlcnkucmVwbGFjZShuZXcgUmVnRXhwKGBcXFxcLiR7dGhpcy5maWxlRXh0ZW5zaW9ufSRgKSwgJycpXHJcbiAgICBpZiAocXVlcnlXaXRob3V0RXh0ZW5zaW9uID09PSAnJykgcmV0dXJuIFtdXHJcblxyXG4gICAgY29uc3QgcXVlcnlXaXRoRXh0ZW5zaW9uID0gcXVlcnlXaXRob3V0RXh0ZW5zaW9uICsgJy4nICsgdGhpcy5maWxlRXh0ZW5zaW9uXHJcbiAgICBjb25zdCBzdWdnZXN0aW9ucyA9IFtgJHt0aGlzLnBhcmVudFBhdGh9LyR7cXVlcnlXaXRoRXh0ZW5zaW9ufWAsIHF1ZXJ5V2l0aEV4dGVuc2lvbl1cclxuICAgICAgLy8gRmlsdGVyIG91dCBzdWdnZXN0aW9ucyBmb3IgZmlsZXMgdGhhdCBhbHJlYWR5IGV4aXN0XHJcbiAgICAgIC5maWx0ZXIocyA9PiB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocykgPT09IG51bGwpXHJcblxyXG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zXHJcbiAgfVxyXG5cclxuICByZW5kZXJTdWdnZXN0aW9uKHRleHQ6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICBlbC5zZXRUZXh0KHRleHQpXHJcbiAgfVxyXG5cclxuICBvbkNob29zZVN1Z2dlc3Rpb24oX3RleHQ6IHN0cmluZywgX2V2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHt9XHJcblxyXG4gIHN0YXRpYyBhd2FpdElucHV0KG1vZGFsOiBGaWxlTmFtZU1vZGFsKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgX3JlamVjdCkgPT4ge1xyXG4gICAgICBtb2RhbC5vbkNob29zZVN1Z2dlc3Rpb24gPSAodGV4dDogc3RyaW5nKSA9PiB7IHJlc29sdmUodGV4dCkgfVxyXG4gICAgICBtb2RhbC5vcGVuKClcclxuICAgIH0pXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IE1lbnUsIFN1Z2dlc3RNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiXHJcbmltcG9ydCB7IENhbnZhcyB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgRmlsZU5hbWVNb2RhbCBmcm9tIFwic3JjL3V0aWxzL21vZGFsLWhlbHBlclwiXHJcbmltcG9ydCAqIGFzIENhbnZhc0hlbHBlciBmcm9tIFwic3JjL3V0aWxzL2NhbnZhcy1oZWxwZXJcIlxyXG5cclxuY29uc3QgRU5DQVBTVUxBVEVEX0ZJTEVfTk9ERV9TSVpFID0geyB3aWR0aDogMzAwLCBoZWlnaHQ6IDMwMCB9XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFbmNhcHN1bGF0ZUNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2NhbnZhc0VuY2Fwc3VsYXRpb25FbmFibGVkJykpIHJldHVyblxyXG5cclxuICAgIC8qIEFkZCBjb21tYW5kIHRvIGVuY2Fwc3VsYXRlIHNlbGVjdGlvbiAqL1xyXG4gICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiAnZW5jYXBzdWxhdGUtc2VsZWN0aW9uJyxcclxuICAgICAgbmFtZTogJ0VuY2Fwc3VsYXRlIHNlbGVjdGlvbicsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gIWNhbnZhcy5yZWFkb25seSAmJiBjYW52YXMuc2VsZWN0aW9uLnNpemUgPiAwLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5lbmNhcHN1bGF0ZVNlbGVjdGlvbihjYW52YXMpXHJcbiAgICAgIClcclxuICAgIH0pXHJcblxyXG4gICAgLyogQWRkIGVuY2Fwc3VsYXRlIG9wdGlvbiB0byBjb250ZXh0IG1lbnUgKi9cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgJ2NhbnZhczpzZWxlY3Rpb24tbWVudScsXHJcbiAgICAgIChtZW51OiBNZW51LCBjYW52YXM6IENhbnZhcykgPT4ge1xyXG4gICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cclxuICAgICAgICAgIGl0ZW1cclxuICAgICAgICAgICAgLnNldFRpdGxlKCdFbmNhcHN1bGF0ZScpXHJcbiAgICAgICAgICAgIC5zZXRJY29uKCdmaWxlLXBsdXMnKVxyXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB0aGlzLmVuY2Fwc3VsYXRlU2VsZWN0aW9uKGNhbnZhcykpXHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICApKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZW5jYXBzdWxhdGVTZWxlY3Rpb24oY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGNvbnN0IHNlbGVjdGlvbiA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKClcclxuXHJcbiAgICAvLyBDcmVhdGUgbmV3IGZpbGVcclxuICAgIGNvbnN0IHNvdXJjZUZpbGVGb2xkZXIgPSBjYW52YXMudmlldy5maWxlLnBhcmVudD8ucGF0aFxyXG4gICAgaWYgKCFzb3VyY2VGaWxlRm9sZGVyKSByZXR1cm4gLy8gU2hvdWxkIG5ldmVyIGhhcHBlblxyXG5cclxuICAgIGNvbnN0IHRhcmdldEZpbGVQYXRoID0gYXdhaXQgRmlsZU5hbWVNb2RhbC5hd2FpdElucHV0KG5ldyBGaWxlTmFtZU1vZGFsKFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAsXHJcbiAgICAgIHNvdXJjZUZpbGVGb2xkZXIsXHJcbiAgICAgICdjYW52YXMnXHJcbiAgICApKVxyXG5cclxuICAgIGNvbnN0IG5ld0ZpbGVEYXRhID0geyBub2Rlczogc2VsZWN0aW9uLm5vZGVzLCBlZGdlczogc2VsZWN0aW9uLmVkZ2VzIH1cclxuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY3JlYXRlKHRhcmdldEZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShuZXdGaWxlRGF0YSwgbnVsbCwgMikpXHJcblxyXG4gICAgLy8gUmVtb3ZlIGZyb20gY3VycmVudCBjYW52YXNcclxuICAgIGZvciAoY29uc3Qgbm9kZURhdGEgb2Ygc2VsZWN0aW9uLm5vZGVzKSB7XHJcbiAgICAgIGNvbnN0IG5vZGUgPSBjYW52YXMubm9kZXMuZ2V0KG5vZGVEYXRhLmlkKVxyXG4gICAgICBpZiAobm9kZSkgY2FudmFzLnJlbW92ZU5vZGUobm9kZSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGQgbGluayB0byBuZXcgZmlsZSBpbiBjdXJyZW50IGNhbnZhc1xyXG4gICAgY2FudmFzLmNyZWF0ZUZpbGVOb2RlKHtcclxuICAgICAgcG9zOiB7XHJcbiAgICAgICAgeDogc2VsZWN0aW9uLmNlbnRlci54IC0gRU5DQVBTVUxBVEVEX0ZJTEVfTk9ERV9TSVpFLndpZHRoIC8gMixcclxuICAgICAgICB5OiBzZWxlY3Rpb24uY2VudGVyLnkgLSBFTkNBUFNVTEFURURfRklMRV9OT0RFX1NJWkUuaGVpZ2h0IC8gMlxyXG4gICAgICB9LFxyXG4gICAgICBzaXplOiBFTkNBUFNVTEFURURfRklMRV9OT0RFX1NJWkUsXHJcbiAgICAgIGZpbGU6IGZpbGVcclxuICAgIH0pXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcyB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgKiBhcyBDYW52YXNIZWxwZXIgZnJvbSBcInNyYy91dGlscy9jYW52YXMtaGVscGVyXCJcclxuXHJcbnR5cGUgRGlyZWN0aW9uID0gJ3VwJyB8ICdkb3duJyB8ICdsZWZ0JyB8ICdyaWdodCdcclxuY29uc3QgRElSRUNUSU9OUyA9IFsndXAnLCAnZG93bicsICdsZWZ0JywgJ3JpZ2h0J10gYXMgRGlyZWN0aW9uW11cclxuY29uc3QgRElSRUNUSU9OX0tFWVMgPSB7XHJcbiAgdXA6ICdBcnJvd1VwJyxcclxuICBkb3duOiAnQXJyb3dEb3duJyxcclxuICBsZWZ0OiAnQXJyb3dMZWZ0JyxcclxuICByaWdodDogJ0Fycm93UmlnaHQnXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbW1hbmRzQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnY29tbWFuZHNGZWF0dXJlRW5hYmxlZCcpKSByZXR1cm5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdjcmVhdGUtdGV4dC1ub2RlJyxcclxuICAgICAgbmFtZTogJ0NyZWF0ZSB0ZXh0IG5vZGUnLFxyXG4gICAgICBjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICB0aGlzLnBsdWdpbixcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+ICFjYW52YXMucmVhZG9ubHksXHJcbiAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLmNyZWF0ZVRleHROb2RlKGNhbnZhcylcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICd6b29tLXRvLXNlbGVjdGlvbicsXHJcbiAgICAgIG5hbWU6ICdab29tIHRvIHNlbGVjdGlvbicsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gY2FudmFzLnNlbGVjdGlvbi5zaXplID4gMCxcclxuICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+IGNhbnZhcy56b29tVG9TZWxlY3Rpb24oKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIGZvciAoY29uc3QgZGlyZWN0aW9uIG9mIERJUkVDVElPTlMpIHtcclxuICAgICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgaWQ6IGBjbG9uZS1ub2RlLSR7ZGlyZWN0aW9ufWAsXHJcbiAgICAgICAgbmFtZTogYENsb25lIG5vZGUgJHtkaXJlY3Rpb259YCxcclxuICAgICAgICBjaGVja0NhbGxiYWNrOiBDYW52YXNIZWxwZXIuY2FudmFzQ29tbWFuZChcclxuICAgICAgICAgIHRoaXMucGx1Z2luLFxyXG4gICAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiAhY2FudmFzLnJlYWRvbmx5ICYmIGNhbnZhcy5zZWxlY3Rpb24uc2l6ZSA9PT0gMSAmJiBjYW52YXMuc2VsZWN0aW9uLnZhbHVlcygpLm5leHQoKS52YWx1ZT8uZ2V0RGF0YSgpLnR5cGUgPT09ICd0ZXh0JyxcclxuICAgICAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5jbG9uZU5vZGUoY2FudmFzLCBkaXJlY3Rpb24pXHJcbiAgICAgICAgKVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgdGhpcy5wbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgaWQ6IGBleHBhbmQtbm9kZS0ke2RpcmVjdGlvbn1gLFxyXG4gICAgICAgIG5hbWU6IGBFeHBhbmQgbm9kZSAke2RpcmVjdGlvbn1gLFxyXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IENhbnZhc0hlbHBlci5jYW52YXNDb21tYW5kKFxyXG4gICAgICAgICAgdGhpcy5wbHVnaW4sXHJcbiAgICAgICAgICAoY2FudmFzOiBDYW52YXMpID0+ICFjYW52YXMucmVhZG9ubHkgJiYgY2FudmFzLnNlbGVjdGlvbi5zaXplID09PSAxLFxyXG4gICAgICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLmV4cGFuZE5vZGUoY2FudmFzLCBkaXJlY3Rpb24pXHJcbiAgICAgICAgKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVUZXh0Tm9kZShjYW52YXM6IENhbnZhcykge1xyXG4gICAgY29uc3Qgc2l6ZSA9IGNhbnZhcy5jb25maWcuZGVmYXVsdFRleHROb2RlRGltZW5zaW9uc1xyXG4gICAgY29uc3QgcG9zID0gQ2FudmFzSGVscGVyLmdldENlbnRlckNvb3JkaW5hdGVzKGNhbnZhcywgc2l6ZSlcclxuXHJcbiAgICBjYW52YXMuY3JlYXRlVGV4dE5vZGUoeyBwb3M6IHBvcywgc2l6ZTogc2l6ZSB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbG9uZU5vZGUoY2FudmFzOiBDYW52YXMsIGNsb25lRGlyZWN0aW9uOiBEaXJlY3Rpb24pIHtcclxuICAgIGNvbnN0IHNvdXJjZU5vZGUgPSBjYW52YXMuc2VsZWN0aW9uLnZhbHVlcygpLm5leHQoKS52YWx1ZVxyXG4gICAgaWYgKCFzb3VyY2VOb2RlKSByZXR1cm5cclxuICAgIGNvbnN0IHNvdXJjZU5vZGVEYXRhID0gc291cmNlTm9kZS5nZXREYXRhKClcclxuXHJcbiAgICBjb25zdCBub2RlTWFyZ2luID0gdGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ2Nsb25lTm9kZU1hcmdpbicpXHJcbiAgICBjb25zdCBvZmZzZXQgPSB7IFxyXG4gICAgICB4OiAoc291cmNlTm9kZS53aWR0aCArIG5vZGVNYXJnaW4pICogKGNsb25lRGlyZWN0aW9uID09PSAnbGVmdCcgPyAtMSA6IChjbG9uZURpcmVjdGlvbiA9PT0gJ3JpZ2h0JyA/IDEgOiAwKSksXHJcbiAgICAgIHk6IChzb3VyY2VOb2RlLmhlaWdodCArIG5vZGVNYXJnaW4pICogKGNsb25lRGlyZWN0aW9uID09PSAndXAnID8gLTEgOiAoY2xvbmVEaXJlY3Rpb24gPT09ICdkb3duJyA/IDEgOiAwKSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbG9uZWROb2RlID0gY2FudmFzLmNyZWF0ZVRleHROb2RlKHtcclxuICAgICAgcG9zOiB7XHJcbiAgICAgICAgeDogc291cmNlTm9kZS54ICsgb2Zmc2V0LngsXHJcbiAgICAgICAgeTogc291cmNlTm9kZS55ICsgb2Zmc2V0LnlcclxuICAgICAgfSxcclxuICAgICAgc2l6ZToge1xyXG4gICAgICAgIHdpZHRoOiBzb3VyY2VOb2RlLndpZHRoLFxyXG4gICAgICAgIGhlaWdodDogc291cmNlTm9kZS5oZWlnaHRcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBjbG9uZWROb2RlLmNvbG9yID0gc291cmNlTm9kZS5jb2xvclxyXG4gICAgY2FudmFzLnNldE5vZGVEYXRhKGNsb25lZE5vZGUsICdzaGFwZScsIHNvdXJjZU5vZGVEYXRhLnNoYXBlKVxyXG5cclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnem9vbVRvQ2xvbmVkTm9kZScpKVxyXG4gICAgICBjYW52YXMuem9vbVRvQmJveChjbG9uZWROb2RlLmdldEJCb3goKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXhwYW5kTm9kZShjYW52YXM6IENhbnZhcywgZXhwYW5kRGlyZWN0aW9uOiBEaXJlY3Rpb24pIHtcclxuICAgIGNvbnN0IG5vZGUgPSBjYW52YXMuc2VsZWN0aW9uLnZhbHVlcygpLm5leHQoKS52YWx1ZVxyXG4gICAgaWYgKCFub2RlKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBleHBhbmROb2RlU3RlcFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZXhwYW5kTm9kZVN0ZXBTaXplJylcclxuICAgIGNvbnN0IGV4cGFuZCA9IHtcclxuICAgICAgeDogZXhwYW5kRGlyZWN0aW9uID09PSAnbGVmdCcgPyAtMSA6IChleHBhbmREaXJlY3Rpb24gPT09ICdyaWdodCcgPyAxIDogMCksXHJcbiAgICAgIHk6IGV4cGFuZERpcmVjdGlvbiA9PT0gJ3VwJyA/IC0xIDogKGV4cGFuZERpcmVjdGlvbiA9PT0gJ2Rvd24nID8gMSA6IDApXHJcbiAgICB9XHJcblxyXG4gICAgbm9kZS5zZXREYXRhKHtcclxuICAgICAgLi4ubm9kZS5nZXREYXRhKCksXHJcbiAgICAgIHdpZHRoOiBub2RlLndpZHRoICsgZXhwYW5kLnggKiBleHBhbmROb2RlU3RlcFNpemUsXHJcbiAgICAgIGhlaWdodDogbm9kZS5oZWlnaHQgKyBleHBhbmQueSAqIGV4cGFuZE5vZGVTdGVwU2l6ZVxyXG4gICAgfSlcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxyXG5pbXBvcnQgeyBCQm94LCBDYW52YXMsIENhbnZhc0RhdGEsIENhbnZhc0VkZ2UsIENhbnZhc05vZGUsIENhbnZhc05vZGVEYXRhIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2V2ZW50cy9ldmVudHNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcblxyXG5jb25zdCBQT1JUQUxfUEFERElORyA9IDUwXHJcbmNvbnN0IE1JTl9PUEVOX1BPUlRBTF9TSVpFID0geyB3aWR0aDogMjAwLCBoZWlnaHQ6IDIwMCB9XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3J0YWxzQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygncG9ydGFsc0ZlYXR1cmVFbmFibGVkJykpIHJldHVyblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLnVwZGF0ZVBvcHVwTWVudShjYW52YXMpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuTm9kZVJlbW92ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkgPT4gdGhpcy5vbk5vZGVSZW1vdmVkKGNhbnZhcywgbm9kZSlcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlTW92ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkgPT4gdGhpcy5vbk5vZGVNb3ZlZChjYW52YXMsIG5vZGUpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRHJhZ2dpbmdTdGF0ZUNoYW5nZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgc3RhcnRlZERyYWdnaW5nOiBib29sZWFuKSA9PiB0aGlzLm9uRHJhZ2dpbmdTdGF0ZUNoYW5nZWQoY2FudmFzLCBzdGFydGVkRHJhZ2dpbmcpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuU2VsZWN0aW9uQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBvbGRTZWxlY3Rpb246IFNldDxDYW52YXNOb2RlfENhbnZhc0VkZ2U+LCB1cGRhdGVTZWxlY3Rpb246ICh1cGRhdGU6ICgpID0+IHZvaWQpID0+IHZvaWQpID0+IHRoaXMub25TZWxlY3Rpb25DaGFuZ2VkKGNhbnZhcywgb2xkU2VsZWN0aW9uLCB1cGRhdGVTZWxlY3Rpb24pXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRWRnZUNoYW5nZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgZWRnZTogQ2FudmFzRWRnZSkgPT4gdGhpcy5vbkVkZ2VDaGFuZ2VkKGNhbnZhcywgZWRnZSlcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5VbmRvLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHtcclxuICAgICAgICB0aGlzLmdldENhbnZhc0RhdGFXaXRoUG9ydGFscyhjYW52YXMsIGNhbnZhcy5nZXREYXRhKCkpXHJcbiAgICAgICAgICAudGhlbigoZGF0YTogQ2FudmFzRGF0YSkgPT4gY2FudmFzLmltcG9ydERhdGEoZGF0YSkpXHJcbiAgICAgIH1cclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5SZWRvLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMpID0+IHtcclxuICAgICAgICB0aGlzLmdldENhbnZhc0RhdGFXaXRoUG9ydGFscyhjYW52YXMsIGNhbnZhcy5nZXREYXRhKCkpXHJcbiAgICAgICAgICAudGhlbigoZGF0YTogQ2FudmFzRGF0YSkgPT4gY2FudmFzLmltcG9ydERhdGEoZGF0YSkpXHJcbiAgICAgIH1cclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5EYXRhUmVxdWVzdGVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIGRhdGE6IENhbnZhc0RhdGEpID0+IHRoaXMucmVtb3ZlUG9ydGFsQ2FudmFzRGF0YShjYW52YXMsIGRhdGEpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuTG9hZERhdGEsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgZGF0YTogQ2FudmFzRGF0YSwgc2V0RGF0YTogKGRhdGE6IENhbnZhc0RhdGEpID0+IHZvaWQpID0+IHtcclxuICAgICAgICB0aGlzLmdldENhbnZhc0RhdGFXaXRoUG9ydGFscyhjYW52YXMsIGRhdGEpXHJcbiAgICAgICAgICAudGhlbigobmV3RGF0YTogQ2FudmFzRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBTa2lwIGlmIHRoZSBkYXRhIGRpZG4ndCBjaGFuZ2VcclxuICAgICAgICAgICAgaWYgKG5ld0RhdGEubm9kZXMubGVuZ3RoID09PSBkYXRhLm5vZGVzLmxlbmd0aCAmJiBuZXdEYXRhLmVkZ2VzLmxlbmd0aCA9PT0gZGF0YS5lZGdlcy5sZW5ndGgpIHJldHVyblxyXG4gICAgICAgICAgICBzZXREYXRhKG5ld0RhdGEpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICApKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVQb3B1cE1lbnUoY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGlmIChjYW52YXMucmVhZG9ubHkpIHJldHVyblxyXG5cclxuICAgIC8vIE9ubHkgc2VhcmNoIGZvciB2YWxpZCBub2Rlc1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRGaWxlTm9kZXMgPSBjYW52YXMuZ2V0U2VsZWN0aW9uRGF0YSgpLm5vZGVzLm1hcChub2RlRGF0YSA9PiB7XHJcbiAgICAgIGNvbnN0IG5vZGUgPSBjYW52YXMubm9kZXMuZ2V0KG5vZGVEYXRhLmlkKVxyXG4gICAgICBpZiAoIW5vZGUpIHJldHVybiBudWxsXHJcblxyXG4gICAgICBpZiAobm9kZURhdGEudHlwZSAhPT0gJ2ZpbGUnKSByZXR1cm4gbnVsbFxyXG4gICAgICBpZiAobm9kZS5maWxlPy5leHRlbnNpb24gPT09ICdjYW52YXMnKSByZXR1cm4gbm9kZVxyXG4gICAgICBcclxuICAgICAgLy8gQ2xvc2UgcG9ydGFsIG9mIG5vbi1jYW52YXMgZmlsZVxyXG4gICAgICBpZiAobm9kZURhdGEucG9ydGFsVG9GaWxlKSB0aGlzLnNldFBvcnRhbE9wZW4oY2FudmFzLCBub2RlLCBmYWxzZSlcclxuXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9KS5maWx0ZXIobm9kZSA9PiBub2RlICE9PSBudWxsKSBhcyBDYW52YXNOb2RlW11cclxuICAgIFxyXG4gICAgaWYgKHNlbGVjdGVkRmlsZU5vZGVzLmxlbmd0aCAhPT0gMSkgcmV0dXJuXHJcblxyXG4gICAgY29uc3QgcG9ydGFsTm9kZSA9IHNlbGVjdGVkRmlsZU5vZGVzWzBdXHJcbiAgICBjb25zdCBwb3J0YWxOb2RlRGF0YSA9IHBvcnRhbE5vZGUuZ2V0RGF0YSgpXHJcblxyXG4gICAgLy8gSWYgZmlsZSBjaGFuZ2VkXHJcbiAgICBpZiAocG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlICYmIHBvcnRhbE5vZGVEYXRhLmZpbGUgIT09IHBvcnRhbE5vZGVEYXRhLnBvcnRhbFRvRmlsZSkge1xyXG4gICAgICB0aGlzLnNldFBvcnRhbE9wZW4oY2FudmFzLCBwb3J0YWxOb2RlLCB0cnVlKVxyXG4gICAgfVxyXG5cclxuICAgIENhbnZhc0hlbHBlci5hZGRQb3B1cE1lbnVPcHRpb24oXHJcbiAgICAgIGNhbnZhcyxcclxuICAgICAgQ2FudmFzSGVscGVyLmNyZWF0ZVBvcHVwTWVudU9wdGlvbih7XHJcbiAgICAgICAgaWQ6ICd0b2dnbGUtcG9ydGFsJyxcclxuICAgICAgICBsYWJlbDogcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlID8gJ0Nsb3NlIHBvcnRhbCcgOiAnT3BlbiBwb3J0YWwnLFxyXG4gICAgICAgIGljb246IHBvcnRhbE5vZGVEYXRhLnBvcnRhbFRvRmlsZSA/ICdkb29yLW9wZW4nIDogJ2Rvb3ItY2xvc2VkJyxcclxuICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5zZXRQb3J0YWxPcGVuKGNhbnZhcywgcG9ydGFsTm9kZSwgcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlID09PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZVBvcHVwTWVudShjYW52YXMpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXRQb3J0YWxPcGVuKGNhbnZhczogQ2FudmFzLCBwb3J0YWxOb2RlOiBDYW52YXNOb2RlLCBvcGVuOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCBwb3J0YWxOb2RlRGF0YSA9IHBvcnRhbE5vZGUuZ2V0RGF0YSgpXHJcbiAgICBjYW52YXMuc2V0Tm9kZURhdGEocG9ydGFsTm9kZSwgJ3BvcnRhbFRvRmlsZScsIG9wZW4gPyBwb3J0YWxOb2RlRGF0YS5maWxlIDogdW5kZWZpbmVkKVxyXG5cclxuICAgIC8vIFVwZGF0ZSB3aG9sZSBjYW52YXMgZGF0YVxyXG4gICAgY2FudmFzLnNldERhdGEoY2FudmFzLmdldERhdGEoKSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25Ob2RlUmVtb3ZlZChjYW52YXM6IENhbnZhcywgbm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG4gICAgaWYgKG5vZGVEYXRhLnR5cGUgIT09ICdmaWxlJyB8fCAhbm9kZURhdGEucG9ydGFsVG9GaWxlKSByZXR1cm5cclxuXHJcbiAgICAvLyBSZW1vdmUgbmVzdGVkIG5vZGVzIGFuZCBlZGdlc1xyXG4gICAgT2JqZWN0LmtleXMobm9kZURhdGEucG9ydGFsSWRNYXBzPy5ub2RlSWRNYXAgPz8ge30pLm1hcChyZWZOb2RlSWQgPT4gY2FudmFzLm5vZGVzLmdldChyZWZOb2RlSWQpKVxyXG4gICAgICAuZmlsdGVyKG5vZGUgPT4gbm9kZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAuZm9yRWFjaChub2RlID0+IGNhbnZhcy5yZW1vdmVOb2RlKG5vZGUhKSlcclxuXHJcbiAgICBPYmplY3Qua2V5cyhub2RlRGF0YS5wb3J0YWxJZE1hcHM/LmVkZ2VJZE1hcCA/PyB7fSkubWFwKHJlZkVkZ2VJZCA9PiBjYW52YXMuZWRnZXMuZ2V0KHJlZkVkZ2VJZCkpXHJcbiAgICAgIC5maWx0ZXIoZWRnZSA9PiBlZGdlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgIC5mb3JFYWNoKGVkZ2UgPT4gY2FudmFzLnJlbW92ZUVkZ2UoZWRnZSEpKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbkVkZ2VDaGFuZ2VkKF9jYW52YXM6IENhbnZhcywgZWRnZTogQ2FudmFzRWRnZSkge1xyXG4gICAgY29uc3QgaXNVbnNhdmVkID0gKGVkZ2UuZnJvbS5ub2RlICE9PSB1bmRlZmluZWQgJiYgZWRnZS50by5ub2RlICE9PSB1bmRlZmluZWQpICYmIC8vIEVkZ2Ugbm90IGZ1bGx5IGNvbm5lY3RlZFxyXG4gICAgICAoZWRnZS5mcm9tLm5vZGUuZ2V0RGF0YSgpLnBvcnRhbElkICE9PSB1bmRlZmluZWQgJiYgZWRnZS50by5ub2RlLmdldERhdGEoKS5wb3J0YWxJZCAhPT0gdW5kZWZpbmVkKSAmJiAvLyBCb3RoIG5vZGVzIGFyZSBmcm9tIHBvcnRhbFxyXG4gICAgICBlZGdlLmdldERhdGEoKS5wb3J0YWxJZCA9PT0gdW5kZWZpbmVkIC8vIEVkZ2UgaXMgbm90IGZyb20gcG9ydGFsXHJcblxyXG4gICAgZWRnZS5zZXREYXRhKHtcclxuICAgICAgLi4uZWRnZS5nZXREYXRhKCksIFxyXG4gICAgICBpc1Vuc2F2ZWQ6IGlzVW5zYXZlZCA/IHRydWUgOiB1bmRlZmluZWRcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uU2VsZWN0aW9uQ2hhbmdlZChjYW52YXM6IENhbnZhcywgb2xkU2VsZWN0aW9uOiBTZXQ8Q2FudmFzTm9kZXxDYW52YXNFZGdlPiwgdXBkYXRlU2VsZWN0aW9uOiAodXBkYXRlOiAoKSA9PiB2b2lkKSA9PiB2b2lkKSB7XHJcbiAgICAvLyBVbnNlbGVjdCBub2RlcyBmcm9tIHBvcnRhbHNcclxuICAgIHVwZGF0ZVNlbGVjdGlvbigoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRTZWxlY3Rpb24gPSBBcnJheS5mcm9tKGNhbnZhcy5zZWxlY3Rpb24pXHJcbiAgICAgICAgLmZpbHRlcihub2RlID0+IG5vZGUuZ2V0RGF0YSgpLnBvcnRhbElkID09PSB1bmRlZmluZWQpXHJcbiAgICAgIGNhbnZhcy5zZWxlY3Rpb24gPSBuZXcgU2V0KHVwZGF0ZWRTZWxlY3Rpb24pXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIE1vdmUgcHJldmlvdXNseSBzZWxlY3RlZCBwb3J0YWxzIHRvIHRoZSBiYWNrXHJcbiAgICBjb25zdCBwcmV2aW91c2x5U2VsZWN0ZWRQb3J0YWxOb2Rlc0lkcyA9IEFycmF5LmZyb20ob2xkU2VsZWN0aW9uKVxyXG4gICAgICAuZmlsdGVyKG5vZGUgPT4gKG5vZGUuZ2V0RGF0YSgpIGFzIGFueSkucG9ydGFsVG9GaWxlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgIC5mbGF0TWFwKG5vZGUgPT4ge1xyXG4gICAgICAgIGNvbnN0IHBvcnRhbE5vZGVEYXRhID0gbm9kZS5nZXREYXRhKClcclxuICAgICAgICBjb25zdCBuZXN0ZWRQb3J0YWxzSWRzID0gdGhpcy5nZXROZXN0ZWRQb3J0YWxzSWRzKGNhbnZhcywgcG9ydGFsTm9kZURhdGEuaWQpXHJcblxyXG4gICAgICAgIHJldHVybiBbcG9ydGFsTm9kZURhdGEuaWQsIC4uLm5lc3RlZFBvcnRhbHNJZHNdXHJcbiAgICAgIH0pXHJcblxyXG4gICAgZm9yIChjb25zdCBub2RlIG9mIGNhbnZhcy5ub2Rlcy52YWx1ZXMoKSkge1xyXG4gICAgICBjb25zdCBub2RlRGF0YSA9IG5vZGUuZ2V0RGF0YSgpXHJcblxyXG4gICAgICAvLyBOb3QgZnJvbSB1bnNlbGVjdGVkIHBvcnRhbFxyXG4gICAgICBpZiAobm9kZURhdGEucG9ydGFsSWQgPT09IHVuZGVmaW5lZCB8fCAhcHJldmlvdXNseVNlbGVjdGVkUG9ydGFsTm9kZXNJZHMuaW5jbHVkZXMobm9kZURhdGEucG9ydGFsSWQpKSBjb250aW51ZVxyXG5cclxuICAgICAgLy8gTW92ZSB0byBmcm9udFxyXG4gICAgICBub2RlLnVwZGF0ZVpJbmRleCgpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldE5lc3RlZFBvcnRhbHNJZHMoY2FudmFzOiBDYW52YXMsIHBvcnRhbElkOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBuZXN0ZWRQb3J0YWxzSWRzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG4gICAgZm9yIChjb25zdCBub2RlIG9mIGNhbnZhcy5ub2Rlcy52YWx1ZXMoKSkge1xyXG4gICAgICBjb25zdCBub2RlRGF0YSA9IG5vZGUuZ2V0RGF0YSgpXHJcblxyXG4gICAgICBpZiAobm9kZURhdGEucG9ydGFsSWQgPT09IHBvcnRhbElkKSB7XHJcbiAgICAgICAgbmVzdGVkUG9ydGFsc0lkcy5wdXNoKG5vZGVEYXRhLmlkKVxyXG4gICAgICAgIG5lc3RlZFBvcnRhbHNJZHMucHVzaCguLi50aGlzLmdldE5lc3RlZFBvcnRhbHNJZHMoY2FudmFzLCBub2RlRGF0YS5pZCkpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmVzdGVkUG9ydGFsc0lkc1xyXG4gIH1cclxuXHJcbiAgcmVzdG9yZU9iamVjdFNuYXBwaW5nU3RhdGU6ICgpID0+IHZvaWRcclxuICBwcml2YXRlIG9uRHJhZ2dpbmdTdGF0ZUNoYW5nZWQoY2FudmFzOiBDYW52YXMsIHN0YXJ0ZWREcmFnZ2luZzogYm9vbGVhbikge1xyXG4gICAgLy8gSWYgbm8gb3BlbiBwb3J0YWwgZ2V0cyBkcmFnZ2VkLCByZXR1cm5cclxuICAgIGlmICghY2FudmFzLmdldFNlbGVjdGlvbkRhdGEoKS5ub2Rlcy5zb21lKG5vZGUgPT4gbm9kZS50eXBlID09PSAnZmlsZScgJiYgbm9kZS5wb3J0YWxUb0ZpbGUpKSByZXR1cm5cclxuXHJcbiAgICAvLyBEaXNhYmxlIG9iamVjdCBzbmFwcGluZyB0byBmaXggc2VsZi1hbGlnbmluZ1xyXG4gICAgaWYgKHN0YXJ0ZWREcmFnZ2luZykge1xyXG4gICAgICBjb25zdCBvYmplY3RTbmFwcGluZ0VuYWJsZWQgPSBjYW52YXMub3B0aW9ucy5zbmFwVG9PYmplY3RzXHJcbiAgICAgIHRoaXMucmVzdG9yZU9iamVjdFNuYXBwaW5nU3RhdGUgPSAoKSA9PiBjYW52YXMudG9nZ2xlT2JqZWN0U25hcHBpbmcob2JqZWN0U25hcHBpbmdFbmFibGVkKVxyXG5cclxuICAgICAgaWYgKG9iamVjdFNuYXBwaW5nRW5hYmxlZCkgY2FudmFzLnRvZ2dsZU9iamVjdFNuYXBwaW5nKGZhbHNlKVxyXG4gICAgfSBlbHNlIHRoaXMucmVzdG9yZU9iamVjdFNuYXBwaW5nU3RhdGU/LigpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uTm9kZU1vdmVkKGNhbnZhczogQ2FudmFzLCBub2RlOiBDYW52YXNOb2RlKSB7XHJcbiAgICBjb25zdCBub2RlRGF0YSA9IG5vZGUuZ2V0RGF0YSgpXHJcbiAgICBpZiAobm9kZURhdGEudHlwZSAhPT0gJ2ZpbGUnIHx8ICFub2RlRGF0YS5wb3J0YWxUb0ZpbGUpIHJldHVyblxyXG5cclxuICAgIHRoaXMub25PcGVuUG9ydGFsTW92ZWQoY2FudmFzLCBub2RlKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbk9wZW5Qb3J0YWxNb3ZlZChjYW52YXM6IENhbnZhcywgcG9ydGFsTm9kZTogQ2FudmFzTm9kZSkge1xyXG4gICAgbGV0IHBvcnRhbE5vZGVEYXRhID0gcG9ydGFsTm9kZS5nZXREYXRhKClcclxuXHJcbiAgICAvLyBVcGRhdGUgbmVzdGVkIG5vZGVzIHBvc2l0aW9uc1xyXG4gICAgY29uc3QgbmVzdGVkTm9kZXNJZE1hcCA9IHBvcnRhbE5vZGUuZ2V0RGF0YSgpLnBvcnRhbElkTWFwcz8ubm9kZUlkTWFwXHJcbiAgICBpZiAoIW5lc3RlZE5vZGVzSWRNYXApIHJldHVyblxyXG5cclxuICAgIGNvbnN0IG5lc3RlZE5vZGVzID0gT2JqZWN0LmtleXMobmVzdGVkTm9kZXNJZE1hcCkubWFwKHJlZk5vZGVJZCA9PiBjYW52YXMubm9kZXMuZ2V0KHJlZk5vZGVJZCkpXHJcbiAgICAgIC5maWx0ZXIobm9kZSA9PiBub2RlICE9PSB1bmRlZmluZWQpIGFzIENhbnZhc05vZGVbXVxyXG4gICAgY29uc3Qgc291cmNlQkJveCA9IENhbnZhc0hlbHBlci5nZXRCQm94KG5lc3RlZE5vZGVzKVxyXG5cclxuICAgIC8vIFJlc2l6ZSBwb3J0YWxcclxuICAgIGNvbnN0IHRhcmdldFNpemUgPSB0aGlzLmdldFBvcnRhbFNpemUoc291cmNlQkJveClcclxuICAgIGlmIChwb3J0YWxOb2RlRGF0YS53aWR0aCAhPT0gdGFyZ2V0U2l6ZS53aWR0aCB8fCBwb3J0YWxOb2RlRGF0YS5oZWlnaHQgIT09IHRhcmdldFNpemUuaGVpZ2h0KSB7XHJcbiAgICAgIHBvcnRhbE5vZGUuc2V0RGF0YSh7XHJcbiAgICAgICAgLi4ucG9ydGFsTm9kZURhdGEsXHJcbiAgICAgICAgd2lkdGg6IHRhcmdldFNpemUud2lkdGgsXHJcbiAgICAgICAgaGVpZ2h0OiB0YXJnZXRTaXplLmhlaWdodFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTW92ZSBuZXN0ZWQgbm9kZXNcclxuICAgIGNvbnN0IHBvcnRhbE9mZnNldCA9IHtcclxuICAgICAgeDogcG9ydGFsTm9kZURhdGEueCAtIHNvdXJjZUJCb3gubWluWCArIFBPUlRBTF9QQURESU5HLFxyXG4gICAgICB5OiBwb3J0YWxOb2RlRGF0YS55IC0gc291cmNlQkJveC5taW5ZICsgUE9SVEFMX1BBRERJTkdcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGNvbnN0IG5lc3RlZE5vZGUgb2YgbmVzdGVkTm9kZXMpIHtcclxuICAgICAgY29uc3QgbmVzdGVkTm9kZURhdGEgPSBuZXN0ZWROb2RlLmdldERhdGEoKVxyXG5cclxuICAgICAgbmVzdGVkTm9kZS5zZXREYXRhKHtcclxuICAgICAgICAuLi5uZXN0ZWROb2RlRGF0YSxcclxuICAgICAgICB4OiBuZXN0ZWROb2RlRGF0YS54ICsgcG9ydGFsT2Zmc2V0LngsXHJcbiAgICAgICAgeTogbmVzdGVkTm9kZURhdGEueSArIHBvcnRhbE9mZnNldC55XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlbW92ZVBvcnRhbENhbnZhc0RhdGEoX2NhbnZhczogQ2FudmFzLCBkYXRhOiBDYW52YXNEYXRhKSB7XHJcbiAgICBkYXRhLmVkZ2VzID0gZGF0YS5lZGdlcy5maWx0ZXIoZWRnZURhdGEgPT4ge1xyXG4gICAgICBpZiAoZWRnZURhdGEucG9ydGFsSWQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlXHJcblxyXG4gICAgICBjb25zdCBmcm9tTm9kZURhdGEgPSBkYXRhLm5vZGVzLmZpbmQobm9kZURhdGEgPT4gbm9kZURhdGEuaWQgPT09IGVkZ2VEYXRhLmZyb21Ob2RlKVxyXG4gICAgICBjb25zdCB0b05vZGVEYXRhID0gZGF0YS5ub2Rlcy5maW5kKG5vZGVEYXRhID0+IG5vZGVEYXRhLmlkID09PSBlZGdlRGF0YS50b05vZGUpXHJcbiAgICAgIGlmICghZnJvbU5vZGVEYXRhIHx8ICF0b05vZGVEYXRhKSByZXR1cm4gdHJ1ZVxyXG5cclxuICAgICAgaWYgKGZyb21Ob2RlRGF0YS5wb3J0YWxJZCA9PT0gdW5kZWZpbmVkICYmIHRvTm9kZURhdGEucG9ydGFsSWQgPT09IHVuZGVmaW5lZCkgeyAvLyBOb3JtYWwgZWRnZVxyXG4gICAgICAgIHJldHVybiB0cnVlIFxyXG4gICAgICB9IGVsc2UgaWYgKGZyb21Ob2RlRGF0YS5wb3J0YWxJZCAhPT0gdW5kZWZpbmVkICYmIHRvTm9kZURhdGEucG9ydGFsSWQgIT09IHVuZGVmaW5lZCkgeyAvLyBDb21wbGV0ZWx5IGZyb20gcG9ydGFsXHJcbiAgICAgICAgLy8gU2F2ZSB0byBwb3J0YWwgZmlsZT8gT1IgZGVsZXRlIVxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICB9IGVsc2UgeyAvLyBQYXJ0aWFsbHkgZnJvbSBwb3J0YWxcclxuICAgICAgICBjb25zdCBmcm9tUG9ydGFsTm9kZURhdGEgPSBmcm9tTm9kZURhdGEucG9ydGFsSWQgIT09IHVuZGVmaW5lZCA/IGZyb21Ob2RlRGF0YSA6IHRvTm9kZURhdGFcclxuICAgICAgICBjb25zdCBub3RGcm9tUG9ydGFsTm9kZURhdGEgPSBmcm9tTm9kZURhdGEucG9ydGFsSWQgIT09IHVuZGVmaW5lZCA/IHRvTm9kZURhdGEgOiBmcm9tTm9kZURhdGFcclxuXHJcbiAgICAgICAgbm90RnJvbVBvcnRhbE5vZGVEYXRhLmVkZ2VzVG9Ob2RlRnJvbVBvcnRhbCA9IG5vdEZyb21Qb3J0YWxOb2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwgPz8ge31cclxuICAgICAgICBub3RGcm9tUG9ydGFsTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsW2Zyb21Qb3J0YWxOb2RlRGF0YS5wb3J0YWxJZCFdID0gbm90RnJvbVBvcnRhbE5vZGVEYXRhLmVkZ2VzVG9Ob2RlRnJvbVBvcnRhbFtmcm9tUG9ydGFsTm9kZURhdGEucG9ydGFsSWQhXSA/PyBbXVxyXG4gICAgICAgIG5vdEZyb21Qb3J0YWxOb2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWxbZnJvbVBvcnRhbE5vZGVEYXRhLnBvcnRhbElkIV0ucHVzaChlZGdlRGF0YSlcclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgZGF0YS5ub2RlcyA9IGRhdGEubm9kZXMuZmlsdGVyKG5vZGVEYXRhID0+IG5vZGVEYXRhLnBvcnRhbElkID09PSB1bmRlZmluZWQpXHJcblxyXG4gICAgZm9yIChjb25zdCBwb3J0YWxOb2RlRGF0YSBvZiBkYXRhLm5vZGVzKSB7XHJcbiAgICAgIGlmIChwb3J0YWxOb2RlRGF0YS50eXBlICE9PSAnZmlsZScpIGNvbnRpbnVlXHJcblxyXG4gICAgICAvLyBSZXNldCBwb3J0YWwgc2l6ZVxyXG4gICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ21haW50YWluQ2xvc2VkUG9ydGFsU2l6ZScpKSB7XHJcbiAgICAgICAgcG9ydGFsTm9kZURhdGEud2lkdGggPSBwb3J0YWxOb2RlRGF0YS5jbG9zZWRQb3J0YWxXaWR0aCA/PyBwb3J0YWxOb2RlRGF0YS53aWR0aFxyXG4gICAgICAgIHBvcnRhbE5vZGVEYXRhLmhlaWdodCA9IHBvcnRhbE5vZGVEYXRhLmNsb3NlZFBvcnRhbEhlaWdodCA/PyBwb3J0YWxOb2RlRGF0YS5oZWlnaHRcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gUmVtb3ZlIHJlZmVyZW5jZXMgdG8gcG9ydGFsIG5vZGVzIGFuZCBlZGdlc1xyXG4gICAgICBkZWxldGUgcG9ydGFsTm9kZURhdGEuY2xvc2VkUG9ydGFsV2lkdGhcclxuICAgICAgZGVsZXRlIHBvcnRhbE5vZGVEYXRhLmNsb3NlZFBvcnRhbEhlaWdodFxyXG4gICAgICBkZWxldGUgcG9ydGFsTm9kZURhdGEucG9ydGFsSWRNYXBzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdldENhbnZhc0RhdGFXaXRoUG9ydGFscyhjYW52YXM6IENhbnZhcywgZGF0YVJlZjogQ2FudmFzRGF0YSk6IFByb21pc2U8Q2FudmFzRGF0YT4ge1xyXG4gICAgLy8gRGVlcCBjb3B5IGRhdGEgLSBJZiBhbm90aGVyIGZpbGUgZ2V0cyBvcGVuZWQgaW4gdGhlIHNhbWUgdmlldywgdGhlIGRhdGEgd291bGQgZ2V0IG92ZXJ3cml0dGVuXHJcbiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhUmVmKSkgYXMgQ2FudmFzRGF0YVxyXG5cclxuICAgIC8vIE9wZW4gcG9ydGFsc1xyXG4gICAgY29uc3QgYWRkZWREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwoZGF0YS5ub2Rlcy5tYXAobm9kZURhdGEgPT4gdGhpcy50cnlPcGVuUG9ydGFsKGNhbnZhcywgbm9kZURhdGEpKSlcclxuICAgIGZvciAoY29uc3QgbmV3RGF0YSBvZiBhZGRlZERhdGEpIHtcclxuICAgICAgZGF0YS5ub2Rlcy5wdXNoKC4uLm5ld0RhdGEubm9kZXMpXHJcbiAgICAgIGRhdGEuZWRnZXMucHVzaCguLi5uZXdEYXRhLmVkZ2VzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBjcm9zcy1wb3J0YWwgZWRnZXNcclxuICAgIGZvciAoY29uc3Qgb3JpZ2luTm9kZURhdGEgb2YgZGF0YS5ub2Rlcykge1xyXG4gICAgICBpZiAob3JpZ2luTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsID09PSB1bmRlZmluZWQpIGNvbnRpbnVlXHJcblxyXG4gICAgICBmb3IgKGNvbnN0IFtyZWxhdGl2ZVBvcnRhbElkLCBlZGdlc10gb2YgT2JqZWN0LmVudHJpZXMob3JpZ2luTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsKSkge1xyXG4gICAgICAgIGNvbnN0IGlkUHJlZml4ID0gb3JpZ2luTm9kZURhdGEucG9ydGFsSWQgPyBgJHtvcmlnaW5Ob2RlRGF0YS5wb3J0YWxJZH0tYCA6ICcnXHJcblxyXG4gICAgICAgIGNvbnN0IHBvcnRhbElkID0gYCR7aWRQcmVmaXh9JHtyZWxhdGl2ZVBvcnRhbElkfWBcclxuICAgICAgICBjb25zdCB0YXJnZXRQb3J0YWxEYXRhID0gZGF0YS5ub2Rlcy5maW5kKG5vZGVEYXRhID0+IG5vZGVEYXRhLmlkID09PSBwb3J0YWxJZClcclxuXHJcbiAgICAgICAgLy8gSWYgdGFyZ2V0IHBvcnRhbCBpcyBkZWxldGVkLCByZW1vdmUgZWRnZXNcclxuICAgICAgICBpZiAoIXRhcmdldFBvcnRhbERhdGEpIHtcclxuICAgICAgICAgIGRlbGV0ZSBvcmlnaW5Ob2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwhW3BvcnRhbElkXVxyXG4gICAgICAgICAgY29udGludWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIElmIHBvcnRhbCBpcyBvcGVuLCBhZGQgZWRnZXNcclxuICAgICAgICBpZiAodGFyZ2V0UG9ydGFsRGF0YS5wb3J0YWxUb0ZpbGUpIHtcclxuICAgICAgICAgIC8vIFB1c2ggZWRnZXMgd2l0aCB1cGRhdGVkIGZyb20gYW5kIHRvIGlkc1xyXG4gICAgICAgICAgZGF0YS5lZGdlcy5wdXNoKC4uLmVkZ2VzLm1hcChlZGdlID0+ICh7XHJcbiAgICAgICAgICAgIC4uLmVkZ2UsXHJcbiAgICAgICAgICAgIHBvcnRhbElkOiBvcmlnaW5Ob2RlRGF0YS5wb3J0YWxJZCxcclxuICAgICAgICAgICAgZnJvbU5vZGU6IGAke2lkUHJlZml4fSR7ZWRnZS5mcm9tTm9kZX1gLFxyXG4gICAgICAgICAgICB0b05vZGU6IGAke2lkUHJlZml4fSR7ZWRnZS50b05vZGV9YFxyXG4gICAgICAgICAgfSkpKVxyXG5cclxuICAgICAgICAgIGRlbGV0ZSBvcmlnaW5Ob2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWwhW3BvcnRhbElkXVxyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3NNYW5hZ2VyLmdldFNldHRpbmcoJ3Nob3dFZGdlc0ludG9EaXNhYmxlZFBvcnRhbHMnKSkge1xyXG4gICAgICAgICAgLy8gSWYgcG9ydGFsIGlzIGNsb3NlZCwgYWRkIGFsdGVybmF0aXZlIGVkZ2VzIGRpcmVjdGx5IHRvIHBvcnRhbFxyXG4gICAgICAgICAgLy8gQnV0IGRvbid0IGRlbGV0ZSB0aGUgZWRnZXNcclxuXHJcbiAgICAgICAgICBkYXRhLmVkZ2VzLnB1c2goLi4uZWRnZXMubWFwKGVkZ2UgPT4ge1xyXG4gICAgICAgICAgICAvLyBXaGljaCBlbmQgaXMgZnJvbSBwb3J0YWw/XHJcbiAgICAgICAgICAgIGNvbnN0IGZyb21Ob2RlSWQgPSBgJHtpZFByZWZpeH0ke2VkZ2UuZnJvbU5vZGV9YFxyXG4gICAgICAgICAgICBjb25zdCBmcm9tTm9kZSA9IGRhdGEubm9kZXMuZmluZChub2RlRGF0YSA9PiBub2RlRGF0YS5pZCA9PT0gZnJvbU5vZGVJZClcclxuICAgICAgICAgICAgY29uc3QgdG9Ob2RlSWQgPSBgJHtpZFByZWZpeH0ke2VkZ2UudG9Ob2RlfWBcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgLi4uZWRnZSxcclxuICAgICAgICAgICAgICBmcm9tTm9kZTogZnJvbU5vZGUgPyBmcm9tTm9kZUlkIDogcG9ydGFsSWQsXHJcbiAgICAgICAgICAgICAgdG9Ob2RlOiBmcm9tTm9kZSA/IHBvcnRhbElkIDogdG9Ob2RlSWQsXHJcbiAgICAgICAgICAgICAgcG9ydGFsSWQ6IHBvcnRhbElkIC8vIE1hcmsgaXQgYXMgdGVtcG9yYXJ5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSWYgbm8gbW9yZSBlZGdlcywgZGVsZXRlIHRoZSBwcm9wZXJ0eVxyXG4gICAgICBpZiAoT2JqZWN0LmtleXMob3JpZ2luTm9kZURhdGEuZWRnZXNUb05vZGVGcm9tUG9ydGFsISkubGVuZ3RoID09PSAwKVxyXG4gICAgICAgIGRlbGV0ZSBvcmlnaW5Ob2RlRGF0YS5lZGdlc1RvTm9kZUZyb21Qb3J0YWxcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZGF0YVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyB0cnlPcGVuUG9ydGFsKGNhbnZhczogQ2FudmFzLCBwb3J0YWxOb2RlRGF0YTogQ2FudmFzTm9kZURhdGEpOiBQcm9taXNlPENhbnZhc0RhdGE+IHtcclxuICAgIGNvbnN0IGFkZGVkRGF0YTogQ2FudmFzRGF0YSA9IHsgbm9kZXM6IFtdLCBlZGdlczogW10gfVxyXG4gICAgaWYgKHBvcnRhbE5vZGVEYXRhLnR5cGUgIT09ICdmaWxlJyB8fCAhcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlKSByZXR1cm4gYWRkZWREYXRhXHJcblxyXG4gICAgLy8gVXBkYXRlIHBvcnRhbCBmaWxlXHJcbiAgICBwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgPSBwb3J0YWxOb2RlRGF0YS5maWxlXHJcblxyXG4gICAgLy8gRml4IHJlY3Vyc2l2ZSBwb3J0YWxzXHJcbiAgICBpZiAocG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlID09PSBjYW52YXMudmlldy5maWxlLnBhdGgpIHtcclxuICAgICAgcG9ydGFsTm9kZURhdGEucG9ydGFsVG9GaWxlID0gdW5kZWZpbmVkXHJcbiAgICAgIHJldHVybiBhZGRlZERhdGFcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwb3J0YWxGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwb3J0YWxOb2RlRGF0YS5maWxlISlcclxuICAgIGlmICghKHBvcnRhbEZpbGUgaW5zdGFuY2VvZiBURmlsZSkgfHwgcG9ydGFsRmlsZS5leHRlbnNpb24gIT09ICdjYW52YXMnKSB7XHJcbiAgICAgIHBvcnRhbE5vZGVEYXRhLnBvcnRhbFRvRmlsZSA9IHVuZGVmaW5lZFxyXG4gICAgICByZXR1cm4gYWRkZWREYXRhXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcG9ydGFsRmlsZURhdGEgPSBKU09OLnBhcnNlKGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKHBvcnRhbEZpbGUpKVxyXG4gICAgaWYgKCFwb3J0YWxGaWxlRGF0YSkge1xyXG4gICAgICBwb3J0YWxOb2RlRGF0YS5wb3J0YWxUb0ZpbGUgPSB1bmRlZmluZWRcclxuICAgICAgcmV0dXJuIGFkZGVkRGF0YVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBwb3J0YWwgbm9kZXMgYW5kIGVkZ2VzIGlkIG1hcFxyXG4gICAgcG9ydGFsTm9kZURhdGEucG9ydGFsSWRNYXBzID0ge1xyXG4gICAgICBub2RlSWRNYXA6IHt9LFxyXG4gICAgICBlZGdlSWRNYXA6IHt9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIG5lc3RlZCBub2RlIG9mZnNldFxyXG4gICAgY29uc3Qgc291cmNlTWluQ29vcmRpbmF0ZXMgPSBDYW52YXNIZWxwZXIuZ2V0QkJveChwb3J0YWxGaWxlRGF0YS5ub2RlcylcclxuICAgIGNvbnN0IHBvcnRhbE9mZnNldCA9IHtcclxuICAgICAgeDogcG9ydGFsTm9kZURhdGEueCAtIHNvdXJjZU1pbkNvb3JkaW5hdGVzLm1pblggKyBQT1JUQUxfUEFERElORyxcclxuICAgICAgeTogcG9ydGFsTm9kZURhdGEueSAtIHNvdXJjZU1pbkNvb3JkaW5hdGVzLm1pblkgKyBQT1JUQUxfUEFERElOR1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBub2RlcyBmcm9tIHBvcnRhbFxyXG4gICAgZm9yIChjb25zdCBub2RlRGF0YUZyb21Qb3J0YWwgb2YgcG9ydGFsRmlsZURhdGEubm9kZXMpIHtcclxuICAgICAgY29uc3QgcmVmTm9kZUlkID0gYCR7cG9ydGFsTm9kZURhdGEuaWR9LSR7bm9kZURhdGFGcm9tUG9ydGFsLmlkfWBcclxuICAgICAgcG9ydGFsTm9kZURhdGEucG9ydGFsSWRNYXBzLm5vZGVJZE1hcFtyZWZOb2RlSWRdID0gbm9kZURhdGFGcm9tUG9ydGFsLmlkXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBhZGRlZE5vZGUgPSB7XHJcbiAgICAgICAgLi4ubm9kZURhdGFGcm9tUG9ydGFsLFxyXG4gICAgICAgIGlkOiByZWZOb2RlSWQsXHJcbiAgICAgICAgeDogbm9kZURhdGFGcm9tUG9ydGFsLnggKyBwb3J0YWxPZmZzZXQueCxcclxuICAgICAgICB5OiBub2RlRGF0YUZyb21Qb3J0YWwueSArIHBvcnRhbE9mZnNldC55LFxyXG4gICAgICAgIHBvcnRhbElkOiBwb3J0YWxOb2RlRGF0YS5pZFxyXG4gICAgICB9XHJcblxyXG4gICAgICBhZGRlZERhdGEubm9kZXMucHVzaChhZGRlZE5vZGUpXHJcblxyXG4gICAgICBjb25zdCBuZXN0ZWROb2RlcyA9IGF3YWl0IHRoaXMudHJ5T3BlblBvcnRhbChjYW52YXMsIGFkZGVkTm9kZSlcclxuICAgICAgYWRkZWREYXRhLm5vZGVzLnB1c2goLi4ubmVzdGVkTm9kZXMubm9kZXMpXHJcbiAgICAgIGFkZGVkRGF0YS5lZGdlcy5wdXNoKC4uLm5lc3RlZE5vZGVzLmVkZ2VzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBlZGdlcyBmcm9tIHBvcnRhbFxyXG4gICAgZm9yIChjb25zdCBlZGdlRGF0YUZyb21Qb3J0YWwgb2YgcG9ydGFsRmlsZURhdGEuZWRnZXMpIHtcclxuICAgICAgY29uc3QgcmVmRWRnZUlkID0gYCR7cG9ydGFsTm9kZURhdGEuaWR9LSR7ZWRnZURhdGFGcm9tUG9ydGFsLmlkfWBcclxuICAgICAgcG9ydGFsTm9kZURhdGEucG9ydGFsSWRNYXBzLmVkZ2VJZE1hcFtyZWZFZGdlSWRdID0gZWRnZURhdGFGcm9tUG9ydGFsLmlkXHJcblxyXG4gICAgICBjb25zdCBmcm9tUmVmTm9kZSA9IE9iamVjdC5lbnRyaWVzKHBvcnRhbE5vZGVEYXRhLnBvcnRhbElkTWFwcy5ub2RlSWRNYXApXHJcbiAgICAgICAgLmZpbmQoKFtfcmVmTm9kZUlkLCBub2RlSWRdKSA9PiBub2RlSWQgPT09IGVkZ2VEYXRhRnJvbVBvcnRhbC5mcm9tTm9kZSk/LlswXVxyXG4gICAgICBjb25zdCB0b1JlZk5vZGUgPSBPYmplY3QuZW50cmllcyhwb3J0YWxOb2RlRGF0YS5wb3J0YWxJZE1hcHMubm9kZUlkTWFwKVxyXG4gICAgICAgIC5maW5kKChbX3JlZk5vZGVJZCwgbm9kZUlkXSkgPT4gbm9kZUlkID09PSBlZGdlRGF0YUZyb21Qb3J0YWwudG9Ob2RlKT8uWzBdXHJcblxyXG4gICAgICBhZGRlZERhdGEuZWRnZXMucHVzaCh7XHJcbiAgICAgICAgLi4uZWRnZURhdGFGcm9tUG9ydGFsLFxyXG4gICAgICAgIGlkOiByZWZFZGdlSWQsXHJcbiAgICAgICAgZnJvbU5vZGU6IGZyb21SZWZOb2RlLFxyXG4gICAgICAgIHRvTm9kZTogdG9SZWZOb2RlLFxyXG4gICAgICAgIHBvcnRhbElkOiBwb3J0YWxOb2RlRGF0YS5pZFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlc2l6ZSBwb3J0YWxcclxuICAgIGNvbnN0IG5lc3RlZE5vZGVzQkJveCA9IENhbnZhc0hlbHBlci5nZXRCQm94KGFkZGVkRGF0YS5ub2RlcylcclxuICAgIGNvbnN0IHRhcmdldFNpemUgPSB0aGlzLmdldFBvcnRhbFNpemUobmVzdGVkTm9kZXNCQm94KVxyXG5cclxuICAgIC8vIFNhdmUgY2xvc2VkIHBvcnRhbCBzaXplXHJcbiAgICBwb3J0YWxOb2RlRGF0YS5jbG9zZWRQb3J0YWxXaWR0aCA9IHBvcnRhbE5vZGVEYXRhLndpZHRoXHJcbiAgICBwb3J0YWxOb2RlRGF0YS5jbG9zZWRQb3J0YWxIZWlnaHQgPSBwb3J0YWxOb2RlRGF0YS5oZWlnaHRcclxuXHJcbiAgICAvLyBTZXQgb3BlbiBwb3J0YWwgc2l6ZVxyXG4gICAgcG9ydGFsTm9kZURhdGEud2lkdGggPSB0YXJnZXRTaXplLndpZHRoXHJcbiAgICBwb3J0YWxOb2RlRGF0YS5oZWlnaHQgPSB0YXJnZXRTaXplLmhlaWdodFxyXG5cclxuICAgIHJldHVybiBhZGRlZERhdGFcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UG9ydGFsU2l6ZShzb3VyY2VCQm94OiBCQm94KSB7XHJcbiAgICBjb25zdCBzb3VyY2VTaXplID0ge1xyXG4gICAgICB3aWR0aDogc291cmNlQkJveC5tYXhYIC0gc291cmNlQkJveC5taW5YLFxyXG4gICAgICBoZWlnaHQ6IHNvdXJjZUJCb3gubWF4WSAtIHNvdXJjZUJCb3gubWluWVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRhcmdldFNpemUgPSB7XHJcbiAgICAgIHdpZHRoOiBNYXRoLm1heChzb3VyY2VTaXplLndpZHRoICsgUE9SVEFMX1BBRERJTkcgKiAyLCBNSU5fT1BFTl9QT1JUQUxfU0laRS53aWR0aCksXHJcbiAgICAgIGhlaWdodDogTWF0aC5tYXgoc291cmNlU2l6ZS5oZWlnaHQgKyBQT1JUQUxfUEFERElORyAqIDIsIE1JTl9PUEVOX1BPUlRBTF9TSVpFLmhlaWdodClcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIU51bWJlci5pc0Zpbml0ZSh0YXJnZXRTaXplLndpZHRoKSkgdGFyZ2V0U2l6ZS53aWR0aCA9IE1JTl9PUEVOX1BPUlRBTF9TSVpFLndpZHRoXHJcbiAgICBpZiAoIU51bWJlci5pc0Zpbml0ZSh0YXJnZXRTaXplLmhlaWdodCkpIHRhcmdldFNpemUuaGVpZ2h0ID0gTUlOX09QRU5fUE9SVEFMX1NJWkUuaGVpZ2h0XHJcblxyXG4gICAgcmV0dXJuIHRhcmdldFNpemVcclxuICB9XHJcbn0iLCAiaW1wb3J0IHsgYWRkSWNvbiB9IGZyb20gXCJvYnNpZGlhblwiXHJcblxyXG5jb25zdCBDVVNUT01fSUNPTlMgPSB7XHJcbiAgJ292YWwnOiBgPHJlY3Qgcng9XCIzMS4yNVwiIGhlaWdodD1cIjYyLjVcIiB3aWR0aD1cIjkzLjc1XCIgeT1cIjE4Ljc1XCIgeD1cIjMuMTI1XCIgc3Ryb2tlLXdpZHRoPVwiOC4zMzNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBmaWxsPVwidHJhbnNwYXJlbnRcIi8+YCxcclxuICAncGFyYWxsZWxvZ3JhbSc6IGA8cmVjdCB0cmFuc2Zvcm09XCJza2V3WCgtMjApXCIgcng9XCI1XCIgaGVpZ2h0PVwiNTBcIiB3aWR0aD1cIjcwXCIgeT1cIjI1XCIgeD1cIjM1XCIgc3Ryb2tlLXdpZHRoPVwiOC4zMzNcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBmaWxsPVwidHJhbnNwYXJlbnRcIi8+YCxcclxuICAncHJlZGVmaW5lZC1wcm9jZXNzJzogYFxyXG4gICAgPGcgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJub25lXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCI+XHJcbiAgICAgIDxwYXRoIGQ9XCJNIDQuOTk5Njg3IDMgTCAxOS4wMDAzMTIgMyBDIDIwLjEwNDY4OCAzIDIxIDMuODk1MzEyIDIxIDQuOTk5Njg3IEwgMjEgMTkuMDAwMzEyIEMgMjEgMjAuMTA0Njg4IDIwLjEwNDY4OCAyMSAxOS4wMDAzMTIgMjEgTCA0Ljk5OTY4NyAyMSBDIDMuODk1MzEyIDIxIDMgMjAuMTA0Njg4IDMgMTkuMDAwMzEyIEwgMyA0Ljk5OTY4NyBDIDMgMy44OTUzMTIgMy44OTUzMTIgMyA0Ljk5OTY4NyAzIFogTSA0Ljk5OTY4NyAzIFwiLz5cclxuICAgICAgPHBhdGggZD1cIk0gNyAzIEwgNyAyMSBcIi8+XHJcbiAgICAgIDxwYXRoIGQ9XCJNIDE3IDMgTCAxNyAyMSBcIi8+XHJcbiAgICA8L2c+XHJcbiAgYCxcclxuICAnZG9jdW1lbnQnOiBgPHBhdGggdHJhbnNmb3JtPVwidHJhbnNsYXRlKDAsIDUpXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgZmlsbD1cIm5vbmVcIiBzdHJva2Utd2lkdGg9XCI4LjMzM1wiIGQ9XCJNODMuNzUgMjVDODUuODIgMjUgODcuNSAyNi42OCA4Ny41IDI4Ljc1TDg3LjUgNjQuMzc1UTY4Ljc1IDU0LjI1IDUwIDY0LjM3NSAzMS4yNSA3NC41IDEyLjUgNjQuMzc1TDEyLjUgMzAuNjI1IDEyLjUgMjguNzVDMTIuNSAyNi42OCAxNC4xOCAyNSAxNi4yNSAyNVpcIi8+YCxcclxuICAnZGF0YWJhc2Utc2hhcGUnOiBgXHJcbiAgICA8ZyB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoMjAsIDIwKVwiIHN0cm9rZS13aWR0aD1cIjguMzMzXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgZmlsbD1cIm5vbmVcIj5cclxuICAgICAgPHBhdGggZD1cIk0gMSA1MSBMIDEgMTEgQyAxIDUuNDggMTQuNDMgMSAzMSAxIEMgNDcuNTcgMSA2MSA1LjQ4IDYxIDExIEwgNjEgNTEgQyA2MSA1Ni41MiA0Ny41NyA2MSAzMSA2MSBDIDE0LjQzIDYxIDEgNTYuNTIgMSA1MSBaXCIvPlxyXG4gICAgICA8cGF0aCBkPVwiTSAxIDExIEMgMSAxNi41MiAxNC40MyAyMSAzMSAyMSBDIDQ3LjU3IDIxIDYxIDE2LjUyIDYxIDExXCIvPlxyXG4gICAgPC9nPlxyXG4gIGAsXHJcbiAgJ2RvdHRlZC1saW5lJzogYDxwYXRoIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiOC41XCIgc3Ryb2tlLWRhc2hhcnJheT1cIjguNVwiIGQ9XCJNMjAuODUgNTBoNTguNVwiLz5gLFxyXG4gICdzaG9ydC1kYXNoZWQtbGluZSc6IGA8cGF0aCBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjguNVwiIHN0cm9rZS1kYXNoYXJyYXk9XCIxMFwiIGQ9XCJNMjAuODUgNTBoNTguNVwiLz5gLFxyXG4gICdsb25nLWRhc2hlZC1saW5lJzogYDxwYXRoIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLXdpZHRoPVwiOC41XCIgc3Ryb2tlLWRhc2hhcnJheT1cIjIwXCIgZD1cIk0yMC44NSA1MGg1OC41XCIvPmBcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSWNvbnNIZWxwZXIge1xyXG4gIHN0YXRpYyBhZGRJY29ucygpIHtcclxuICAgIGZvciAoY29uc3QgW2lkLCBzdmddIG9mIE9iamVjdC5lbnRyaWVzKENVU1RPTV9JQ09OUykpIHtcclxuICAgICAgYWRkSWNvbihpZCwgc3ZnKVxyXG4gICAgfVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMsIENhbnZhc0VkZ2UsIENhbnZhc05vZGUgfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9ldmVudHMvZXZlbnRzXCJcclxuXHJcbmNvbnN0IElNQUdFX0ZJTEVfRVhURU5TSU9OUyA9IFtcImJtcFwiLCBcInBuZ1wiLCBcImpwZ1wiLCBcImpwZWdcIiwgXCJnaWZcIiwgXCJzdmdcIiwgXCJ3ZWJwXCIsIFwiYXZpZlwiXVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RpY2tlcnNDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdzdGlja2Vyc0ZlYXR1cmVFbmFibGVkJykpIHJldHVyblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLm9uUG9wdXBNZW51Q3JlYXRlZChjYW52YXMpXHJcbiAgICApKVxyXG4gIH1cclxuXHJcbiAgb25Qb3B1cE1lbnVDcmVhdGVkKGNhbnZhczogQ2FudmFzKTogdm9pZCB7XHJcbiAgICAvLyBJZiB0aGUgY2FudmFzIGlzIHJlYWRvbmx5IG9yIHRoZXJlIGlzIG5vIHZhbGlkIHNoYXBlIGluIHRoZSBzZWxlY3Rpb24sIHJldHVyblxyXG4gICAgaWYgKGNhbnZhcy5yZWFkb25seSB8fCAhdGhpcy5oYXNWYWxpZE5vZGVJblNlbGVjdGlvbihjYW52YXMpKVxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUG9wdXBNZW51T3B0aW9uKFxyXG4gICAgICBjYW52YXMsXHJcbiAgICAgIENhbnZhc0hlbHBlci5jcmVhdGVQb3B1cE1lbnVPcHRpb24oe1xyXG4gICAgICAgIGlkOiAnc3RpY2tlci1vcHRpb24nLFxyXG4gICAgICAgIGxhYmVsOiAnVG9nZ2xlIHN0aWNrZXInLFxyXG4gICAgICAgIGljb246ICdiYWRnZScsIFxyXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLnRvZ2dsZVN0aWNrZXJGb3JTZWxlY3Rpb24oY2FudmFzKVxyXG4gICAgICB9KVxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBoYXNWYWxpZE5vZGVJblNlbGVjdGlvbihjYW52YXM6IENhbnZhcyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3Qgc2VsZWN0ZWROb2Rlc0RhdGEgPSBjYW52YXMuZ2V0U2VsZWN0aW9uRGF0YSgpLm5vZGVzXHJcblxyXG4gICAgZm9yIChjb25zdCBub2RlRGF0YSBvZiBzZWxlY3RlZE5vZGVzRGF0YSkge1xyXG4gICAgICBpZiAobm9kZURhdGEudHlwZSAhPT0gJ2ZpbGUnKSBjb250aW51ZVxyXG4gICAgICBcclxuICAgICAgY29uc3Qgbm9kZUZpbGVFeHRlbnNpb24gPSBub2RlRGF0YS5maWxlPy5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpXHJcbiAgICAgIGlmICghbm9kZUZpbGVFeHRlbnNpb24pIGNvbnRpbnVlXHJcbiAgICAgIGlmICghSU1BR0VfRklMRV9FWFRFTlNJT05TLmluY2x1ZGVzKG5vZGVGaWxlRXh0ZW5zaW9uKSkgY29udGludWVcclxuXHJcbiAgICAgIHJldHVybiB0cnVlXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB0b2dnbGVTdGlja2VyRm9yU2VsZWN0aW9uKGNhbnZhczogQ2FudmFzKTogdm9pZCB7XHJcbiAgICBjb25zdCBzZWxlY3RlZE5vZGVzRGF0YSA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXNcclxuXHJcbiAgICBmb3IgKGNvbnN0IG5vZGVEYXRhIG9mIHNlbGVjdGVkTm9kZXNEYXRhKSB7XHJcbiAgICAgIGlmIChub2RlRGF0YS50eXBlICE9PSAnZmlsZScpIGNvbnRpbnVlXHJcblxyXG4gICAgICBjb25zdCBub2RlID0gY2FudmFzLm5vZGVzLmdldChub2RlRGF0YS5pZClcclxuICAgICAgaWYgKCFub2RlKSBjb250aW51ZVxyXG4gICAgICBcclxuICAgICAgY29uc3Qgd2FzU3RpY2tlciA9IG5vZGUuZ2V0RGF0YSgpLmlzU3RpY2tlclxyXG4gICAgICBjYW52YXMuc2V0Tm9kZURhdGEobm9kZSwgJ2lzU3RpY2tlcicsIHdhc1N0aWNrZXIgPyB1bmRlZmluZWQgOiB0cnVlKVxyXG4gICAgfVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBCQm94LCBQb3NpdGlvbiwgU2lkZSB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCAqIGFzIEJCb3hIZWxwZXIgZnJvbSBcInNyYy91dGlscy9iYm94LWhlbHBlclwiXHJcblxyXG5jb25zdCBESVJFQ1RJT05TID0gW1xyXG4gIHsgZHg6IDEsIGR5OiAwIH0sIHsgZHg6IC0xLCBkeTogMCB9LCB7IGR4OiAwLCBkeTogMSB9LCB7IGR4OiAwLCBkeTogLTEgfSxcclxuICB7IGR4OiAxLCBkeTogMSB9LCB7IGR4OiAtMSwgZHk6IDEgfSwgeyBkeDogMSwgZHk6IC0xIH0sIHsgZHg6IC0xLCBkeTogLTEgfSxcclxuXSBhcyBjb25zdFxyXG5jb25zdCBESUFHT05BTF9DT1NUID0gTWF0aC5zcXJ0KDIpXHJcblxyXG5jbGFzcyBOb2RlIHtcclxuICB4OiBudW1iZXJcclxuICB5OiBudW1iZXJcclxuICBnQ29zdDogbnVtYmVyXHJcbiAgaENvc3Q6IG51bWJlclxyXG4gIGZDb3N0OiBudW1iZXJcclxuICBwYXJlbnQ6IE5vZGV8bnVsbFxyXG5cclxuICBjb25zdHJ1Y3Rvcih4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgdGhpcy54ID0geFxyXG4gICAgdGhpcy55ID0geVxyXG5cclxuICAgIHRoaXMuZ0Nvc3QgPSAwXHJcbiAgICB0aGlzLmhDb3N0ID0gMFxyXG4gICAgdGhpcy5mQ29zdCA9IDBcclxuICAgIHRoaXMucGFyZW50ID0gbnVsbFxyXG4gIH1cclxuXHJcbiAgLy8gT25seSBjaGVjayBmb3IgeCBhbmQgeSwgbm90IGdDb3N0LCBoQ29zdCwgZkNvc3QsIG9yIHBhcmVudFxyXG4gIGluTGlzdChub2RlczogTm9kZVtdKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gbm9kZXMuc29tZShuID0+IG4ueCA9PT0gdGhpcy54ICYmIG4ueSA9PT0gdGhpcy55KVxyXG4gIH1cclxufVxyXG5cclxuLy8gTWFuaGF0dGFuIGRpc3RhbmNlXHJcbmZ1bmN0aW9uIGhldXJpc3RpYyhub2RlOiBOb2RlLCBlbmQ6IE5vZGUpOiBudW1iZXIge1xyXG4gIHJldHVybiBNYXRoLmFicyhub2RlLnggLSBlbmQueCkgKyBNYXRoLmFicyhub2RlLnkgLSBlbmQueSlcclxufVxyXG5cclxuLy8gRGVmaW5lIGEgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSBwb3NpdGlvbiBpc24ndCBpbnNpZGUgYW55IG9ic3RhY2xlXHJcbmZ1bmN0aW9uIGlzVG91Y2hpbmdPYnN0YWNsZShub2RlOiBQb3NpdGlvbiwgb2JzdGFjbGVzOiBCQm94W10pOiBib29sZWFuIHtcclxuICByZXR1cm4gb2JzdGFjbGVzLnNvbWUob2JzdGFjbGUgPT4gQkJveEhlbHBlci5pbnNpZGVCQm94KG5vZGUsIG9ic3RhY2xlLCB0cnVlKSlcclxufVxyXG5cclxuZnVuY3Rpb24gaXNJbnNpZGVPYnN0YWNsZShub2RlOiBQb3NpdGlvbiwgb2JzdGFjbGVzOiBCQm94W10pOiBib29sZWFuIHtcclxuICByZXR1cm4gb2JzdGFjbGVzLnNvbWUob2JzdGFjbGUgPT4gQkJveEhlbHBlci5pbnNpZGVCQm94KG5vZGUsIG9ic3RhY2xlLCBmYWxzZSkpXHJcbn1cclxuXHJcbi8vIERlZmluZSBhIGZ1bmN0aW9uIHRvIGNhbGN1bGF0ZSBtb3ZlbWVudCBjb3N0IGJhc2VkIG9uIGRpcmVjdGlvblxyXG5mdW5jdGlvbiBnZXRNb3ZlbWVudENvc3QoZGlyZWN0aW9uOiB7IGR4OiBudW1iZXI7IGR5OiBudW1iZXIgfSk6IG51bWJlciB7XHJcbiAgcmV0dXJuIGRpcmVjdGlvbi5keCAhPT0gMCAmJiBkaXJlY3Rpb24uZHkgIT09IDAgPyBESUFHT05BTF9DT1NUIDogMVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRQb3NzaWJsZU5laWdoYm9ycyhub2RlOiBOb2RlLCBvYnN0YWNsZXM6IEJCb3hbXSwgZ3JpZFJlc29sdXRpb246IG51bWJlcik6IE5vZGVbXSB7XHJcbiAgY29uc3QgbmVpZ2hib3JzOiBOb2RlW10gPSBbXVxyXG4gIFxyXG4gIGZvciAoY29uc3QgZGlyZWN0aW9uIG9mIERJUkVDVElPTlMpIHtcclxuICAgIGNvbnN0IG5laWdoYm9yID0gbmV3IE5vZGUoXHJcbiAgICAgIG5vZGUueCArIGRpcmVjdGlvbi5keCAqIGdyaWRSZXNvbHV0aW9uLCBcclxuICAgICAgbm9kZS55ICsgZGlyZWN0aW9uLmR5ICogZ3JpZFJlc29sdXRpb25cclxuICAgIClcclxuICAgIG5laWdoYm9yLmdDb3N0ID0gbm9kZS5nQ29zdCArIGdldE1vdmVtZW50Q29zdChkaXJlY3Rpb24pXHJcblxyXG4gICAgaWYgKGlzSW5zaWRlT2JzdGFjbGUobmVpZ2hib3IsIG9ic3RhY2xlcykpIGNvbnRpbnVlXHJcblxyXG4gICAgbmVpZ2hib3JzLnB1c2gobmVpZ2hib3IpXHJcbiAgfVxyXG5cclxuICByZXR1cm4gbmVpZ2hib3JzXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlY29uc3RydWN0UGF0aChub2RlOiBOb2RlKTogTm9kZVtdIHtcclxuICBjb25zdCBwYXRoOiBOb2RlW10gPSBbXVxyXG4gIHdoaWxlIChub2RlKSB7XHJcbiAgICBwYXRoLnB1c2gobm9kZSlcclxuICAgIG5vZGUgPSBub2RlLnBhcmVudCFcclxuICB9XHJcbiAgcmV0dXJuIHBhdGgucmV2ZXJzZSgpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhU3Rhcihmcm9tUG9zOiBQb3NpdGlvbiwgZnJvbVNpZGU6IFNpZGUsIHRvUG9zOiBQb3NpdGlvbiwgdG9TaWRlOiBTaWRlLCBvYnN0YWNsZXM6IEJCb3hbXSwgZ3JpZFJlc29sdXRpb246IG51bWJlcik6IFBvc2l0aW9uW10gfCBudWxsIHtcclxuICBjb25zdCBzdGFydDogTm9kZSA9IG5ldyBOb2RlKFxyXG4gICAgTWF0aC5mbG9vcihmcm9tUG9zLnggLyBncmlkUmVzb2x1dGlvbikgKiBncmlkUmVzb2x1dGlvbixcclxuICAgIE1hdGguZmxvb3IoZnJvbVBvcy55IC8gZ3JpZFJlc29sdXRpb24pICogZ3JpZFJlc29sdXRpb25cclxuICApXHJcbiAgLy8gUm91bmQgc3RhcnQgYW5kIGVuZCBwb3NpdGlvbnMgdG8gdGhlIG5lYXJlc3QgZ3JpZCBjZWxsIG91dHNpZGUgb2YgdGhlIG5vZGVzIHRvIGNvbm5lY3RcclxuICBpZiAoZnJvbVNpZGUgPT09ICdyaWdodCcgJiYgZnJvbVBvcy54ICE9PSBzdGFydC54KSBzdGFydC54ICs9IGdyaWRSZXNvbHV0aW9uXHJcbiAgaWYgKGZyb21TaWRlID09PSAnYm90dG9tJyAmJiBmcm9tUG9zLnkgIT09IHN0YXJ0LnkpIHN0YXJ0LnkgKz0gZ3JpZFJlc29sdXRpb25cclxuXHJcbiAgY29uc3QgZW5kOiBOb2RlID0gbmV3IE5vZGUoXHJcbiAgICBNYXRoLmZsb29yKHRvUG9zLnggLyBncmlkUmVzb2x1dGlvbikgKiBncmlkUmVzb2x1dGlvbixcclxuICAgIE1hdGguZmxvb3IodG9Qb3MueSAvIGdyaWRSZXNvbHV0aW9uKSAqIGdyaWRSZXNvbHV0aW9uXHJcbiAgKVxyXG4gIC8vIFJvdW5kIHN0YXJ0IGFuZCBlbmQgcG9zaXRpb25zIHRvIHRoZSBuZWFyZXN0IGdyaWQgY2VsbCBvdXRzaWRlIG9mIHRoZSBub2RlcyB0byBjb25uZWN0XHJcbiAgaWYgKHRvU2lkZSA9PT0gJ3JpZ2h0JyAmJiB0b1Bvcy54ICE9PSBlbmQueCkgZW5kLnggKz0gZ3JpZFJlc29sdXRpb25cclxuICBpZiAodG9TaWRlID09PSAnYm90dG9tJyAmJiB0b1Bvcy55ICE9PSBlbmQueSkgZW5kLnkgKz0gZ3JpZFJlc29sdXRpb25cclxuICBcclxuICAvLyBDaGVjayBpZiBzdGFydCBhbmQgZW5kIHBvc2l0aW9ucyBhcmUgdmFsaWRcclxuICBpZiAoaXNJbnNpZGVPYnN0YWNsZShzdGFydCwgb2JzdGFjbGVzKSB8fCBpc0luc2lkZU9ic3RhY2xlKGVuZCwgb2JzdGFjbGVzKSkgcmV0dXJuIG51bGxcclxuXHJcbiAgY29uc3Qgb3BlblNldDogTm9kZVtdID0gW3N0YXJ0XVxyXG4gIGNvbnN0IGNsb3NlZFNldDogTm9kZVtdID0gW11cclxuXHJcbiAgd2hpbGUgKG9wZW5TZXQubGVuZ3RoID4gMCkge1xyXG4gICAgLy8gRmluZCB0aGUgbm9kZSB3aXRoIHRoZSBsb3dlc3QgZkNvc3QgaW4gdGhlIG9wZW4gc2V0XHJcbiAgICBsZXQgY3VycmVudDogTm9kZXxudWxsID0gbnVsbFxyXG4gICAgbGV0IGxvd2VzdEZDb3N0ID0gSW5maW5pdHlcclxuXHJcbiAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygb3BlblNldCkge1xyXG4gICAgICBpZiAobm9kZS5mQ29zdCA8IGxvd2VzdEZDb3N0KSB7XHJcbiAgICAgICAgY3VycmVudCA9IG5vZGVcclxuICAgICAgICBsb3dlc3RGQ29zdCA9IG5vZGUuZkNvc3RcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIE5vIHBhdGggZm91bmRcclxuICAgIGlmICghY3VycmVudCkgcmV0dXJuIG51bGxcclxuXHJcbiAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgbm9kZSBmcm9tIHRoZSBvcGVuIHNldCBhbmQgYWRkIGl0IHRvIHRoZSBjbG9zZWQgc2V0XHJcbiAgICBvcGVuU2V0LnNwbGljZShvcGVuU2V0LmluZGV4T2YoY3VycmVudCksIDEpXHJcbiAgICBjbG9zZWRTZXQucHVzaChjdXJyZW50KVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgcmVhY2hlZCB0aGUgZW5kXHJcbiAgICBpZiAoY3VycmVudC54ID09PSBlbmQueCAmJiBjdXJyZW50LnkgPT09IGVuZC55KSB7XHJcbiAgICAgIHJldHVybiBbZnJvbVBvcywgLi4ucmVjb25zdHJ1Y3RQYXRoKGN1cnJlbnQpLCB0b1Bvc10ubWFwKG5vZGUgPT4gKHsgeDogbm9kZS54LCB5OiBub2RlLnkgfSkpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9jYXRpb24gaXMgbm90IHN0YXJ0IG9yIGVuZCwgYWxsIHRvdWNoaW5nIHBvc2l0aW9ucyBhcmUgaW52YWxpZFxyXG4gICAgaWYgKCEoY3VycmVudC54ID09PSBzdGFydC54ICYmIGN1cnJlbnQueSA9PT0gc3RhcnQueSkgJiYgaXNUb3VjaGluZ09ic3RhY2xlKGN1cnJlbnQsIG9ic3RhY2xlcykpIGNvbnRpbnVlXHJcblxyXG4gICAgLy8gRXhwYW5kIG5laWdoYm9yc1xyXG4gICAgZm9yIChjb25zdCBuZWlnaGJvciBvZiBnZXRQb3NzaWJsZU5laWdoYm9ycyhjdXJyZW50LCBvYnN0YWNsZXMsIGdyaWRSZXNvbHV0aW9uKSkge1xyXG4gICAgICBpZiAobmVpZ2hib3IuaW5MaXN0KGNsb3NlZFNldCkpIGNvbnRpbnVlXHJcblxyXG4gICAgICAvLyBDYWxjdWxhdGUgdGVudGF0aXZlIGdDb3N0XHJcbiAgICAgIGNvbnN0IHRlbnRhdGl2ZUdDb3N0ID0gY3VycmVudC5nQ29zdCArIGdldE1vdmVtZW50Q29zdCh7XHJcbiAgICAgICAgZHg6IG5laWdoYm9yLnggLSBjdXJyZW50LngsXHJcbiAgICAgICAgZHk6IG5laWdoYm9yLnkgLSBjdXJyZW50LnksXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBDaGVjayBpZiBuZWlnaGJvciBpcyBub3QgYWxyZWFkeSBpbiB0aGUgb3BlbiBzZXQgb3IgaWYgdGhlIG5ldyBnQ29zdCBpcyBsb3dlclxyXG4gICAgICBpZiAoIW5laWdoYm9yLmluTGlzdChvcGVuU2V0KSB8fCB0ZW50YXRpdmVHQ29zdCA8IG5laWdoYm9yLmdDb3N0KSB7XHJcbiAgICAgICAgbmVpZ2hib3IucGFyZW50ID0gY3VycmVudFxyXG4gICAgICAgIG5laWdoYm9yLmdDb3N0ID0gdGVudGF0aXZlR0Nvc3RcclxuICAgICAgICBuZWlnaGJvci5oQ29zdCA9IGhldXJpc3RpYyhuZWlnaGJvciwgZW5kKVxyXG4gICAgICAgIG5laWdoYm9yLmZDb3N0ID0gbmVpZ2hib3IuZ0Nvc3QgKyBuZWlnaGJvci5oQ29zdFxyXG5cclxuICAgICAgICAvLyBBZGQgbmVpZ2hib3IgdG8gdGhlIG9wZW4gc2V0XHJcbiAgICAgICAgb3BlblNldC5wdXNoKG5laWdoYm9yKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBObyBwYXRoIGZvdW5kXHJcbiAgcmV0dXJuIG51bGxcclxufSIsICJpbXBvcnQgeyBQb3NpdGlvbiB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGF0aEFycmF5VG9TdmdQYXRoKHBvc2l0aW9uczogUG9zaXRpb25bXSwgcm91bmRlZCA9IGZhbHNlKTogc3RyaW5nIHtcclxuICBjb25zdCB0ZW5zaW9uID0gMC4yXHJcbiAgbGV0IG5ld1Bvc2l0aW9ucyA9IFsuLi5wb3NpdGlvbnNdXHJcblxyXG4gIGlmIChyb3VuZGVkICYmIHBvc2l0aW9ucy5sZW5ndGggPiAyKSB7XHJcbiAgICBuZXdQb3NpdGlvbnMgPSBbcG9zaXRpb25zWzBdXVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcG9zaXRpb25zLmxlbmd0aCAtIDI7IGkrKykge1xyXG4gICAgICBjb25zdCBwMSA9IHBvc2l0aW9uc1tpXVxyXG4gICAgICBjb25zdCBwMiA9IHBvc2l0aW9uc1tpICsgMV1cclxuICAgICAgY29uc3QgcDMgPSBwb3NpdGlvbnNbaSArIDJdXHJcblxyXG4gICAgICBjb25zdCB0MSA9ICgxIC0gdGVuc2lvbikgLyAyXHJcbiAgICAgIGNvbnN0IHQyID0gMSAtIHQxXHJcblxyXG4gICAgICBjb25zdCB4ID1cclxuICAgICAgICB0MiAqIHQyICogdDIgKiBwMS54ICtcclxuICAgICAgICAzICogdDIgKiB0MiAqIHQxICogcDIueCArXHJcbiAgICAgICAgMyAqIHQyICogdDEgKiB0MSAqIHAzLnggK1xyXG4gICAgICAgIHQxICogdDEgKiB0MSAqIHAyLnhcclxuXHJcbiAgICAgIGNvbnN0IHkgPVxyXG4gICAgICAgIHQyICogdDIgKiB0MiAqIHAxLnkgK1xyXG4gICAgICAgIDMgKiB0MiAqIHQyICogdDEgKiBwMi55ICtcclxuICAgICAgICAzICogdDIgKiB0MSAqIHQxICogcDMueSArXHJcbiAgICAgICAgdDEgKiB0MSAqIHQxICogcDIueVxyXG5cclxuICAgICAgbmV3UG9zaXRpb25zLnB1c2goeyB4OiB4LCB5OiB5IH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGFzdFBvaW50ID0gcG9zaXRpb25zW3Bvc2l0aW9ucy5sZW5ndGggLSAxXVxyXG4gICAgbmV3UG9zaXRpb25zLnB1c2gobGFzdFBvaW50KVxyXG4gIH1cclxuICAgIFxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbmV3UG9zaXRpb25zLmxlbmd0aCAtIDI7IGkrKykge1xyXG4gICAgY29uc3QgcDEgPSBuZXdQb3NpdGlvbnNbaV1cclxuICAgIGNvbnN0IHAyID0gbmV3UG9zaXRpb25zW2kgKyAxXVxyXG4gICAgY29uc3QgcDMgPSBuZXdQb3NpdGlvbnNbaSArIDJdXHJcblxyXG4gICAgY29uc3QgY3VycmVudERpcmVjdGlvbiA9IHtcclxuICAgICAgeDogcDIueCAtIHAxLngsXHJcbiAgICAgIHk6IHAyLnkgLSBwMS55XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbmV4dERpcmVjdGlvbiA9IHtcclxuICAgICAgeDogcDMueCAtIHAyLngsXHJcbiAgICAgIHk6IHAzLnkgLSBwMi55XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGN1cnJlbnREaXJlY3Rpb24ueCAhPT0gbmV4dERpcmVjdGlvbi54ICYmIGN1cnJlbnREaXJlY3Rpb24ueSAhPT0gbmV4dERpcmVjdGlvbi55KSBjb250aW51ZVxyXG5cclxuICAgIG5ld1Bvc2l0aW9ucy5zcGxpY2UoaSArIDEsIDEpXHJcbiAgICBpLS1cclxuICB9XHJcblxyXG4gIHJldHVybiBuZXdQb3NpdGlvbnMubWFwKChwb3NpdGlvbiwgaW5kZXgpID0+IFxyXG4gICAgYCR7aW5kZXggPT09IDAgPyAnTScgOiAnTCd9ICR7cG9zaXRpb24ueH0gJHtwb3NpdGlvbi55fWBcclxuICApLmpvaW4oJyAnKVxyXG59IiwgImltcG9ydCB7IENhbnZhcywgQ2FudmFzRWRnZSwgQ2FudmFzTm9kZSwgUG9zaXRpb24gfSBmcm9tIFwic3JjL0B0eXBlcy9DYW52YXNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0ICogYXMgQ2FudmFzSGVscGVyIGZyb20gXCJzcmMvdXRpbHMvY2FudmFzLWhlbHBlclwiXHJcbmltcG9ydCAqIGFzIEFTdGFySGVscGVyIGZyb20gXCJzcmMvdXRpbHMvYS1zdGFyLWhlbHBlclwiXHJcbmltcG9ydCAqIGFzIFN2Z1BhdGhIZWxwZXIgZnJvbSBcInNyYy91dGlscy9zdmctcGF0aC1oZWxwZXJcIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCJzcmMvZXZlbnRzL2V2ZW50c1wiXHJcbmltcG9ydCAqIGFzIEJCb3hIZWxwZXIgZnJvbSBcInNyYy91dGlscy9iYm94LWhlbHBlclwiXHJcblxyXG5jb25zdCBTVFlMRVNfTUVOVV9PUFRJT05TOiBDYW52YXNIZWxwZXIuTWVudU9wdGlvbltdID0gW1xyXG4gIHtcclxuICAgIGlkOiB1bmRlZmluZWQsXHJcbiAgICBsYWJlbDogJ0RlZmF1bHQnLFxyXG4gICAgaWNvbjogJ21pbnVzJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdsb25nLWRhc2hlZCcsXHJcbiAgICBsYWJlbDogJ0Rhc2hlZCAobG9uZyknLFxyXG4gICAgaWNvbjogJ2xvbmctZGFzaGVkLWxpbmUnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ3Nob3J0LWRhc2hlZCcsXHJcbiAgICBsYWJlbDogJ0Rhc2hlZCcsXHJcbiAgICBpY29uOiAnc2hvcnQtZGFzaGVkLWxpbmUnXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ2RvdHRlZCcsXHJcbiAgICBsYWJlbDogJ0RvdHRlZCcsXHJcbiAgICBpY29uOiAnZG90dGVkLWxpbmUnXHJcbiAgfVxyXG5dXHJcblxyXG5jb25zdCBST1VURVNfTUVOVV9PUFRJT05TOiBDYW52YXNIZWxwZXIuTWVudU9wdGlvbltdID0gW1xyXG4gIHtcclxuICAgIGlkOiB1bmRlZmluZWQsXHJcbiAgICBsYWJlbDogJ0RlZmF1bHQnLFxyXG4gICAgaWNvbjogJ3JvdXRlJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdkaXJlY3QnLFxyXG4gICAgbGFiZWw6ICdEaXJlY3QnLFxyXG4gICAgaWNvbjogJ21pbnVzJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgaWQ6ICdhLXN0YXInLFxyXG4gICAgbGFiZWw6ICdBKicsXHJcbiAgICBpY29uOiAnbmF2aWdhdGlvbidcclxuICB9XHJcbl1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVkZ2VzU3R5bGVDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdlZGdlc1N0eWxpbmdGZWF0dXJlRW5hYmxlZCcpKSByZXR1cm5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LlBvcHVwTWVudUNyZWF0ZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcykgPT4gdGhpcy5vblBvcHVwTWVudUNyZWF0ZWQoY2FudmFzKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LkVkZ2VDaGFuZ2VkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIGVkZ2U6IENhbnZhc0VkZ2UpID0+IHRoaXMub25FZGdlQ2hhbmdlZChjYW52YXMsIGVkZ2UpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRWRnZUNlbnRlclJlcXVlc3RlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBlZGdlOiBDYW52YXNFZGdlLCBjZW50ZXI6IFBvc2l0aW9uKSA9PiB0aGlzLm9uRWRnZUNlbnRlclJlcXVlc3RlZChjYW52YXMsIGVkZ2UsIGNlbnRlcilcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlQWRkZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcywgX25vZGU6IENhbnZhc05vZGUpID0+IHRoaXMudXBkYXRlQWxsRWRnZXMoY2FudmFzKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50Lk5vZGVSZW1vdmVkLFxyXG4gICAgICAoY2FudmFzOiBDYW52YXMsIF9ub2RlOiBDYW52YXNOb2RlKSA9PiB0aGlzLnVwZGF0ZUFsbEVkZ2VzKGNhbnZhcylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5EcmFnZ2luZ1N0YXRlQ2hhbmdlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzLCBpc0RyYWdnaW5nOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgaWYgKCFpc0RyYWdnaW5nKSB0aGlzLnVwZGF0ZUFsbEVkZ2VzKGNhbnZhcylcclxuICAgICAgfVxyXG4gICAgKSlcclxuICB9XHJcblxyXG4gIG9uUG9wdXBNZW51Q3JlYXRlZChjYW52YXM6IENhbnZhcyk6IHZvaWQge1xyXG4gICAgLy8gSWYgdGhlIGNhbnZhcyBpcyByZWFkb25seSBvciB0aGVyZSBpcyBubyBlZGdlIGluIHRoZSBzZWxlY3Rpb24sIHJldHVyblxyXG4gICAgY29uc3Qgc2VsZWN0ZWRFZGdlcyA9IFsuLi5jYW52YXMuc2VsZWN0aW9uXS5maWx0ZXIoKGl0ZW06IGFueSkgPT4gaXRlbS5wYXRoICE9PSB1bmRlZmluZWQpIGFzIENhbnZhc0VkZ2VbXVxyXG4gICAgaWYgKGNhbnZhcy5yZWFkb25seSB8fCBzZWxlY3RlZEVkZ2VzLmxlbmd0aCA9PT0gMClcclxuICAgICAgcmV0dXJuXHJcblxyXG4gICAgLy8gUGF0aCBzdHlsZXNcclxuICAgIGNvbnN0IHBhdGhTdHlsZU5lc3RlZE9wdGlvbnMgPSBTVFlMRVNfTUVOVV9PUFRJT05TLm1hcCgoc3R5bGUpID0+ICh7XHJcbiAgICAgIC4uLnN0eWxlLFxyXG4gICAgICBpZDogdW5kZWZpbmVkLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zZXRTdHlsZUZvclNlbGVjdGlvbihjYW52YXMsIHNlbGVjdGVkRWRnZXMsIHN0eWxlLmlkKVxyXG4gICAgfSkpXHJcblxyXG4gICAgY29uc3QgcGF0aFN0eWxlTWVudU9wdGlvbiA9IENhbnZhc0hlbHBlci5jcmVhdGVFeHBhbmRhYmxlUG9wdXBNZW51T3B0aW9uKHtcclxuICAgICAgaWQ6ICdlZGdlLXN0eWxlLW9wdGlvbicsXHJcbiAgICAgIGxhYmVsOiAnRWRnZSBzdHlsZScsXHJcbiAgICAgIGljb246ICdtaW51cycsXHJcbiAgICB9LCBwYXRoU3R5bGVOZXN0ZWRPcHRpb25zKVxyXG5cclxuICAgIC8vIEFkZCBtZW51IG9wdGlvbiB0byBtZW51IGJhclxyXG4gICAgQ2FudmFzSGVscGVyLmFkZFBvcHVwTWVudU9wdGlvbihjYW52YXMsIHBhdGhTdHlsZU1lbnVPcHRpb24sIC0yKVxyXG5cclxuICAgIGNvbnN0IHBhdGhSb3V0ZU5lc3RlZE9wdGlvbnMgPSBST1VURVNfTUVOVV9PUFRJT05TLm1hcCgocm91dGUpID0+ICh7XHJcbiAgICAgIC4uLnJvdXRlLFxyXG4gICAgICBpZDogdW5kZWZpbmVkLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zZXRQYXRoUm91dGVGb3JTZWxlY3Rpb24oY2FudmFzLCBzZWxlY3RlZEVkZ2VzLCByb3V0ZS5pZClcclxuICAgIH0pKVxyXG5cclxuICAgIGNvbnN0IHBhdGhSb3V0ZU1lbnVPcHRpb24gPSBDYW52YXNIZWxwZXIuY3JlYXRlRXhwYW5kYWJsZVBvcHVwTWVudU9wdGlvbih7XHJcbiAgICAgIGlkOiAnZWRnZS1wYXRoLXJvdXRlLW9wdGlvbicsXHJcbiAgICAgIGxhYmVsOiAnRWRnZSBwYXRoIHJvdXRlJyxcclxuICAgICAgaWNvbjogJ3JvdXRlJyxcclxuICAgIH0sIHBhdGhSb3V0ZU5lc3RlZE9wdGlvbnMpXHJcblxyXG4gICAgLy8gQWRkIG1lbnUgb3B0aW9uIHRvIG1lbnUgYmFyXHJcbiAgICBDYW52YXNIZWxwZXIuYWRkUG9wdXBNZW51T3B0aW9uKGNhbnZhcywgcGF0aFJvdXRlTWVudU9wdGlvbiwgLTIpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFN0eWxlRm9yU2VsZWN0aW9uKGNhbnZhczogQ2FudmFzLCBzZWxlY3RlZEVkZ2VzOiBDYW52YXNFZGdlW10sIHN0eWxlSWQ6IHN0cmluZ3x1bmRlZmluZWQpIHtcclxuICAgIGZvciAoY29uc3QgZWRnZSBvZiBzZWxlY3RlZEVkZ2VzKSB7XHJcbiAgICAgIGNhbnZhcy5zZXRFZGdlRGF0YShlZGdlLCAnZWRnZVN0eWxlJywgc3R5bGVJZClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0UGF0aFJvdXRlRm9yU2VsZWN0aW9uKGNhbnZhczogQ2FudmFzLCBzZWxlY3RlZEVkZ2VzOiBDYW52YXNFZGdlW10sIHBhdGhSb3V0ZVR5cGVJZDogc3RyaW5nfHVuZGVmaW5lZCkge1xyXG4gICAgZm9yIChjb25zdCBlZGdlIG9mIHNlbGVjdGVkRWRnZXMpIHtcclxuICAgICAgY2FudmFzLnNldEVkZ2VEYXRhKGVkZ2UsICdlZGdlUGF0aFJvdXRlJywgcGF0aFJvdXRlVHlwZUlkKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB1cGRhdGVBbGxFZGdlcyhjYW52YXM6IENhbnZhcykge1xyXG4gICAgZm9yIChjb25zdCBlZGdlIG9mIGNhbnZhcy5lZGdlcy52YWx1ZXMoKSkge1xyXG4gICAgICB0aGlzLm9uRWRnZUNoYW5nZWQoY2FudmFzLCBlZGdlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbkVkZ2VDaGFuZ2VkKGNhbnZhczogQ2FudmFzLCBlZGdlOiBDYW52YXNFZGdlKSB7XHJcbiAgICBpZiAoIWVkZ2UuYmV6aWVyKSByZXR1cm5cclxuICAgIFxyXG4gICAgLy8gUmVzZXQgcGF0aCB0byBkZWZhdWx0XHJcbiAgICBlZGdlLnVwZGF0ZVBhdGgoKVxyXG4gICAgZWRnZS5jZW50ZXIgPSB1bmRlZmluZWRcclxuXHJcbiAgICBjb25zdCBwYXRoUm91dGVUeXBlID0gZWRnZS5nZXREYXRhKCkuZWRnZVBhdGhSb3V0ZSA/PyAnZGVmYXVsdCdcclxuICAgIGlmIChwYXRoUm91dGVUeXBlID09PSAnZGVmYXVsdCcpIHtcclxuICAgICAgLy8gVXBkYXRlIGxhYmVsIHBvc2l0aW9uXHJcbiAgICAgIGVkZ2UubGFiZWxFbGVtZW50Py5yZW5kZXIoKSBcclxuXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZyb21Qb3MgPSBlZGdlLmZyb20uZW5kID09PSAnbm9uZScgPyBcclxuICAgICAgQkJveEhlbHBlci5nZXRDZW50ZXJPZkJCb3hTaWRlKGVkZ2UuZnJvbS5ub2RlLmdldEJCb3goKSwgZWRnZS5mcm9tLnNpZGUpIDpcclxuICAgICAgZWRnZS5iZXppZXIuZnJvbVxyXG5cclxuICAgIGNvbnN0IHRvUG9zID0gZWRnZS50by5lbmQgPT09ICdub25lJyA/IFxyXG4gICAgICBCQm94SGVscGVyLmdldENlbnRlck9mQkJveFNpZGUoZWRnZS50by5ub2RlLmdldEJCb3goKSwgZWRnZS50by5zaWRlKSA6XHJcbiAgICAgIGVkZ2UuYmV6aWVyLnRvXHJcblxyXG4gICAgbGV0IG5ld1BhdGggPSBlZGdlLnBhdGguZGlzcGxheS5nZXRBdHRyaWJ1dGUoXCJkXCIpXHJcbiAgXHJcbiAgICBpZiAocGF0aFJvdXRlVHlwZSA9PT0gJ2RpcmVjdCcpIHtcclxuICAgICAgbmV3UGF0aCA9IFN2Z1BhdGhIZWxwZXIucGF0aEFycmF5VG9TdmdQYXRoKFtmcm9tUG9zLCB0b1Bvc10sIGZhbHNlKVxyXG4gICAgICBlZGdlLmNlbnRlciA9IHsgXHJcbiAgICAgICAgeDogKGZyb21Qb3MueCArIHRvUG9zLngpIC8gMiwgXHJcbiAgICAgICAgeTogKGZyb21Qb3MueSArIHRvUG9zLnkpIC8gMiBcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChwYXRoUm91dGVUeXBlID09PSAnYS1zdGFyJykge1xyXG4gICAgICBpZiAoY2FudmFzLmlzRHJhZ2dpbmcgJiYgIXRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdlZGdlU3R5bGVQYXRoZmluZGVyUGF0aExpdmVVcGRhdGUnKSkgcmV0dXJuXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBub2RlQkJveGVzID0gWy4uLmNhbnZhcy5ub2Rlcy52YWx1ZXMoKV1cclxuICAgICAgICAuZmlsdGVyKG5vZGUgPT4ge1xyXG4gICAgICAgICAgY29uc3Qgbm9kZURhdGEgPSBub2RlLmdldERhdGEoKVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCBpc0dyb3VwID0gbm9kZURhdGEudHlwZSA9PT0gJ2dyb3VwJyAvLyBFeGNsdWRlIGdyb3VwIG5vZGVzXHJcbiAgICAgICAgICBjb25zdCBpc09wZW5Qb3J0YWwgPSBub2RlRGF0YS5wb3J0YWxUb0ZpbGUgIT09IHVuZGVmaW5lZCAvLyBFeGNsdWRlIG9wZW4gcG9ydGFsc1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZXR1cm4gIWlzR3JvdXAgJiYgIWlzT3BlblBvcnRhbFxyXG4gICAgICAgIH0pLm1hcChub2RlID0+IG5vZGUuZ2V0QkJveCgpKVxyXG5cclxuICAgICAgY29uc3QgZ3JpZFJlc29sdXRpb24gPSB0aGlzLnBsdWdpbi5zZXR0aW5nc01hbmFnZXIuZ2V0U2V0dGluZygnZWRnZVN0eWxlUGF0aGZpbmRlckdyaWRSZXNvbHV0aW9uJylcclxuICAgICAgY29uc3QgcGF0aEFycmF5ID0gQVN0YXJIZWxwZXIuYVN0YXIoZnJvbVBvcywgZWRnZS5mcm9tLnNpZGUsIHRvUG9zLCBlZGdlLnRvLnNpZGUsIG5vZGVCQm94ZXMsIGdyaWRSZXNvbHV0aW9uKVxyXG4gICAgICBpZiAoIXBhdGhBcnJheSkgcmV0dXJuIC8vIE5vIHBhdGggZm91bmQgLSB1c2UgZGVmYXVsdCBwYXRoXHJcblxyXG4gICAgICBjb25zdCByb3VuZGVkUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlci5nZXRTZXR0aW5nKCdlZGdlU3R5bGVQYXRoZmluZGVyUGF0aFJvdW5kZWQnKVxyXG4gICAgICBjb25zdCBzdmdQYXRoID0gU3ZnUGF0aEhlbHBlci5wYXRoQXJyYXlUb1N2Z1BhdGgocGF0aEFycmF5LCByb3VuZGVkUGF0aClcclxuXHJcbiAgICAgIG5ld1BhdGggPSBzdmdQYXRoXHJcbiAgICAgIGVkZ2UuY2VudGVyID0gcGF0aEFycmF5W01hdGguZmxvb3IocGF0aEFycmF5Lmxlbmd0aCAvIDIpXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBlZGdlLnBhdGguaW50ZXJhY3Rpb24uc2V0QXR0cihcImRcIiwgbmV3UGF0aClcclxuICAgIGVkZ2UucGF0aC5kaXNwbGF5LnNldEF0dHIoXCJkXCIsIG5ld1BhdGgpXHJcbiAgICBlZGdlLmxhYmVsRWxlbWVudD8ucmVuZGVyKClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25FZGdlQ2VudGVyUmVxdWVzdGVkKF9jYW52YXM6IENhbnZhcywgZWRnZTogQ2FudmFzRWRnZSwgY2VudGVyOiBQb3NpdGlvbikge1xyXG4gICAgY2VudGVyLnggPSBlZGdlLmNlbnRlcj8ueCA/PyBjZW50ZXIueFxyXG4gICAgY2VudGVyLnkgPSBlZGdlLmNlbnRlcj8ueSA/PyBjZW50ZXIueVxyXG4gIH1cclxufSIsICJpbXBvcnQgeyBDYW52YXMsIENhbnZhc0VkZ2UsIENhbnZhc0VkZ2VEYXRhIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuaW1wb3J0IHsgQ2FudmFzRXZlbnQgfSBmcm9tIFwic3JjL2V2ZW50cy9ldmVudHNcIlxyXG5pbXBvcnQgQWR2YW5jZWRDYW52YXNQbHVnaW4gZnJvbSBcInNyYy9tYWluXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzU2V0dGluZ3NNYW5hZ2VyIGZyb20gXCJzcmMvc2V0dGluZ3NcIlxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cG9zZWRFZGdlRGF0YShzZXR0aW5nczogQWR2YW5jZWRDYW52YXNTZXR0aW5nc01hbmFnZXIpOiAoa2V5b2YgQ2FudmFzRWRnZURhdGEpW10ge1xyXG4gIGNvbnN0IGV4cG9zZWREYXRhOiAoa2V5b2YgQ2FudmFzRWRnZURhdGEpW10gPSBbXVxyXG5cclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygnZWRnZXNTdHlsaW5nRmVhdHVyZUVuYWJsZWQnKSkgZXhwb3NlZERhdGEucHVzaCgnZWRnZVN0eWxlJylcclxuICBpZiAoc2V0dGluZ3MuZ2V0U2V0dGluZygncG9ydGFsc0ZlYXR1cmVFbmFibGVkJykpIGV4cG9zZWREYXRhLnB1c2goJ2lzVW5zYXZlZCcpXHJcblxyXG4gIHJldHVybiBleHBvc2VkRGF0YVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFZGdlRGF0YVRhZ2dlckNhbnZhc0V4dGVuc2lvbiB7XHJcbiAgcGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpblxyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRWRnZUNoYW5nZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIGVkZ2U6IENhbnZhc0VkZ2UpID0+IHtcclxuICAgICAgICBjb25zdCBlZGdlRGF0YSA9IGVkZ2U/LmdldERhdGEoKVxyXG4gICAgICAgIGlmICghZWRnZURhdGEpIHJldHVyblxyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGRhdGFLZXkgb2YgZ2V0RXhwb3NlZEVkZ2VEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzTWFuYWdlcikpIHtcclxuICAgICAgICAgIGNvbnN0IGRhdGFWYWx1ZSA9IGVkZ2VEYXRhW2RhdGFLZXldXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChkYXRhVmFsdWUgPT09IHVuZGVmaW5lZCkgZGVsZXRlIGVkZ2UucGF0aC5kaXNwbGF5LmRhdGFzZXRbZGF0YUtleV1cclxuICAgICAgICAgIGVsc2UgZWRnZS5wYXRoLmRpc3BsYXkuZGF0YXNldFtkYXRhS2V5XSA9IGRhdGFWYWx1ZSBhcyBzdHJpbmdcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICkpXHJcbiAgfVxyXG59IiwgImltcG9ydCBBZHZhbmNlZENhbnZhc1BsdWdpbiBmcm9tIFwic3JjL21haW5cIlxyXG5pbXBvcnQgeyBDYW52YXNFdmVudCB9IGZyb20gXCIuLi9ldmVudHMvZXZlbnRzXCJcclxuaW1wb3J0IHsgQ2FudmFzLCBDYW52YXNOb2RlIH0gZnJvbSBcInNyYy9AdHlwZXMvQ2FudmFzXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERlYnVnSGVscGVyIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5Ob2RlQWRkZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIF9ub2RlOiBDYW52YXNOb2RlKSA9PiBjb25zb2xlLmxvZygnXHVEODNEXHVERkUyIE5vZGVBZGRlZCcpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuTm9kZUNoYW5nZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIF9ub2RlOiBDYW52YXNOb2RlKSA9PiBjb25zb2xlLmxvZygnXHVEODNEXHVERkUxIE5vZGVDaGFuZ2VkJylcclxuICAgICkpXHJcblxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFxyXG4gICAgICBDYW52YXNFdmVudC5FZGdlQWRkZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIF9lZGdlOiBDYW52YXNOb2RlKSA9PiBjb25zb2xlLmxvZygnXHVEODNEXHVERkUyIEVkZ2VBZGRlZCcpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuRWRnZUNoYW5nZWQsXHJcbiAgICAgIChfY2FudmFzOiBDYW52YXMsIF9lZGdlOiBDYW52YXNOb2RlKSA9PiBjb25zb2xlLmxvZygnXHVEODNEXHVERkUxIEVkZ2VDaGFuZ2VkJylcclxuICAgICkpXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcyB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9ldmVudHMvZXZlbnRzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEZWZhdWx0Tm9kZVNpemVDYW52YXNFeHRlbnNpb24ge1xyXG4gIHBsdWdpbjogQWR2YW5jZWRDYW52YXNQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgIENhbnZhc0V2ZW50LkNhbnZhc0NoYW5nZWQsXHJcbiAgICAgIChjYW52YXM6IENhbnZhcykgPT4gY2FudmFzLmNvbmZpZy5kZWZhdWx0VGV4dE5vZGVEaW1lbnNpb25zID0geyB3aWR0aDogMjYwLCBoZWlnaHQ6IDYwIH1cclxuICAgICkpXHJcbiAgfVxyXG59IiwgImltcG9ydCB7IENhbnZhcyB9IGZyb20gXCJzcmMvQHR5cGVzL0NhbnZhc1wiXHJcbmltcG9ydCB7IENhbnZhc0V2ZW50IH0gZnJvbSBcInNyYy9ldmVudHMvZXZlbnRzXCJcclxuaW1wb3J0IEFkdmFuY2VkQ2FudmFzUGx1Z2luIGZyb20gXCJzcmMvbWFpblwiXHJcblxyXG5jb25zdCBERUZBVUxUX0NPTE9SU19DT1VOVCA9IDZcclxuY29uc3QgQ1VTVE9NX0NPTE9SU19NT0RfU1RZTEVTX0lEID0gJ21vZC1jdXN0b20tY29sb3JzJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29sb3JQYWxldHRlQ2FudmFzRXh0ZW5zaW9uIHtcclxuICBwbHVnaW46IEFkdmFuY2VkQ2FudmFzUGx1Z2luXHJcbiAgb2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXJ8bnVsbCA9IG51bGxcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBBZHZhbmNlZENhbnZhc1BsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXHJcbiAgICAgICdjc3MtY2hhbmdlJyxcclxuICAgICAgKCkgPT4gdGhpcy51cGRhdGVDdXN0b21Db2xvck1vZFN0eWxlQ2xhc3NlcygpXHJcbiAgICApKVxyXG5cclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcclxuICAgICAgQ2FudmFzRXZlbnQuUG9wdXBNZW51Q3JlYXRlZCxcclxuICAgICAgKGNhbnZhczogQ2FudmFzKSA9PiB0aGlzLnBhdGNoQ29sb3JTZWxlY3Rpb24oY2FudmFzKVxyXG4gICAgKSlcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlcigoKSA9PiB0aGlzLm9ic2VydmVyPy5kaXNjb25uZWN0KCkpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbG9yTW9kU3R5bGVDbGFzc2VzKCkge1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoQ1VTVE9NX0NPTE9SU19NT0RfU1RZTEVTX0lEKT8ucmVtb3ZlKClcclxuXHJcbiAgICBjb25zdCBjdXN0b21Db2xvck1vZFN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKVxyXG4gICAgY3VzdG9tQ29sb3JNb2RTdHlsZS5pZCA9IENVU1RPTV9DT0xPUlNfTU9EX1NUWUxFU19JRFxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjdXN0b21Db2xvck1vZFN0eWxlKVxyXG5cclxuICAgIGZvciAoY29uc3QgY29sb3JJZCBvZiB0aGlzLmdldEN1c3RvbUNvbG9ycygpKSB7XHJcbiAgICAgIC8vIEFkZCBtb2QtY2FudmFzLWNvbG9yLTxjb2xvcklkPiBzdHlsZSB0byB0aGUgY3NzXHJcbiAgICAgIGN1c3RvbUNvbG9yTW9kU3R5bGUuaW5uZXJIVE1MICs9IGBcclxuICAgICAgICAubW9kLWNhbnZhcy1jb2xvci0ke2NvbG9ySWR9IHtcclxuICAgICAgICAgIC0tY2FudmFzLWNvbG9yOiB2YXIoLS1jYW52YXMtY29sb3ItJHtjb2xvcklkfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICBgXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhdGNoQ29sb3JTZWxlY3Rpb24oY2FudmFzOiBDYW52YXMpIHtcclxuICAgIGlmICh0aGlzLm9ic2VydmVyKSB0aGlzLm9ic2VydmVyLmRpc2Nvbm5lY3QoKVxyXG5cclxuICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGlvbnMgPT4ge1xyXG4gICAgICBjb25zdCBjb2xvck1lbnVPcGVuZWQgPSBtdXRhdGlvbnMuc29tZShtdXRhdGlvbiA9PiBcclxuICAgICAgICBPYmplY3QudmFsdWVzKG11dGF0aW9uLmFkZGVkTm9kZXMpLnNvbWUoKG5vZGU6IE5vZGUpID0+IFxyXG4gICAgICAgICAgbm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYW52YXMtc3VibWVudScpICYmIE9iamVjdC52YWx1ZXMobm9kZS5jaGlsZE5vZGVzKS5zb21lKChub2RlOiBOb2RlKSA9PlxyXG4gICAgICAgICAgICBub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiYgbm9kZS5jbGFzc0xpc3QuY29udGFpbnMoJ2NhbnZhcy1jb2xvci1waWNrZXItaXRlbScpXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgKVxyXG4gICAgICApXHJcbiAgICAgIGlmICghY29sb3JNZW51T3BlbmVkKSByZXR1cm5cclxuXHJcbiAgICAgIGNvbnN0IHN1Ym1lbnUgPSBjYW52YXMubWVudS5tZW51RWwucXVlcnlTZWxlY3RvcignLmNhbnZhcy1zdWJtZW51JylcclxuICAgICAgaWYgKCFzdWJtZW51KSByZXR1cm5cclxuXHJcbiAgICAgIHRoaXMudXBkYXRlQ3VzdG9tQ29sb3JNb2RTdHlsZUNsYXNzZXMoKVxyXG5cclxuICAgICAgY29uc3QgY3VycmVudE5vZGVDb2xvciA9IGNhbnZhcy5nZXRTZWxlY3Rpb25EYXRhKCkubm9kZXMubWFwKG5vZGUgPT4gbm9kZS5jb2xvcikubGFzdCgpXHJcbiAgICAgIGZvciAoY29uc3QgY29sb3JJZCBvZiB0aGlzLmdldEN1c3RvbUNvbG9ycygpKSB7XHJcbiAgICAgICAgY29uc3QgY3VzdG9tQ29sb3JNZW51SXRlbSA9IHRoaXMuY3JlYXRlQ29sb3JNZW51SXRlbShjYW52YXMsIGNvbG9ySWQpXHJcbiAgICAgICAgaWYgKGN1cnJlbnROb2RlQ29sb3IgPT09IGNvbG9ySWQpIGN1c3RvbUNvbG9yTWVudUl0ZW0uY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJylcclxuICAgICAgICBcclxuICAgICAgICBzdWJtZW51Lmluc2VydEJlZm9yZShjdXN0b21Db2xvck1lbnVJdGVtLCBzdWJtZW51Lmxhc3RDaGlsZClcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoY2FudmFzLm1lbnUubWVudUVsLCB7IGNoaWxkTGlzdDogdHJ1ZSB9KVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVDb2xvck1lbnVJdGVtKGNhbnZhczogQ2FudmFzLCBjb2xvcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IG1lbnVJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICAgIG1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoJ2NhbnZhcy1jb2xvci1waWNrZXItaXRlbScpXHJcbiAgICBtZW51SXRlbS5jbGFzc0xpc3QuYWRkKGBtb2QtY2FudmFzLWNvbG9yLSR7Y29sb3JJZH1gKVxyXG5cclxuICAgIG1lbnVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICBtZW51SXRlbS5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKVxyXG5cclxuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGNhbnZhcy5zZWxlY3Rpb24pIHtcclxuICAgICAgICBpdGVtLnNldENvbG9yKGNvbG9ySWQpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhbnZhcy5yZXF1ZXN0U2F2ZSgpXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBtZW51SXRlbVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDdXN0b21Db2xvcnMoKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgY29sb3JzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG4gICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgY29uc3QgY29sb3JJZCA9IChERUZBVUxUX0NPTE9SU19DT1VOVCArIGNvbG9ycy5sZW5ndGggKyAxKS50b1N0cmluZygpXHJcbiAgICAgIGlmICghZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKGAtLWNhbnZhcy1jb2xvci0ke2NvbG9ySWR9YCkpIGJyZWFrXHJcblxyXG4gICAgICBjb2xvcnMucHVzaChjb2xvcklkKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjb2xvcnNcclxuICB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQWlDOzs7QUNBakMsc0JBQWtEO0FBR2xELElBQU0scUJBQWdEO0FBQUEsRUFDcEQsWUFBWTtBQUFBLEVBQ1osWUFBWTtBQUNkO0FBb0NPLElBQU0sbUJBQTBEO0FBQUEsRUFDckUsc0JBQXNCO0FBQUEsRUFFdEIsNEJBQTRCO0FBQUEsRUFDNUIsbUNBQW1DO0FBQUEsRUFDbkMsbUNBQW1DO0FBQUEsRUFDbkMsZ0NBQWdDO0FBQUEsRUFFaEMsd0JBQXdCO0FBQUEsRUFDeEIsa0JBQWtCO0FBQUEsRUFDbEIsaUJBQWlCO0FBQUEsRUFDakIsb0JBQW9CO0FBQUEsRUFFcEIsdUJBQXVCO0FBQUEs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TSxvQkFBMkI7QUFBQSxFQUMvQjtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFBQSxFQUNBO0FBQUEsRUFDQTtBQUFBLEVBQ0E7QUFDRjtBQUVBLElBQXFCLHVCQUFyQixjQUFrRCx3QkFBTztBQUFBLEVBTXhELE1BQU0sU0FBUztBQUNaLGdCQUFZLFNBQVM7QUFFckIsU0FBSyxrQkFBa0IsSUFBSSw4QkFBOEIsSUFBSTtBQUM3RCxVQUFNLEtBQUssZ0JBQWdCLGFBQWE7QUFDeEMsU0FBSyxnQkFBZ0IsZUFBZTtBQUVwQyxTQUFLLHFCQUFxQixJQUFJLG1CQUFtQixJQUFJO0FBQ3JELFNBQUssbUJBQW1CLGtCQUFrQixJQUFJLENBQUMsY0FBYyxJQUFJLFVBQVUsSUFBSSxDQUFDO0FBQUEsRUFDbkY7QUFBQSxFQUVDLFdBQVc7QUFBQSxFQUFDO0FBQUEsRUFFWix1QkFBd0M7QUFDdEMsVUFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLG9CQUFvQix5QkFBUTtBQUNsRSxTQUFJLHlDQUFZLG1CQUFrQjtBQUFVLGFBQU87QUFDbkQsV0FBTztBQUFBLEVBQ1Q7QUFBQSxFQUVBLG1CQUFnQztBQS9EbEM7QUFnRUksYUFBTyxVQUFLLHFCQUFxQixNQUExQixtQkFBNkIsV0FBVTtBQUFBLEVBQ2hEO0FBQUE7QUFBQSxFQUdBLGtCQUFrQjtBQUNoQixRQUFJLEtBQUs7QUFBYTtBQUN0QixTQUFLLGNBQWMsSUFBSSxZQUFZLElBQUk7QUFBQSxFQUN6QztBQUNGOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInJlc3VsdCIsICJ1cGRhdGUiLCAiZGF0YSIsICJjYW52YXNWaWV3IiwgImNhbnZhcyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiY2FudmFzIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAibm9kZSIsICJfYSIsICJfYiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiRElSRUNUSU9OUyIsICJub2RlIl0KfQo=
