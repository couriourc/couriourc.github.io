typora-root-url: ./data-structure-string-kmp
title: 'æ•°æ®ç»“æ„æ€»ç»“-å­—ç¬¦ä¸²:kmp'
author: CouriourC
mathjax: true
tags:
  - åŸºç¡€çŸ¥è¯†
  - æ•°æ®ç»“æ„
  - KMP
  - 823
categories:
  - data-structure
nanoid: zau3RtFY-PeFq3Y_0IGIe
date: 2022-10-24 15:08:39
updated: 2022-10-24 15:08:39
---

# æµ…æ `KMP ` çš„ `next` æ•°ç»„æ±‚è§£æ€æƒ³

```python
def get_next(t):
    next_list = [-1] * len(t)
    j = -1
    i = 0
    s = t
    while i < len(s):
        if j == -1 or s[i] == t[j]:
            i += 1
            j += 1
            next_list[i] = j
        else:
            j = next_list[j]
    return next_list

get_next('abababc')
```

å¯¹äº Kmp ç®—æ³•ä¸­ä¹¦ä¸Šçš„ `next `æ•°ç»„æ±‚æ³•ä¸€ç›´å¤„äºä¸€ä¸ª `æ‡µé€¼` çš„çŠ¶æ€ã€‚ä¸ç†è§£ä¸ºä»€ä¹ˆæœ‰ `-1`ï¼Œä¸ºä»€ä¹ˆæ±‚å‰åå…¬å…±åç¼€ä¸éœ€è¦ç”¨åˆ°å•ç‹¬çš„ `check` æœºåˆ¶ï¼Œæ¯•ç«Ÿæˆ‘ä»¬äººçœ¼æ¥çœ‹éƒ½ä¼šå»åå¤çš„åˆ¤æ–­ï¼ˆè‡³å°‘æˆ‘ä¹‹å‰ä¸€ç›´éƒ½æ˜¯ï¼‰ã€‚

-   æ€æƒ³å½’ç±»

    -   æ»‘åŠ¨çª—å£
    
        -   æˆ‘ä»¬æ±‚æœ€å¤§å‰åç¼€ï¼Œä¾èµ–ä¸å‰é¢çš„å€¼æ‰€å·²ç»æœ‰çš„æœ€é•¿å‰åç¼€ï¼Œä»è€Œä¸éœ€è¦å†ï¼Œç„¶åä»¥æ­¤å‘å‰æ¨
    
        -   å›å¿†ä¸€ä¸‹ä¹‹å‰åšçš„ä¹ é¢˜ï¼š[ æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode.cn/problems/longest-substring-without-repeating-characters/)
    
            >   ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² `s` ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ **æœ€é•¿å­ä¸²** çš„é•¿åº¦ã€‚
            >
            >   >   æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
            >   >   é“¾æ¥ï¼šhttps://leetcode.cn/problems/sliding-window-maximum
            >   >   è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
    
            åœ¨æˆ‘ä»¬è¿™é‡Œç”¨çš„æ˜¯ä¸€ç«¯ä¸åŠ¨çš„çª—å£
    
    -   åŠ¨æ€è§„åˆ’çš„è§’åº¦æ€è€ƒ
    

## ä»£ç ä¸­çš„æ±‚è§£è¿‡ç¨‹

ä¸¾ä¸ªä¾‹å­: `abababa`ï¼Œæˆ‘ä»¬åœ¨è¿è¡Œæ±‚ç¬¬ 6 ä¸ªçš„æ—¶å€™: `a b a b a "b" a`ï¼Œæˆ‘ä»¬ä¹‹å‰æ‰€æ±‚åˆ°çš„å‰é¢çš„å…¬å…±å‰åç¼€çš„é•¿åº¦ä¹Ÿå°±æ˜¯ 3 `aba`

å‰åç¼€æ˜¯åŒ…æ‹¬æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ¯æ¬¡ä» `aba `çš„åé¢å¼€å§‹åˆ¤æ–­, `aba "?"`ï¼Œè¿™ä¸ª `?` å’Œæˆ‘å½“å‰çš„å¯¹åº”åˆ°çš„ä¹Ÿå°±æ˜¯ç¬¬ `7` ä¸ªçš„ç»“æœ,è¿™ä¸ªå–å†³äºå½“å‰æµè§ˆçš„ `i` ä¹Ÿå°±æ˜¯ `"b"` æ˜¯å¦æ»¡è¶³ç­‰äºä¹‹å‰æ‰€æ‰¾åˆ°çš„æœ€é•¿çš„,å¦‚æœä¸æ˜¯å°±å‘ä¸‹æ‰¾å‰ä¸€æ®µæ‰€æ±‚çš„å…¬å…±æœ€é•¿å­ä¸²,åŒæ ·çš„é“ç†ä¹Ÿæ˜¯å–å†³äºè¿™ä¸ªå…¬å…±å‰åç¼€çš„å°¾å·´ä¸æˆ‘ç°åœ¨æ‰€åœ¨çš„è¿™ä¸ªåç¼€çš„å°¾å·´æ˜¯å¦ç›¸ç­‰
`a b a b a "b" a`
`0 1 1 2 3  4  5`

`a 0`: é»˜è®¤å€¼

`b 1`: å‰é¢çš„æœ€é•¿å…¬å…±å­ä¸²ä¸º 0 ,è‡³äºä¸ºä»€ä¹ˆè¦ `+1` æ˜¯å› ä¸ºæˆ‘ä»¬å½“å‰åŒ¹é…çš„æ—¶å€™,å‰é¢çš„å·²ç»å‘ç°åœ¨è¿™ä¸ªä½ç½®å°±ä¸å¯¹,é‚£ `a` å°±æ²¡å¿…è¦å†ä¸ `b` è¿™ä¸ªä½ç½®æ¯”è¾ƒ,æ‰€ä»¥å°±è·³åˆ° `b` çš„åé¢å»,ä¹Ÿå°±æ˜¯ `j` ä»å¤´å†å¼€å§‹ã€‚

>éœ€è¦æ³¨æ„çš„æ˜¯,æˆ‘ä»¬æ±‚ è¿™ä¸ªå€¼çš„æ—¶å€™,` i` åœ¨ æˆ‘ä»¬å½“å‰æ­£åœ¨æ±‚çš„å‰ä¸€ä¸ªä½ç½®,åœ¨è¿™ä¸ªæ»¡è¶³åè®¾ç½®çš„æ‰æ˜¯æˆ‘ä»¬å½“å‰æ±‚å¾—è¿™ä¸ª ä¹Ÿå³æ˜¯è¯´æˆ‘ä»¬å¦‚æœä» j = 0 å¼€å§‹çš„æ—¶å€™,ä¹Ÿå°±æ˜¯é”™å¼€äº†ä¸€ä¸ªä½ç½®
å¾—åˆ°çš„ `next_list = ["0" 0 1 1 2 3  4  5]`
è€Œä¸æ˜¯` next_list = [ 0 1 1 2 3  4  5]`

`a 2`: å‰é¢çš„å‰ç¼€ä¹‹å‰æˆ‘ä»¬å‘ç°ä» ç¬¬ `0` çš„ä½ç½®æ˜¯ä¸å­˜åœ¨å‰åç¼€çš„,ç„¶åç°åœ¨æˆ‘ä»¬è¦è§‚å¯Ÿçš„æ˜¯ å‰é¢çš„å…¬å…±å‰åç¼€,ä¹Ÿå°±æ˜¯ ab çš„å…¬å…±å‰åç¼€, `a` ä¸ æˆ‘å½“å‰çš„ `b` å¹¶ä¸ç›¸ç­‰,

`b 3`: OK,åŸºäºä»¥ä¸Šçš„ï¼Œæˆ‘ä»¬åˆ°æ±‚ç¬¬ä¸‰çš„è¿™ä¸ªä½ç½®,è¿™ä¸ªä½ç½®çš„åˆ¤å®šæ¡ä»¶å°±æ˜¯:æˆ‘ä»¬å‰é¢çš„ `aba `æ‰€æ±‚åˆ°çš„è¿™ä¸ªçš„æœ€é•¿å…¬å…±å‰åç¼€çš„æœ€åä¸€ä¸ª `ab?` ä¸­çš„ `? `ä¸æˆ‘å½“å‰çš„ `a `æ˜¯å¦ç›¸ç­‰(éœ€è¦ç•™æ„,ç”¨ç¨‹åºæ±‚çš„æ—¶å€™,æ˜¯çœ‹å‰é¢çš„å‰é¢ä¸æˆ‘å½“å‰çš„ä½ç½®çš„æƒ…å†µ,ç„¶åæ¨åˆ°åé¢çš„æƒ…å†µ

---

å¯¹äºæˆ‘ä»¬çš„ç›´è§‰æ±‚æ³•å°±æ˜¯ç›´æ¥çªçœ¼ç¥åŠŸå¯¹äºä¸Šé¢çš„ æ±‚ `i+1 = 3`(è¿™æ—¶å€™ `i `æ˜¯ç­‰äº `2`) ä¹Ÿå°±æ˜¯æ±‚ç¬¬ 4**(ç»å†äº† i= i +1-> next_list[3])** è¿™ä¸€ä¸ªå­—ç¬¦å‰é¢çš„å…¬å…±å‰åç¼€çš„æ—¶å€™(`j = -1 `çš„æ—¶å€™æ±‚åˆ°çš„ `next_list `æ˜¯æ­£å¸¸çš„åŒ¹é…é¡ºåº,ä¹Ÿå°±æ˜¯ `i `æ˜¯ä»æ­£å¸¸çš„ `0 `å¼€å§‹çš„å…¶å‰é¢çš„å­—ç¬¦æ˜¯ `aba `æ¥çœ‹ ,ä¹‹å‰æˆ‘ä»¬å‘ç°æœ€é•¿å…¬å…±å‰åç¼€å°±æ˜¯ 0 ä¹Ÿå°±æ˜¯ `a `è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åˆ¤æ–­ `t[2]:a`æ˜¯å¦ç­‰äº(åç¼€å’Œè¿™ä¸ªå‰é¢çš„æœ€é•¿çš„å‰ç¼€çš„æœ€åä¸€ä¸ªå…ƒç´ åšæ¯”è¾ƒ)ç„¶åå‘ç° `a = a` æ˜¯ç›¸ç­‰çš„,ç„¶åå°±å¯ä»¥å¾—åˆ° `2` äº†è€Œä¸æ˜¯è¿˜è¦å»æ‰«æåé¢çš„,å› ä¸ºæˆ‘ä»¬è¿™ä¸€æ¬¡æ‰«æå¸¦æ¥çš„å…ƒç´ åªæœ‰ä¸€ä¸ª,æœ‰ä¸€ç§æ»‘åŠ¨çª—å£çš„å‘³é“äº†ã€‚

å†é‡æ–°æ•´ç†ä¸€ä¸‹ï¼š

-   çª—å£ä¸­çš„è¿›å…¥äº†ä¸€ä¸ªå…ƒç´ 
-   è¿™ä¸ªå…ƒç´ å¯¹çª—å£äº§ç”Ÿçš„å½±å“

>   ä¸€äº›é—®é¢˜ï¼šè¿™ç§é¿å…å›æº¯çš„æ–¹æ³•ï¼Œèƒ½å¦åœ¨çª—å£ä¸­åˆç†çš„åˆ©ç”¨å‘¢ã€‚
>
>   è¿˜å¾—ç»§ç»­åšé¢˜ï¼ŒğŸ’ª
