---
title: æ“ä½œç³»ç»ŸçŸ¥è¯†ç‚¹æ€»ç»“-è¿›ç¨‹åŒæ­¥
tags:
  - åŸºç¡€çŸ¥è¯†
  - æ“ä½œç³»ç»Ÿ
  - è¿›ç¨‹ç®¡ç†
  - è¿›ç¨‹åŒæ­¥
categories:
  - è®¡ç®—æœºåŸºç¡€çŸ¥è¯†
mathjax: true
abbrlink: f95ec2bc
nanoid: f4fVzixBlRMNUo2hF0ph8
date: 2022-09-12 14:10:33
---


## è¿›ç¨‹åŒæ­¥çš„æ¦‚å¿µ

### ä¸´ç•Œèµ„æº

ä¸´ç•Œèµ„æºæŒ‡ä¸€ä¸ªæ—¶é—´æ®µå†…åªå…è®¸ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨çš„èµ„æºï¼ˆäº’æ–¥èµ„æºï¼‰ã€‚

> ä¾‹å¦‚ç‰©ç†è®¾å¤‡ï¼Œå†…å­˜ç¼“å†²åŒºç­‰éƒ½æ˜¯ä¸´ç•Œèµ„æº

åœ¨æ¯ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œè®¿é—®ä¸´ç•Œèµ„æºçš„é‚£éƒ¨åˆ†æŒ‡ä»¤è¢«ç§°ä¸ºä¸´ç•ŒåŒºï¼Œå¯¹ä¸´ç•ŒåŒºçš„è®¿é—®å¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š

```mermaid
sequenceDiagram

participant  entry as è¿›å…¥åŒºåŸŸ 
participant  crisis as ä¸´ç•ŒåŒº 
participant exit as é€€å‡ºåŒº
participant remainder as å‰©ä½™åŒº

loop always
 entry  --> remainder: 
end
```

- **è¿›å…¥åŒº**ï¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œè‹¥å¯ä»¥è¿›å…¥ï¼Œåˆ™è®¾ç½®æ­£åœ¨è®¿é—®ä¸´ç•Œèµ„æºçš„æ ‡å¿—ï¼Œä»¥é˜»æ­¢å…¶ä»–è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºã€‚
- **ä¸´ç•ŒåŒº**ï¼ˆ**ä¸´ç•Œæ®µ**ï¼‰ï¼šè¿›ç¨‹ä¸­è®¿é—®ä¸´ç•ŒåŒºçš„ä¸€æ®µä»£ç ã€‚
- **é€€å‡ºåŒº**ï¼šå°†æ­£åœ¨è®¿é—®ä¸´ç•Œèµ„æºçš„æ ‡å¿—è§£é™¤ã€‚
- **å‰©ä½™åŒº**ï¼šä»£ç ä¸­å…¶ä»–éƒ¨åˆ†ã€‚

<span style="color:red;">ğŸ§¡è¿›å…¥åŒºå’Œé€€å‡ºåŒºè´Ÿè´£å®ç°äº’æ–¥</span>

## åŒæ­¥

**åŒæ­¥**ï¼šäº¦ç§°ä¸º**ç›´æ¥åˆ¶çº¦å…³ç³»**ï¼Œä»–æ˜¯æŒ‡å®ŒæˆæŸç§ä»»åŠ¡è€Œå»ºç«‹çš„**ä¸¤ä¸ªæˆ–å¤šä¸ª**è¿›ç¨‹ï¼Œè¿™äº›è¿›ç¨‹å› ä¸ºéœ€è¦åœ¨æŸäº›ä½ç½®ä¸Šåè°ƒä»–ä»¬çš„å·¥ä½œæ¬¡åºè€Œäº§ç”Ÿçš„åˆ¶çº¦å…³ç³»ã€‚è¿›ç¨‹é—´çš„**ç›´æ¥åˆ¶çº¦å…³ç³»**å°±æ˜¯å› ä¸ºä»–ä»¬çš„ç›¸äº’åˆä½œã€‚

## äº’æ–¥

å¯¹ä¸´ç•Œèµ„æºçš„è®¿é—®ï¼Œ**å¿…é¡»**äº’æ–¥çš„è¿›è¡Œã€‚

äº’æ–¥ï¼šäº¦ç§°**é—´æ¥åˆ¶çº¦å…³ç³»**ï¼Œè¿›ç¨‹äº’æ–¥æŒ‡å½“ä¸€ä¸ªè¿›ç¨‹è®¿é—®ä¸´ç•Œèµ„æºæ—¶ï¼Œå¦ä¸€ä¸ªæƒ³è¦è®¿é—®è¯¥ä¸´ç•Œèµ„æºçš„è¿›ç¨‹å¿…é¡»ç­‰å¾…ã€‚å½“å‰è®¿é—®ä¸´ç•Œèµ„æºçš„è¿›ç¨‹è®¿é—®ç»“æŸã€‚é‡Šæ”¾è¯¥èµ„æºä¹‹åï¼Œå¦ä¸€ä¸ªè¿›ç¨‹æ‰èƒ½å»è®¿é—®ä¸´ç•Œèµ„æºã€‚

### äº’æ–¥çš„åŸåˆ™

- ç©ºé—²è®©è¿›ï¼šä¸´ç•ŒåŒºç©ºé—²æ—¶ï¼Œå¯ä»¥å…è®¸ä¸€ä¸ªè¯·æ±‚è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹ï¼Œç«‹å³è¿›å…¥ä¸´ç•ŒåŒºã€‚
- å¿™åˆ™ç­‰å¾…ï¼šè‹¥å·²æœ‰è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œå…¶ä»–è¯•å›¾è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹å¿…é¡»ç­‰å¾…ã€‚
- æœ‰é™ç­‰å¾…ï¼šå¯¹è¯·æ±‚è®¿é—®çš„è¿›ç¨‹ï¼Œå› ä¿è¯èƒ½åœ¨æœ‰é™æ—¶é—´å†…è¿›å…¥ä¸´ç•ŒåŒºï¼ˆä¿è¯ä¸é¥¥é¥¿ï¼‰
- è®©æƒç­‰å¾…ï¼šå½“è¿›ç¨‹ä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œåº”ç«‹åˆ»é‡Šæ”¾å¤„ç†æœºï¼Œé˜²æ­¢è¿›ç¨‹å¿™ç­‰å¾…ã€‚

> ä¸€å¥è¯ï¼Œå°±æ˜¯ **ï¼ˆå¤„ç†æœºorèµ„æºï¼‰ç‰©å°½å…¶ç”¨**ï¼Œ**(èƒ½åŠ›orèµ„æº)ä¸å¤Ÿå°±ç­‰**

## ä¸´ç•ŒåŒºäº’æ–¥çš„å®ç°

### å•æ ‡å¿—æ³•

ä¸€ä¸ªè¿›ç¨‹åœ¨è®¿é—®å®Œä¸´ç•ŒåŒºåä¼šæŠŠä¸´ç•ŒåŒºèµ„æºçš„æƒé™äº¤ç»™å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªè¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºçš„æƒé™åªèƒ½ç”±å‰è¾ˆï¼ˆå¦ä¸€ä¸ªç¨‹åºèµ‹äºˆï¼‰

```cpp
int turn = 0;
void p0 (){
    while (turn != 0);
    critical section;
    turn = 1;
    remainder section;
}
void p1(){
    while(turn != 1);
    critical section;
    turn = 0;
    remainder section;
}

```

å°±å¦‚åŒå•é”ä¸€æ ·ï¼Œè‡ªå·±åœ¨ç”¨çš„æ—¶å€™ï¼Œå…¶ä»–è¿›ç¨‹å°±ä¸èƒ½ç”¨ï¼Œè‡ªå·±ç”¨å®Œäº†ï¼Œç«‹é©¬å°±æŠŠå æœ‰æƒç»™äººå®¶ã€‚

> å¥½æ¯”å¦‚ï¼šç°åœ¨æ˜¯æ¡Œä¸Šåªæœ‰ä¸€åŒç­·å­ï¼Œæœ‰Aè·ŸBä¸¤ä¸ªäººï¼Œä¸€å¼€å§‹å…ˆæŠŠç­·å­ç»™Aï¼ŒAåƒå®Œåç›´æ¥å°±æŠŠç­·å­æ´—å¹²å‡€ç»™Bäº†ï¼Œç„¶åè¯´ä½ åƒå®Œå†æŠŠç­·å­æ´—å¹²å‡€ç»™æˆ‘ï¼Œç»“æœBæ— è¯­äº†ï¼Œä»–ä¹Ÿæ²¡è¯´è¦ç”¨ç­·å­åƒä¸œè¥¿ï¼Œç„¶åAå°±æ˜¯è¯´ä¸ç®¡ï¼Œä½ å¿…é¡»åƒå®Œè¿‡åå†æŠŠç­·å­ç»™æˆ‘ï¼Œç»“æœAè‡ªå·±åˆæƒ³åƒçš„æ—¶å€™ç»“æœæ²¡æœ‰ç­·å­ç”¨ï¼Œå› ä¸ºç­·å­è¿˜åœ¨Bé‚£é‡Œå‘¢ï¼ŒBè¿˜åœ¨çº³é—·Aæ€•ä¸æ˜¯æœ‰ä»€ä¹ˆå¤§ç—…ã€‚
> è¯¥æ¯”å–»æ¥è‡ª CSDNã€Œå«æˆ‘è˜‘è‡å…ˆç”Ÿã€çš„[åŸåˆ›æ–‡ç« ](https://blog.csdn.net/weixin_43305485/article/details/120754983)

### åŒæ ‡å¿—å…ˆæ£€æŸ¥æ³•

è®¾ç½®ä¸€ä¸ªæ•°ç»„ï¼Œç›¸åº”å…ƒç´ æ ‡è¯†è¿›ç¨‹è®¿é—®çš„èµ„æºçš„æ„æ„¿ã€‚

```cpp
bool flag[] = {false,false};

void p0(){
 // æˆ–è€… ç”¨ if (flag[1]) return ;
 //å¤§æŠµå°±æ˜¯ï¼Œå¦‚æœ 1 å æœ‰çš„æ—¶å€™ï¼Œå°±ä¸ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ï¼Œ
    while (flag[1]);
    // è¡¨æ˜è‡ªå·±åœ¨å æœ‰
    flag[0] = true;
    // æ‹¿åˆ°ä¸´ç•ŒåŒºèµ„æº
    critical section;
    // è‡ªå·±ç”¨å¥½äº†
    flag[0] = true;
    // é€€å›èµ„æº
    remaider section;
}
void p1(){
    while(flag[0]);
    flag[1] = true;
    // æ‹¿åˆ°ä¸´ç•ŒåŒºèµ„æº
    critical section;
    // è‡ªå·±ç”¨å¥½äº†
    falg[1] = false;
 // é€€å›èµ„æº
    remaider section;
}
```

ç›¸å½“äºæ—¶å„è‡ªç­‰å¾…åˆ«äººè¡¨æ€ï¼Œå¦‚æœåˆ«äººä¸ç”¨äº†ï¼Œè‡ªå·±å†ç”¨ï¼›å¯èƒ½**è¿èƒŒå¿™åˆ™ç­‰å¾…**çš„åŸåˆ™ã€‚

> å¥½æ¯”å¦‚ï¼šç°åœ¨åŒæ ·æ˜¯æ¡Œä¸Šåªæœ‰ä¸€åŒç­·å­ï¼Œæœ‰Aè·ŸBä¸¤ä¸ªäººï¼Œä½†æ˜¯ç°åœ¨è¿™ä¸¤ä¸ªäººä¼šå¯Ÿè¨€è§‚è‰²äº†ï¼Œä¼šå…ˆçœ‹å¯¹æ–¹ä¼šä¸ä¼šæƒ³è¦å…ˆç”¨ç­·å­ï¼Œç„¶åå†åˆ¤æ–­ä¸‹ä¸€æ­¥æ˜¯ä½¿ç”¨ç­·å­è¿˜æ˜¯æ¥ç€ç­‰å¾…ã€‚ä¸€å¼€å§‹ï¼Œä¸¤ä¸ªäººéƒ½ä¸è¯´è‡ªå·±æƒ³ä¸æƒ³ç”¨ç­·å­ï¼Œå°±ç­‰å¯¹æ–¹å…ˆè¡¨æ€ï¼Œæ¯•ç«Ÿè¦å¤šè°¦è®©ï¼Œæœ€åå½¼æ­¤çœ‹è¿™ä¹ˆä¹…éƒ½ä¸è¯´è¯ï¼Œä¼°è®¡å°±æ˜¯ä¸æƒ³ç”¨äº†ï¼Œç„¶åå½¼æ­¤éƒ½é»˜è®¤å¯¹æ–¹ä¸æƒ³ç”¨ç­·å­ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°é—®é¢˜äº†ï¼Œä¸¤ä¸ªäººéƒ½é»˜è®¤å½¼æ­¤ä¸æƒ³ç”¨ç­·å­ï¼Œç„¶åè‡ªå·±å°±ä¸‹æ„è¯†å»æ‹¿ç­·å­ï¼Œç»“æœåˆšå¥½å¯¹æ–¹ä¹Ÿæƒ³ç”¨ï¼Œè¿™å°±å°´å°¬äº†ï¼Œé‚£æœ€åæ˜¯è°ç”¨å‘¢ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°èµ„æºè¢«åŒæ—¶è®¿é—®çš„é—®é¢˜ã€‚
>
> è¯¥æ¯”å–»æ¥è‡ª CSDNã€Œå«æˆ‘è˜‘è‡å…ˆç”Ÿã€çš„[åŸåˆ›æ–‡ç« ](https://blog.csdn.net/weixin_43305485/article/details/120754983)

------------------------------------------------

### åŒæ ‡å¿—åæ£€æŸ¥æ³•

ç›¸æ¯”äºåŒæ ‡å¿—å…ˆæ£€æŸ¥æ³•ï¼Œæ­¤ç®—æ³•å…ˆä¿®æ”¹è‡ªå·±çš„ä¸€å‘˜ï¼Œå†è¿›è¡Œæ£€æŸ¥ã€‚

```cpp
bool flag[] = { false,false};

void wait(bool &which){
    while(which);
}

void p0(){
    flag[0] = true;
    wait(flag[1]);
    critical section;
 flag[0] = false;
    remainder section;
}
void p1(){
    flag[1] = true;
    wait(flag[0]);
    critical section;
 flag[1] = false;
    remainder section;
}
```

è¿™ä¸€ç®—æ³•è§£å†³äº†â€œå¿™åˆ™ç­‰å¾…â€çš„é—®é¢˜ï¼Œä½†æ˜¯è‹¥ä¸¤ä¸ªè¿›ç¨‹åŒæ—¶æ ‡è®°ä¸ºtrueï¼Œåˆä¼šç›¸äº’ç­‰å¾…é€ æˆ**é¥¥é¥¿**ï¼Œè¿èƒŒäº†â€œ**ç©ºé—²è®©è¿›**â€å’Œâ€œ**æœ‰é™ç­‰å¾…**â€åŸåˆ™ã€‚

> å¥½æ¯”å¦‚ï¼šç°åœ¨è¿˜æ˜¯æ¡Œä¸Šåªæœ‰ä¸€åŒç­·å­ï¼Œä½†æ˜¯ç°åœ¨å°±ä¸æ˜¯Aè·ŸBäº†ï¼Œæ¢æˆå­”è1å·å’Œå­”è2å·ï¼Œä¸ºä»€ä¹ˆç»™ä»–ä»¬è¿™æ ·å–åå­—å‘¢ï¼Œåé¢å°±çŸ¥é“å•¦ï¼ç°åœ¨è¿™ä¸¤ä¸ªäººå‘¢ï¼Œåœ¨æƒ³ç”¨ç­·å­çš„æ—¶å€™éƒ½ä¼šå…ˆè¯´å‡ºæ¥è¡¨æ˜è‡ªå·±çš„æ€åº¦ï¼Œç„¶åå†çœ‹å¯¹æ–¹ä¼šä¸ä¼šæƒ³è¦å…ˆç”¨ç­·å­ï¼Œç„¶åå†åˆ¤æ–­ä¸‹ä¸€æ­¥æ˜¯ä½¿ç”¨ç­·å­è¿˜æ˜¯æ¥ç€ç­‰å¾…ã€‚å¦‚æœä¸€å¼€å§‹ä¸¤ä¸ªäººåŒæ—¶è¡¨æ˜è‡ªå·±æƒ³è¦ç­·å­çš„è¯ï¼Œå¯¹æ–¹éƒ½ä¼šè€ƒè™‘åˆ°ç¤¼ä»ªé—®é¢˜ï¼Œè°¦è®©ç»™å¯¹æ–¹ç”¨ï¼Œæ¯•ç«Ÿè°å«ä»–ä»¬å«å­”èå‘¢ï¼Œä½†æ˜¯è¿™æ ·å‡ºç°çš„é—®é¢˜å°±æ˜¯æ˜æ˜æœ‰ç­·å­å¯ä»¥ç”¨ä½†æ˜¯å› ä¸ºè°¦è®©è€ŒåƒµæŒä½ã€‚ç»“æœä¸¤ä¸ªäººå°±åªèƒ½é¥¿ç€äº†ï¼Œåœ¨æ“ä½œç³»ç»Ÿé‡Œé¢è¿™é‡Œå°±å‡ºç°äº†"æ­»ç­‰"ï¼Œå³ä¼šå­˜åœ¨è¿›ç¨‹äº§ç”Ÿ"é¥¥é¥¿"ã€‚
>
> è¯¥æ¯”å–»æ¥è‡ª CSDNã€Œå«æˆ‘è˜‘è‡å…ˆç”Ÿã€çš„[åŸåˆ›æ–‡ç« ](https://blog.csdn.net/weixin_43305485/article/details/120754983)

------------------------------------------------

### Peterson ç®—æ³•

åŸºæœ¬æ€è·¯ï¼šè®¾ç½®ä¸€ä¸ªæ•°ç»„`flag[2]`ï¼Œè¿™é‡Œä¸å‰é¢ä¸åŒä¹‹å¤„ï¼Œå…ˆè®¾ç½®è‡ªå·±çš„æ ‡å¿—ä½ï¼Œå†æ£€æŸ¥å¯¹æ–¹çš„æ ‡å¿—çŠ¶æ€ï¼Œè‹¥å¯¹æ–¹çš„æ ‡å¿—ä½ä¸º `true`ï¼Œå†æ£€æŸ¥å¯¹æ–¹çš„æ ‡å¿—çŠ¶æ€ï¼Œè‹¥å¯¹æ–¹çš„æ ‡å¿—ä½ä¸º `true` åˆ™ç­‰å¾…ï¼Œ

```cpp
bool flag[] = {false,false};
int turn = 0;

void p0(){
    flag[0] = true;              //æ ‡è®°P0å¸Œæœ›è¿›å…¥ä¸´ç•ŒåŒº
 turn = 1;
    
 wait(flag[1] && turn == 1);
    critical section;
    flag[0] = true;
    remainder section;
}
void p1(){
    flag[1] = true;
    turn = 0;
    
    wait(flag[0] && turn == 0);
    critical section;
    flag[1] = false;
    remainder section;
}
```

> æ­¤ç®—æ³•åˆ©ç”¨flag[ ]å®ç°äº†ä¸´ç•Œèµ„æºçš„**äº’æ–¥è®¿é—®**ï¼Œå¹¶ç”¨**turn**è§£å†³äº†â€œ**é¥¥é¥¿**â€ç°è±¡ï¼›
>
> éµå¾ªäº†ç©ºé—²è®©è¿›ã€å¿™åˆ™ç­‰å¾…å’Œæœ‰é™ç­‰å¾…åŸåˆ™ï¼›
>
> ä½†æ˜¯**æ²¡æœ‰éµå¾ªè®©æƒç­‰å¾…åŸåˆ™**ï¼ˆéœ€è¦åœ¨CPUä¸Šä¸æ–­å¾ªç¯æ£€æµ‹ï¼‰ã€‚

## ç¡¬ä»¶å®ç°

### ä¸­æ–­å±è”½æ–¹æ³•

åˆ©ç”¨å¼€å…³ä¸­æ–­çš„æ–¹å¼å®ç°

```mermaid
graph TB
close(å…³ä¸­æ–­)
critical(ä¸´ç•ŒåŒº)
open(å¼€ä¸­æ–­)
close--"å…³ä¸­æ–­ä¹‹åä¸å…è®¸å½“å‰è¿›ç¨‹è¢«å…³é—­"-->critical-->open
```

#### ä¼˜ç‚¹

- ç®€æ´ï¼Œé«˜æ ¡

#### ç¼ºç‚¹

- ä¸é€‚ç”¨äºå¤šå¤„ç†æœº

- åªé€‚ç”¨äºæ“ä½œç³»ç»Ÿå†…æ ¸è¿›ç¨‹ï¼ˆå¼€å…³ä¸­æ–­åªèƒ½åœ¨å†…æ ¸æ‰§è¡Œï¼‰

### TSL(TestAndSet)æŒ‡ä»¤

**TS/TSL** æŒ‡ä»¤æ—¶ç”¨**ç¡¬ä»¶**å®ç°çš„ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸å…è®¸è¢«ä¸­æ–­ã€‚

```cpp
bool lock;  //å…±äº«å˜é‡è¡¨ç¤ºä¸´ç•Œèµ„æºæ˜¯å¦ä¸Šé”

bool TSL(bool &g_lock){
    bool old = g_lock;
    g_lock = true;   //æ— è®ºä¹‹å‰æ˜¯å¦ä¸Šé”ï¼Œå°†lockè®¾ç½®ä¸ºtrue
    return old; //è¿”å›ä¹‹å‰lockçš„å€¼
}
void p0(){
    while (TSL(lock));//è‹¥å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œåˆ™è¿›å…¥å¾ªç¯
    critical section;
    lock = false;  //ä¸ºä¸´ç•Œèµ„æºè§£é”
    remainder section;
}

```

### ä¼˜ç‚¹

- å®ç°ç®€å•
- é€‚ç”¨äºå¤šå¤„ç†æœºç¯å¢ƒ

#### ç¼ºç‚¹

- ä¸æ»¡è¶³è®©æƒç­‰å¾…åŸåˆ™ï¼Œæš‚æ—¶æ— æ³•è¿›å…¥ä¸´ç•ŒåŒºçš„èµ„æºä»»ç„¶ä¼šå ç”¨ **CPU** å¹¶å¾ªç¯æ‰§è¡Œ `TS` æŒ‡ä»¤ï¼Œå¯¼è‡´**â€œå¿™ç­‰â€**

### Swap æŒ‡ä»¤

ä¹Ÿç§°ä¹‹ä¸º **Exchange** æŒ‡ä»¤ï¼Œæˆ–è€…ç®€ç§° **XCHG**ã€‚

è¯¥æŒ‡ä»¤å’Œ **TSL** ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨ç¡¬ä»¶å®ç°çš„ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸å…è®¸è¢«ä¸­æ–­ã€‚

```cpp
bool lock;

void Swap(bool &a,bool &b) {
    a = a^b;
    b = a^b;
    a = a^b;
}
bool old = true;

void p0(){
    while (old== true) Swap(old,lock);
    critical section;
    lock = false;
    remainder section;
}


```

å…¶åŸç†ï¼Œä¼˜ç¼ºç‚¹å’Œ **TSL** ç±»ä¼¼ã€‚

## ğŸ”’é”ï¼ˆè‡ªæ—‹é”ğŸ”’ï¼‰

è§£å†³ä¸´ç•ŒåŒºæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯é”ã€‚è¿›ç¨‹åœ¨è¿›å…¥ä¸´ç•ŒåŒºæ—¶è·å¾—é”ï¼Œé€€å‡ºä¸´ç•ŒåŒºæ—¶é‡Šæ”¾é”ã€‚

```cpp
bool locked;//è®¾ç½®æ˜¯å¦è¢«é”çš„çŠ¶æ€ true,å·²é”ï¼Œ false,æœªé”

void lock(){
    if (locked) return; // æ²¡æœ‰ä¸Šé”å°±ä¸ç®¡
    
    lock = true; // åŠ é”
 wait_unlock(); // åšä¸€äº›ä¸œè¥¿ï¼Œåšå®Œä¹‹åå°± unlock
}

void unlock (){
    // è§£é”
    locked = false;
}

// or 
bool available;
// è·å¾—é”
void acquire(){
    while(!available); //å¿™ç­‰é”ï¼Œæ³¨æ„å’Œ nodejs ä¸ä¸€æ ·ï¼Œnodejs çš„è¯å°±ç›´æ¥å¡åœ¨è¿™é‡Œè¶…æ—¶äº†ï¼Œè€Œè¿™é‡Œä¸»è¦è€ƒè™‘çš„æ˜¯ï¼Œå–”ï¼Œå®æµ‹è¿™ç©æ„åœ¨ CPP ä¹Ÿå¯„ï¼Œä¼°è®¡è¿™ç©æ„éœ€è¦ç”¨åœ¨å¤šå¤„ç†å™¨ä¹‹é—´ï¼Œå—¯ï¼Œå¯¹ï¼Œè¿™é‡Œå°±æ˜¯è®¨è®ºçš„ä¸åŒè¿›ç¨‹ä¹‹é—´ã€‚
    available = false; //è·å¾—é”
}

// é‡Šæ”¾é”
void release(){
    available = true; //é‡Šæ”¾é”
}

// åŒç¬¬ä¸€ç§ä¸€æ ·ï¼ŒæŠŠé‡Šæ”¾åŠ é”æ”¾åˆ°ä¸­é—´æ›´åŠ è‡ªç„¶ï¼Œå°±ä¸è¦ä¸€ç›´ while;
```

ä¸Šé”å’Œè§£é”å¿…é¡»æ—¶åŸå­æ“ä½œã€‚

### ä¼˜ç‚¹

- ç­‰å¾…å™¨ä»¶ä¸ç”¨åˆ‡æ¢è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Œå¤šæ ¸å¤„ç†å™¨ä¸­è‹¥ä¸Šé”çš„æ—¶é—´å¾ˆçŸ­ï¼Œåˆ™ç­‰å¾…ä»£ä»·å¾ˆä½ã€‚
- å¸¸ç”¨äºå¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œä¸€ä¸ªæ ¸å¿™ç­‰å¾…ï¼Œå…¶ä»–æ ¸æ­£å¸¸å·¥ä½œï¼Œå¹¶å¿«é€Ÿé‡Šæ”¾ä¸´ç•ŒåŒºã€‚

### ç¼ºç‚¹

- éœ€è¦å¿™ç­‰ï¼Œè¿›ç¨‹æ—¶é—´ç‰‡ç”¨å®Œæ‰é‡Šæ”¾å¤„ç†æœºèµ„æºï¼Œè¿åäº†â€œ**è®©æƒç­‰å¾…**â€
- ä¸é€‚ç”¨äºå•å¤„ç†æœºç³»ç»Ÿï¼Œå¿™ç­‰è¿‡ç¨‹ä¸å¯è§£é”ã€‚

## ä¿¡å·é‡

ä¿¡å·é‡æ˜¯ä¸€ç§åŠŸèƒ½è¾ƒå¼ºçš„æœºåˆ¶ï¼Œå¯ç”¨äºè§£å†³äº’æ–¥ä¸åŒæ­¥é—®é¢˜ã€‚ä»–åªèƒ½è¢«ä¸¤ä¸ªæ ‡å‡†åŸè¯­ â€œ**Walit(S)**â€ å’Œ **â€œSignal(S)â€**è®¿é—®ï¼Œä¹Ÿè¢«è®°ä½œ â€œ**Pæ“ä½œ**â€ â€œ**Væ“ä½œ**â€ã€‚

> :information_source:åœ¨è·å…°æ–‡ä¸­ï¼Œé€šè¿‡å«passerenï¼Œé‡Šæ”¾å«vrijgevenï¼ŒPVæ“ä½œå› æ­¤å¾—å

### æ•´å‹ä¿¡å·é‡

:rotating_light:ä¸€ä¸ªæ•´å‹çš„å˜é‡ä½œä¸ºä¿¡å·é‡ï¼Œç”¨æ¥æ ‡è¯†ç³»ç»Ÿä¸­æŸç§èµ„æºçš„æ•°é‡ã€‚

ä¸æ™®é€šæ•´å‹å˜é‡ç›¸æ¯”ï¼Œä¿¡å·é‡åªæœ‰ä¸‰ç§åŸå­æ“ä½œ: **åˆå§‹åŒ–**ã€**P æ“ä½œ**ã€**V æ“ä½œ**ã€‚

```cpp
int S = 1;

void wait () {    //waitåŸè¯­ï¼Œç›¸å½“äºè¿›å…¥åŒº
    while ( S <= 0 ) ; //è‹¥èµ„æºä¸å¤Ÿï¼Œåˆ™ä¸€ç›´ç­‰å¾…
    S = S - 1;   //è‹¥èµ„æºå¤Ÿï¼Œåˆ™ä½¿ç”¨/æ¶ˆè€—è¿™ä¸ªèµ„æº
}
void signal(){ // signal åŸè¯­
    S = S + 1; // é‡Šæ”¾èµ„æº
}

```

ç”±äº **Pæ“ä½œ** ä¸­èµ„æºä¸å¤Ÿæ—¶ä¼šä¸€ç›´ç­‰å¾…ï¼Œæ‰€ä»¥ä¸èƒ½æ»¡è¶³è®©æƒç­‰å¾…ï¼Œä¼šå‘ç”Ÿ**å¿™ç­‰**ã€‚

### è®°å½•å‹ä¿¡å·é‡

```cpp
typedef struct {
    int value;
    struct process *L;
} semapher;
```

åœ¨è®°å½•å‹å˜é‡ä¸­ï¼Œé™¤äº†ä»£è¡¨èµ„æºæ•°é‡çš„ **value** ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªè¿›ç¨‹é“¾è¡¨ **L**ã€‚

```cpp
void wait(semapher S) {
    S.value --;
    if (S.value < 0) {
        block(S.L);// èµ„æºæ•°é‡ä¸è¶³ï¼Œåˆ™ä½¿ç”¨blockåŸè¯­å°†è¿›ç¨‹é˜»å¡ï¼Œå¹¶åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¹‹ä¸­
    }
} 

void signal(semapher S){
    S.value ++;
    if ( S.value <=0 ){
        wakeup(S.L);  //è‹¥é‡Šæ”¾èµ„æºåå¯è¿˜æœ‰è¿›ç¨‹åœ¨ç­‰å¾…ï¼Œåˆ™å”¤é†’è¯¥è¿›ç¨‹ï¼Œä½¿å…¶ä»é˜»å¡æ€å˜ä¸ºå°±ç»ªæ€
    }
}
```

æ­¤æœºåˆ¶éµå¾ªäº†è®©æƒç­‰å¾…åŸåˆ™ï¼Œä¸ä¼šå‘ç”Ÿâ€œ**å¿™ç­‰**â€ã€‚

## ç”¨ä¿¡å·é‡å®ç°è¿›ç¨‹åŒæ­¥ã€äº’æ–¥

### è¿›ç¨‹äº’æ–¥

äº’æ–¥çš„é‡ç‚¹å…¶å®å°±æ˜¯ä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹è®¿é—®ï¼Œé‚£ä¹ˆè¿™æ ·çš„è¯å…¶å®å°±æ˜¯åŠ é”ï¼Œä¸Šé”çš„è¿‡ç¨‹ã€‚æ‰€ä»¥ PV ä¼šæˆå¯¹å‡ºç°ã€‚

```cpp
semaphore mutex = 1;
void P1 (){
    do_something();
    P(mutex); // ç”³è¯·è¿›å…¥ä¸´ç•ŒåŒº
    critical section ;// è·å¾—ä¸´ç•ŒåŒºèµ„æº
    V(mutex); // é‡Šæ”¾èµ„æº
   do_something();
}

void P2 (){
    do_something();
    P(mutex); // ç”³è¯·è¿›å…¥ä¸´ç•ŒåŒº
    critical section ;// è·å¾—ä¸´ç•ŒåŒºèµ„æº
    V(mutex); // é‡Šæ”¾èµ„æº
   do_something();
}
```

:information_source: å¯ä»¥ç†è§£ä¸ºæ­¤ä¿¡å·é‡è¡¨ç¤ºè¿›å…¥ä¸´ç•ŒåŒºçš„åé¢ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªã€‚

> :rotating_light: éœ€è¦ä¸ºä¸åŒçš„ä¸´ç•Œèµ„æºè®¾ç½®ä¸åŒçš„äº’æ–¥ä¿¡å·é‡,PV æ“ä½œå¿…é¡»æˆå¯¹å‡ºç°ã€‚

### è¿›ç¨‹åŒæ­¥

```cpp
semphore S = 0;
void P1(){
   do_something(1);
   do_something(2);
   V(S);
   do_something(3);
}
void P2 (){
    P(S);
 do_something(4);    
 do_something(5);    
 do_something(6);    
}

```

åªæœ‰ `do_something`1å’Œ2 æ‰§è¡Œå®Œæ¯•ï¼Œä¸”è¿›è¡Œäº†**Væ“ä½œ**ä¹‹åï¼Œè¿›ç¨‹2ä¸­çš„**Pæ“ä½œ**æ‰ä¸ä¼šé˜»å¡ï¼Œå¹¶ä¸”èƒ½å¤Ÿç»§ç»­æ‰§è¡Œä¸‹å»ã€‚

## ä¿¡å·é‡å®ç°å‰é©±å…³ç³»

```mermaid
graph TB
%%{init:{'theme':'forest'}}%%


s1((S1))
s2((S2))
s2((S2))
s3((S3))
s4((S4))
s5((S5))
s6((S6))

s1--a=0-->s2
s1--b=0-->s3
s3--c=0-->s6
s2--d=0-->s4
s2--e=0-->s5
s4--f=0-->s6
s5--g=0-->s6

linkStyle 0,1,2,3,4,5,6 stroke:#7BCCAC,stroke-width:4px;

```

1. éœ€è¦ä¸ºæ¯ä¸€å¯¹å‰å»å…³ç³»è®¾ç½®ä¸€ä¸ªåŒæ­¥ä¿¡å·é‡

2. åœ¨å‰æ“ä½œä¹‹åå¯¹ç›¸åº”çš„åŒæ­¥ä¿¡å·é‡æ‰§è¡Œ **V æ“ä½œ**
3. åœ¨åæ“ä½œä¹‹å‰å¯¹ç›¸åº”çš„åŒæ­¥ä¿¡å·é‡æ‰§è¡Œ **P æ“ä½œ**

```cpp

void P1(){
    // æ‰§è¡Œ S1 å†…å®¹
    S1;
    // V æ“ä½œå¯ä»¥è®¤ä¸ºæ˜¯æ”¾å›ç»“æœï¼Œæ”¾å›å…±äº«èµ„æº
    V(a); // or signal(a);
    V(b); // or signal(b);
}


void P2(){
    P(a);
    // æ‰§è¡Œ S2 å†…å®¹
    S2;
    // V æ“ä½œå¯ä»¥è®¤ä¸ºæ˜¯æ”¾å›ç»“æœï¼Œæ”¾å›å…±äº«èµ„æº
    V(d); // or signal(a);
    V(e); // or signal(b);
}


void P3(){
    P(b);
    // æ‰§è¡Œ S3 å†…å®¹
    S3;
    // V æ“ä½œå¯ä»¥è®¤ä¸ºæ˜¯æ”¾å›ç»“æœï¼Œæ”¾å›å…±äº«èµ„æº
 V(c);
}
void P4(){
    // æ‰§è¡Œ S1 å†…å®¹
    P(d);
    S4;
    // V æ“ä½œå¯ä»¥è®¤ä¸ºæ˜¯æ”¾å›ç»“æœï¼Œæ”¾å›å…±äº«èµ„æº
 V(f);
}

void P5(){
    P(e);
    // æ‰§è¡Œ S5 å†…å®¹
    S5;
    // V æ“ä½œå¯ä»¥è®¤ä¸ºæ˜¯æ”¾å›ç»“æœï¼Œæ”¾å›å…±äº«èµ„æº
 V(g);
}
    
void P6(){
    P(c);
    P(f);
    P(g);
    // æ‰§è¡Œ S1 å†…å®¹
    S6;
}
```

> :vertical_traffic_light: ä¸ªäººç†è§£ï¼šå…¶å®è¿™ç©æ„å°±æ˜¯ AOV æ‹“æ‰‘æ’åºï¼Œå…·ä½“åº”ç”¨æœ‰ç‚¹åƒå…±äº«å˜é‡æ±‚å’Œã€‚å…±äº«èµ„æºçš„ä½ç½®å°±åƒå¯„å­˜å™¨ä¸€æ ·ï¼Œä¿å­˜æ“ä½œç»“æœï¼Œç„¶å **P** å–å‡ºï¼Œ**V** æ”¾å…¥ã€‚

## ç®¡ç¨‹

[ä¿¡å·é‡æœºåˆ¶](https://baike.baidu.com/item/ä¿¡å·é‡æœºåˆ¶/9175303)çš„ç¼ºç‚¹ï¼šè¿›ç¨‹è‡ªå¤‡[åŒæ­¥](https://baike.baidu.com/item/åŒæ­¥/984802)æ“ä½œï¼ŒP(S)å’ŒV(S)æ“ä½œå¤§é‡åˆ†æ•£åœ¨å„ä¸ªè¿›ç¨‹ä¸­ï¼Œä¸æ˜“ç®¡ç†ï¼Œæ˜“å‘ç”Ÿæ­»é”ã€‚1974å¹´å’Œ1977å¹´ï¼ŒHoreå’ŒHansenæå‡ºäº†ç®¡ç¨‹ã€‚

> è¿™ç©æ„è¿˜æ˜¯çœ‹å›½å¤–çš„å§ :face_with_head_bandage:ï¼Œå›½å†…åè¯ç®¡ç¨‹ï¼Œè«åå…¶å¦™çš„

Monitors are a programming language component that aids in the regulation of shared data access. The Monitor is a package that contains shared data structures, operations, and synchronization between concurrent procedure calls. Therefore, a monitor is also known as a synchronization tool. **Java, C#, Visual Basic, Ada, and concurrent Euclid** are among some of the languages that allow the use of monitors. Processes operating outside the monitor can't access the monitor's internal variables, but they can call the monitor's procedures.

**ç®¡ç¨‹**æ˜¯ä¸€ç§å¸®åŠ©ç®¡ç†å…±äº«æ•°æ®è®¿é—®ç¼–ç¨‹è¯­è¨€ ç»„ä»¶/åŒ…ã€‚ Monitor æ˜¯åŒ…å«å…±äº«æ•°æ®ç»“æ„ã€æ“ä½œå’Œå¹¶å‘è¿‡ç¨‹è°ƒç”¨ä¹‹é—´çš„åŒæ­¥å¤„ç†çš„åŒ…ã€‚ å› æ­¤ï¼Œ**ç®¡ç¨‹**ä¹Ÿç§°ä¸ºåŒæ­¥å·¥å…·ã€‚ **Javaã€C#ã€Visual Basicã€Ada å’Œ concurrent Euclid** éƒ½æ˜¯ä¸€äº›å…è®¸ä½¿ç”¨**ç®¡ç¨‹**çš„ç¼–ç¨‹è¯­è¨€ã€‚ åœ¨**ç®¡ç¨‹**ä¹‹å¤–è¿è¡Œçš„è¿›ç¨‹ä¸å…è®¸è®¿é—®**ç®¡ç¨‹**çš„å†…éƒ¨å˜é‡ï¼Œä½†å®ƒä»¬å¯ä»¥è°ƒç”¨**ç®¡ç¨‹**çš„è¿‡ç¨‹ã€‚

**For example**, synchronization methods like the wait() and notify() constructs are available in the Java programming language.

**ä¾‹å¦‚**ï¼Œ**Java** ç¼–ç¨‹è¯­è¨€ä¸­æä¾›äº†è¯¸å¦‚ wait() å’Œ notify() æ„é€ ç±»çš„åŒæ­¥æ–¹æ³•

### Syntax of monitor in OSï¼ˆæ“ä½œç³»ç»Ÿä¸­çš„ç®¡ç¨‹ï¼‰

Monitor in os has a simple syntax similar to how we define a class, it is as follows:ï¼ˆè¿™å¥å°±ä¸ç¿»è¯‘äº†ï¼‰

```java
Monitor monitorName{
    variables_declaration;
    condition_variables;
    
    procedure p1{ ... };
    procedure p2{ ... };
    ...
    procedure pn{ ... };
    
    {
        initializing_code;
    }
    
}
```

### Characteristics of Monitors in OSï¼ˆç®¡ç¨‹çš„ç‰¹å¾ï¼‰

A monitor in os has the following characteristics:

- We can only run one program at a time inside the monitor.
- Monitors in an operating system are defined as a group of methods and fields that are combined with a special type of package in the os.
- A program cannot access the monitor's internal variable if it is running outside the monitor. Although, a program can call the monitor's functions.
- Monitors were created to make synchronization problems less complicated.
- Monitors provide a high level of synchronization between processes.

ä¸€ä¸ªç®¡ç¨‹åº”è¯¥æœ‰ä»¥ä¸‹å‡ ç§ç‰¹å¾ï¼š

- åªèƒ½åœ¨**ç®¡ç¨‹**å†…åŒæ—¶è¿è¡Œä¸€ä¸ªç¨‹åºã€‚
- æ“ä½œç³»ç»Ÿä¸­çš„**ç®¡ç¨‹**è¢«å®šä¹‰ä¸ºä¸€ç»„æ–¹æ³•å’Œå­—æ®µï¼Œå®ƒä»¬ä¸æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„åŒ…ç»“åˆä½¿ç”¨ã€‚
- åœ¨**ç®¡ç¨‹**å¤–éƒ¨è¿è¡Œçš„ç¨‹åº**ä¸å…è®¸**è®¿é—®**ç®¡ç¨‹**å†…éƒ¨å˜é‡ï¼Œå“ªæ€•æ˜¯ä¸€ä¸ªèƒ½è°ƒç”¨ç®¡ç¨‹å‡½æ•°çš„ç¨‹åºä¹Ÿ å“’å’© :face_with_head_bandage:
- **ç®¡ç¨‹**çš„å‡ºç°æ˜¯ä¸ºäº†ä½¿åŒæ­¥é—®é¢˜ä¸é‚£ä¹ˆå¤æ‚
- **ç®¡ç¨‹**åœ¨è¿›ç¨‹ä¹‹é—´æä¾›ä¸€ä¸ª**é«˜çº§**åŒæ­¥

### Components of Monitor in an operating system(ç®¡ç¨‹çš„ç»„æˆ)

The monitor is made up of four primary parts:

1. **Initialization:** The code for initialization is included in the package, and we just need it once when **creating the monitors**.
2. **Private Data:** It is a feature of the monitor in an operating system to make the data private. It holds all of the monitor's secret data, which includes private functions that may only be utilized within the monitor. As a result, private fields and functions are not visible outside of the monitor.
3. **Monitor Procedure:** Procedures or functions that can be invoked from outside of the monitor are known as **monitor procedures**.
4. **Monitor Entry Queue:** Another important component of the monitor is the Monitor Entry Queue. It contains all of the threads, which are commonly referred to as procedures only.

ç®¡ç¨‹ç”±ä»¥ä¸‹å››ä¸ªåŸºæœ¬éƒ¨åˆ†æ„æˆï¼š

1. **åˆå§‹åŒ–ï¼š**åˆå§‹åŒ–ç®¡ç¨‹çš„æŒ‡ä»¤åœ¨åŒ…ä¸­ï¼Œåªéœ€è¦åœ¨**åˆ›å»ºç®¡ç¨‹æ—¶**è°ƒç”¨ä¸€æ¬¡ã€‚

2. **ç§æœ‰æ•°æ®ï¼š** å°†æ•°æ®ç§æœ‰åŒ–æ˜¯ç®¡ç¨‹çš„ä¸€ä¸ªåŠŸèƒ½ã€‚å®ƒå­˜å‚¨äº†ç®¡ç¨‹ä¸­æ‰€æœ‰ç§æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬åªç®¡ç¨‹å†…ä½¿ç”¨çš„ç§æœ‰å‡½æ•°ã€‚æ‰€ä»¥ï¼Œç§æœ‰å­—æ®µå’Œå‡½æ•°åœ¨ç®¡ç¨‹ä¹‹å¤–æ˜¯ä¸å¯è§çš„ã€‚
2. **ç›‘æ§ç¨‹åºï¼š**å¯ä»¥ä»ç®¡ç¨‹å¤–éƒ¨è°ƒç”¨çš„ç¨‹åºæˆ–å‡½æ•°ç§°ä¸º**ç›‘æ§ç¨‹åº**ã€‚(insight)
2. **ç®¡ç¨‹å…¥å£é˜Ÿåˆ—ï¼šç®¡ç¨‹å…¥å£é˜Ÿåˆ—**æ˜¯**ç®¡ç¨‹**çš„å¦ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œå®ƒåŒ…å«è¿›ç¨‹æ‰€æœ‰çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„ç¨‹åºã€‚

### Condition Variablesï¼ˆæ¡ä»¶å˜é‡ï¼‰

There are two sorts of operations we can perform on the monitor's condition variables:

1. Wait
2. Signal

Consider a condition variable (y) is declared in the monitor:

**y.wait():** The activity/process that applies the wait operation on a condition variable will be suspended, and the suspended process is located in the condition variable's block queue.

**y.signal():** If an activity/process applies the signal action on the condition variable, then one of the blocked activity/processes in the monitor is given a chance to execute.

æˆ‘ä»¬å¯ä»¥å¯¹ç®¡ç¨‹ä¸­çš„æ¡ä»¶å˜é‡æ‰§è¡Œä¸¤ç§æ“ä½œï¼š

1. Waitï¼ˆ**Pæ“ä½œ**)
2. Signal (**V æ“ä½œ**)

å‡è®¾åœ¨**ç®¡ç¨‹**ä¸­å£°æ˜äº†ä¸€ä¸ªæ¡ä»¶å˜é‡ (y)ï¼š

**y.wait():** å¯¹æ¡ä»¶å˜é‡æ‰§è¡Œ **P æ“ä½œ**çš„ **æ´»åŠ¨/è¿›ç¨‹** å°†è¢«æŒ‚èµ·ï¼ŒæŒ‚èµ·çš„è¿›ç¨‹ä½äºæ¡ä»¶å˜é‡çš„é˜»å¡é˜Ÿåˆ—ã€‚

 **y.signal():** å¦‚æœä¸€ä¸ª **æ´»åŠ¨/è¿›ç¨‹** å¯¹æ¡ä»¶å˜é‡æ‰§è¡Œ V æ“ä½œï¼Œé‚£ä¹ˆç›‘è§†å™¨ä¸­è¢«é˜»å¡çš„æ´»åŠ¨/è¿›ç¨‹ä¹‹ä¸€å°±æœ‰æœºä¼šæ‰§è¡Œã€‚

> å¯ä»¥ç®€å•ç†è§£ä¸ºèµ„æºçš„**ç­‰å¾…é˜Ÿåˆ—**ï¼Œä¸€ä¸ªæ¡ä»¶å˜é‡ä»£è¡¨ä¸€ç§é˜»å¡çš„åŸå› 
>
> æ¡ä»¶å˜é‡çš„è°ƒç”¨ä½¿ç”¨signal/wait
>
> æ¡ä»¶å˜é‡æ— æ³•å®ç°äº’æ–¥ï¼Œå®é™…ä½¿ç”¨ä¸€èˆ¬ä¸é”é…åˆä½¿ç”¨

### ä¸ä¿¡å·é‡æ–¹æ³•çš„åŒºåˆ«

| **Monitors**                                                 | **Semaphore**                                                |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| We can use condition variables only in the monitors.         | In semaphore, we can use condition variables anywhere in the program, but we cannot use conditions variables in a semaphore. |
| In monitors, wait always block the caller.                   | In semaphore, wait does not always block the caller.         |
| The monitors are comprised of the shared variables and the procedures which operate the shared variable. | The semaphore S value means the number of shared resources that are present in the system. |
| Condition variables are present in the monitor.              | Condition variables are not present in the semaphore.        |

### Advantages of Monitor in OS

- Monitors offer the benefit of making concurrent or parallel programming easier and less error-prone than semaphore-based solutions.
- It helps in process synchronization in the operating system.
- Monitors have built-in mutual exclusion.
- Monitors are easier to set up than semaphores.
- Monitors may be able to correct for the timing faults that **semaphores cause**.

### Disadvantages of Monitor in OS

- Monitors must be **implemented** with the programming language.
- Monitor increases the compiler's workload.
- The monitor requires to understand what **operating system** features are available for **controlling crucial** sections in the parallel procedures.

### Conclusion

- Monitor in an operating system is one method for achieving process synchronization.
- Monitors in OS offer the benefit of making concurrent or parallel programming easier and less error-prone than semaphore-based solutions.
- The monitor is made up of four primary parts, Initialization, Private Data, Monitor Procedure, and Monitor Entry Queue.
- wait() and signal() are two methods that we can use with the **monitor's condition variables**.
